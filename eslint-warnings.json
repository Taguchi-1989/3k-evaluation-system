[{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\.eslintrc.cjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\electron\\main.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\electron\\preload\\preload.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\next-env.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\adapters-electron\\src\\auth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\adapters-electron\\src\\config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\adapters-electron\\src\\http.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\adapters-electron\\src\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\adapters-electron\\src\\logger.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .transports on an `error` typed value.","line":17,"column":9,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":17,"endColumn":19,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .transports on an `error` typed value.","line":19,"column":9,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":19,"endColumn":19,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":25,"column":5,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":25,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .info on an `error` typed value.","line":25,"column":9,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":25,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":31,"column":5,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":31,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .warn on an `error` typed value.","line":31,"column":9,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":31,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":37,"column":5,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":37,"endColumn":14,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .error on an `error` typed value.","line":37,"column":9,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":37,"endColumn":14,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":43,"column":5,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":43,"endColumn":14,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .debug on an `error` typed value.","line":43,"column":9,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":43,"endColumn":14,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\adapters-electron\\src\\repositories.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an error typed value.","line":23,"column":5,"nodeType":"AssignmentExpression","messageId":"anyAssignment","endLine":23,"endColumn":50,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe construction of a(n) `error` type typed value.","line":23,"column":15,"nodeType":"NewExpression","messageId":"unsafeNew","endLine":23,"endColumn":50,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":28,"column":5,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":28,"endColumn":17,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .exec on an `error` typed value.","line":28,"column":13,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":28,"endColumn":17,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an error typed value.","line":48,"column":11,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":55,"endColumn":7,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":48,"column":18,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":48,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .prepare on an `error` typed value.","line":48,"column":26,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":48,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":57,"column":5,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":57,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .run on an `error` typed value.","line":57,"column":10,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":57,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an error typed value.","line":77,"column":11,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":77,"endColumn":78,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":77,"column":18,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":77,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .prepare on an `error` typed value.","line":77,"column":26,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":77,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":78,"column":17,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":78,"endColumn":25,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .get on an `error` typed value.","line":78,"column":22,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":78,"endColumn":25,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an error typed value.","line":88,"column":11,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":88,"endColumn":89,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":88,"column":18,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":88,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .prepare on an `error` typed value.","line":88,"column":26,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":88,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":89,"column":18,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":89,"endColumn":26,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .all on an `error` typed value.","line":89,"column":23,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":89,"endColumn":26,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an error typed value.","line":95,"column":11,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":95,"endColumn":73,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":95,"column":18,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":95,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .prepare on an `error` typed value.","line":95,"column":26,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":95,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":96,"column":5,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":96,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .run on an `error` typed value.","line":96,"column":10,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":96,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an error typed value.","line":114,"column":11,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":128,"endColumn":7,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":114,"column":18,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":114,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .prepare on an `error` typed value.","line":114,"column":26,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":114,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":130,"column":5,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":130,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .run on an `error` typed value.","line":130,"column":10,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":130,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":149,"column":5,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":149,"endColumn":18,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .close on an `error` typed value.","line":149,"column":13,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":149,"endColumn":18,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an error typed value.","line":161,"column":5,"nodeType":"AssignmentExpression","messageId":"anyAssignment","endLine":161,"endColumn":50,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe construction of a(n) `error` type typed value.","line":161,"column":15,"nodeType":"NewExpression","messageId":"unsafeNew","endLine":161,"endColumn":50,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":166,"column":5,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":166,"endColumn":17,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .exec on an `error` typed value.","line":166,"column":13,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":166,"endColumn":17,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an error typed value.","line":178,"column":11,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":178,"endColumn":80,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":178,"column":18,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":178,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .prepare on an `error` typed value.","line":178,"column":26,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":178,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":179,"column":12,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":179,"endColumn":20,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .all on an `error` typed value.","line":179,"column":17,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":179,"endColumn":20,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an error typed value.","line":183,"column":11,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":183,"endColumn":69,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":183,"column":18,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":183,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .prepare on an `error` typed value.","line":183,"column":26,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":183,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":184,"column":17,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":184,"endColumn":25,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .get on an `error` typed value.","line":184,"column":22,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":184,"endColumn":25,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an error typed value.","line":195,"column":11,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":198,"endColumn":7,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":195,"column":18,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":195,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .prepare on an `error` typed value.","line":195,"column":26,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":195,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":200,"column":5,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":200,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .run on an `error` typed value.","line":200,"column":10,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":200,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an error typed value.","line":223,"column":11,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":227,"endColumn":7,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":223,"column":18,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":223,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .prepare on an `error` typed value.","line":223,"column":26,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":223,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":229,"column":5,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":229,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .run on an `error` typed value.","line":229,"column":10,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":229,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an error typed value.","line":235,"column":11,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":235,"endColumn":67,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":235,"column":18,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":235,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .prepare on an `error` typed value.","line":235,"column":26,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":235,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":236,"column":5,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":236,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .run on an `error` typed value.","line":236,"column":10,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":236,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `error` type typed value.","line":240,"column":5,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":240,"endColumn":18,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .close on an `error` typed value.","line":240,"column":13,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":240,"endColumn":18,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\adapters-electron\\src\\storage.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":56,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":56,"endColumn":19}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Electron環境用StoragePort実装\n * electron-store (KV) + Node.js fs (Blob)\n */\n\nimport type { StoragePort, KV, BlobStore } from '@3k/ports'\nimport Store from 'electron-store'\nimport { app } from 'electron'\nimport * as fs from 'fs/promises'\nimport * as path from 'path'\n\n/**\n * electron-store ベースのKV実装\n */\nclass ElectronStoreKV implements KV {\n  private store: Store\n\n  constructor() {\n    this.store = new Store({\n      name: '3k-evaluation-kv'\n    })\n  }\n\n  async get<T>(key: string): Promise<T | undefined> {\n    return this.store.get(key) as T | undefined\n  }\n\n  async set<T>(key: string, value: T): Promise<void> {\n    this.store.set(key, value)\n  }\n\n  async remove(key: string): Promise<void> {\n    this.store.delete(key)\n  }\n\n  async keys(): Promise<string[]> {\n    const store = this.store.store as Record<string, unknown>\n    return Object.keys(store)\n  }\n}\n\n/**\n * Node.js fs ベースのBlobStore実装\n */\nclass FileSystemBlobStore implements BlobStore {\n  private blobDir: string\n\n  constructor() {\n    // アプリケーションデータディレクトリにblobs保存\n    this.blobDir = path.join(app.getPath('userData'), 'blobs')\n  }\n\n  async ensureBlobDir(): Promise<void> {\n    try {\n      await fs.mkdir(this.blobDir, { recursive: true })\n    } catch (error) {\n      // ディレクトリが既に存在する場合は無視\n    }\n  }\n\n  async read(filePath: string): Promise<Uint8Array> {\n    await this.ensureBlobDir()\n    const fullPath = path.join(this.blobDir, filePath)\n    const buffer = await fs.readFile(fullPath)\n    return new Uint8Array(buffer)\n  }\n\n  async write(filePath: string, data: Uint8Array): Promise<void> {\n    await this.ensureBlobDir()\n    const fullPath = path.join(this.blobDir, filePath)\n\n    // ディレクトリ作成\n    const dir = path.dirname(fullPath)\n    await fs.mkdir(dir, { recursive: true })\n\n    await fs.writeFile(fullPath, data)\n  }\n\n  async exists(filePath: string): Promise<boolean> {\n    const fullPath = path.join(this.blobDir, filePath)\n    try {\n      await fs.access(fullPath)\n      return true\n    } catch {\n      return false\n    }\n  }\n\n  async delete(filePath: string): Promise<void> {\n    const fullPath = path.join(this.blobDir, filePath)\n    await fs.unlink(fullPath)\n  }\n\n  async list(directory: string): Promise<string[]> {\n    await this.ensureBlobDir()\n    const fullPath = path.join(this.blobDir, directory)\n\n    try {\n      const entries = await fs.readdir(fullPath, { withFileTypes: true })\n      return entries\n        .filter(entry => entry.isFile())\n        .map(entry => path.join(directory, entry.name))\n    } catch {\n      return []\n    }\n  }\n}\n\n/**\n * Electron Storage Adapter\n */\nexport class ElectronStorageAdapter implements StoragePort {\n  kv: KV\n  blobs: BlobStore\n\n  constructor() {\n    this.kv = new ElectronStoreKV()\n    this.blobs = new FileSystemBlobStore()\n  }\n}\n\n/**\n * シングルトンインスタンス\n */\nexport const electronStorage = new ElectronStorageAdapter()","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\adapters-web\\src\\auth.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[327,330],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[327,330],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[342,345],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[342,345],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of type `SupabaseClient<any, any, any, any, any>` to a variable of type `SupabaseClient<any, \"public\", any, any, any>`.","line":15,"column":5,"nodeType":"AssignmentExpression","messageId":"unsafeAssignment","endLine":15,"endColumn":63,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\adapters-web\\src\\config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\adapters-web\\src\\http.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\adapters-web\\src\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\adapters-web\\src\\logger.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\adapters-web\\src\\repositories.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\adapters-web\\src\\repositories.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe object destructuring of a property with an `any` value.","line":30,"column":13,"nodeType":"Identifier","messageId":"unsafeObjectPattern","endLine":30,"endColumn":17,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-return","severity":2,"message":"Unsafe return of a value of type `any`.","line":43,"column":5,"nodeType":"ReturnStatement","messageId":"unsafeReturn","endLine":43,"endColumn":19,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .id on an `any` value.","line":43,"column":17,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":43,"endColumn":19,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe object destructuring of a property with an `any` value.","line":54,"column":13,"nodeType":"Identifier","messageId":"unsafeObjectPattern","endLine":54,"endColumn":17,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .id on an `any` value.","line":82,"column":52,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":82,"endColumn":54,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe object destructuring of a property with an `any` value.","line":105,"column":13,"nodeType":"Identifier","messageId":"unsafeObjectPattern","endLine":105,"endColumn":17,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe object destructuring of a property with an `any` value.","line":157,"column":13,"nodeType":"Identifier","messageId":"unsafeObjectPattern","endLine":157,"endColumn":17,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe object destructuring of a property with an `any` value.","line":180,"column":13,"nodeType":"Identifier","messageId":"unsafeObjectPattern","endLine":180,"endColumn":17,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe object destructuring of a property with an `any` value.","line":194,"column":13,"nodeType":"Identifier","messageId":"unsafeObjectPattern","endLine":194,"endColumn":17,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\adapters-web\\src\\storage.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-unsafe-return","severity":2,"message":"Unsafe return of a value of type `Promise<any>`.","line":40,"column":5,"nodeType":"ReturnStatement","messageId":"unsafeReturn","endLine":40,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":71,"column":11,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":71,"endColumn":48,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-return","severity":2,"message":"Unsafe return of a value of type `any`.","line":75,"column":5,"nodeType":"ReturnStatement","messageId":"unsafeReturn","endLine":75,"endColumn":16,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":85,"column":11,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":85,"endColumn":48,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-return","severity":2,"message":"Unsafe return of a value of type `any`.","line":110,"column":5,"nodeType":"ReturnStatement","messageId":"unsafeReturn","endLine":110,"endColumn":47,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\core\\src\\app.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\core\\src\\domain\\evaluation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\core\\src\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\core\\src\\services\\score-calculator.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\core\\src\\services\\score-calculator.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\ports\\auth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\ports\\config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\ports\\http.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\ports\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\ports\\llm.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\ports\\logger.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\ports\\repositories.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\packages\\ports\\storage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\scripts\\fix-import-types.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\scripts\\gen-functions.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\scripts\\guards\\check-functions.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\scripts\\guards\\no-mixed-ui-logic.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\admin\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\dashboard\\error.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\dashboard\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\dashboard\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\evaluation\\edit\\[id]\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\evaluation\\environmental\\chemical\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\evaluation\\environmental\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\evaluation\\hazard\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\evaluation\\list\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\evaluation\\mental\\error.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\evaluation\\mental\\focus\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\evaluation\\mental\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\evaluation\\mental\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\evaluation\\mental\\stress\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\evaluation\\new\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\evaluation\\physical\\error.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\evaluation\\physical\\loading.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\evaluation\\physical\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'getReturnPath', 'pushToHistory', and 'setCurrentPath'. Either include them or remove the dependency array.","line":20,"column":6,"nodeType":"ArrayExpression","endLine":20,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [getReturnPath, pushToHistory, setCurrentPath]","fix":{"range":[765,767],"text":"[getReturnPath, pushToHistory, setCurrentPath]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport React, { useEffect } from 'react'\r\nimport { PhysicalFactorDetailDynamic } from '@/components/optimized/DynamicImports'\r\nimport { EvaluationLayout, EvaluationContentContainer } from '@/components/layout/EvaluationLayout'\r\nimport { Footer } from '@/components/layout'\r\nimport { useNavigation } from '@/hooks/useNavigation'\r\nimport { useEvaluationStore } from '@/hooks/useEvaluationStore'\r\n\r\nexport default function PhysicalFactorPage(): React.JSX.Element {\r\n  const { getReturnPath } = useNavigation()\r\n  const { setCurrentPath, pushToHistory } = useEvaluationStore()\r\n\r\n  useEffect(() => {\r\n    const returnPath = getReturnPath()\r\n    if (returnPath) {\r\n      pushToHistory(returnPath)\r\n    }\r\n    setCurrentPath('/evaluation/physical')\r\n  }, []) // Remove dependencies as this should only run once on mount\r\n\r\n  const breadcrumbItems = [\r\n    { label: 'ホーム', path: '/' },\r\n    { label: '評価', path: '/evaluation/new' },\r\n    { label: '肉体因子評価', isActive: true }\r\n  ]\r\n\r\n  return (\r\n    <EvaluationLayout\r\n      variant=\"simple\"\r\n      title=\"肉体因子詳細評価\"\r\n      showGrid={false}\r\n      breadcrumbItems={breadcrumbItems}\r\n      footer={<Footer variant=\"app\" asContent={true} />}\r\n      evaluationContent={\r\n        <EvaluationContentContainer>\r\n          <PhysicalFactorDetailDynamic\r\n            creator={{\r\n              department: '生産技術企画部',\r\n              name: '山田 太郎',\r\n              date: '2024/08/20'\r\n            }}\r\n            checker={{\r\n              department: '生産企画部',\r\n              name: '鈴木 一郎',\r\n              date: '2024/08/21'\r\n            }}\r\n            workInfo={{\r\n              workName: 'サンプル作業',\r\n              factoryName: '〇〇工場',\r\n              processName: '△△工程'\r\n            }}\r\n          />\r\n        </EvaluationContentContainer>\r\n      }\r\n    />\r\n  )\r\n}","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\evaluation\\physical\\posture\\matrix\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\evaluation\\physical\\posture\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\evaluation\\worktime\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\help\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\home\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\not-found.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\reports\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\settings\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\test\\ai-features\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\test\\ai-features\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\app\\test\\visibility\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\auth\\LoginForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\auth\\PermissionGuard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\auth\\UserRoleIndicator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\dashboard\\DashboardCharts.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Line' is defined but never used. Allowed unused vars must match /^_/u.","line":18,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport React, { useEffect, useState } from 'react'\r\nimport {\r\n  Chart as ChartJS,\r\n  CategoryScale,\r\n  LinearScale,\r\n  BarElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend,\r\n  ArcElement,\r\n  PointElement,\r\n  LineElement,\r\n  RadialLinearScale,\r\n  type ChartData,\r\n} from 'chart.js'\r\nimport { Bar, Pie, Line, Radar } from 'react-chartjs-2'\r\nimport type { WorkItem } from '@/components/evaluation/EvaluationListView'\r\n\r\n// Chart.js コンポーネントの登録\r\nChartJS.register(\r\n  CategoryScale,\r\n  LinearScale,\r\n  BarElement,\r\n  Title,\r\n  Tooltip,\r\n  Legend,\r\n  ArcElement,\r\n  PointElement,\r\n  LineElement,\r\n  RadialLinearScale\r\n)\r\n\r\nexport interface DashboardChartsProps {\r\n  workItems: WorkItem[]\r\n  className?: string\r\n}\r\n\r\nexport function DashboardCharts({ workItems, className = '' }: DashboardChartsProps): React.JSX.Element {\r\n  const [mounted, setMounted] = useState(false)\r\n\r\n  useEffect(() => {\r\n    setMounted(true)\r\n  }, [])\r\n\r\n  if (!mounted) {\r\n    return (\r\n      <div className={`grid grid-cols-1 lg:grid-cols-2 gap-6 ${className}`}>\r\n        {Array.from({ length: 4 }).map((_, index) => (\r\n          <div key={index} className=\"bg-white rounded-lg p-6 border\">\r\n            <div className=\"animate-pulse\">\r\n              <div className=\"h-4 bg-gray-200 rounded w-1/3 mb-4\"></div>\r\n              <div className=\"h-64 bg-gray-100 rounded\"></div>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // 3K指数別の分布\r\n  const threekIndexData = {\r\n    labels: ['A (7-10点)', 'B (4-6点)', 'C (2-3点)', 'D (1点)'],\r\n    datasets: [\r\n      {\r\n        label: '作業件数',\r\n        data: [\r\n          workItems.filter(item => item.kitsusaScore >= 7).length,\r\n          workItems.filter(item => item.kitsusaScore >= 4 && item.kitsusaScore < 7).length,\r\n          workItems.filter(item => item.kitsusaScore >= 2 && item.kitsusaScore < 4).length,\r\n          workItems.filter(item => item.kitsusaScore < 2).length,\r\n        ],\r\n        backgroundColor: [\r\n          'rgba(239, 68, 68, 0.8)',   // 赤 (A)\r\n          'rgba(245, 158, 11, 0.8)',  // オレンジ (B)\r\n          'rgba(234, 179, 8, 0.8)',   // 黄 (C)\r\n          'rgba(34, 197, 94, 0.8)',   // 緑 (D)\r\n        ],\r\n        borderColor: [\r\n          'rgba(239, 68, 68, 1)',\r\n          'rgba(245, 158, 11, 1)',\r\n          'rgba(234, 179, 8, 1)',\r\n          'rgba(34, 197, 94, 1)',\r\n        ],\r\n        borderWidth: 2,\r\n      },\r\n    ],\r\n  }\r\n\r\n  // 因子別平均スコア\r\n  const factorScoreData = {\r\n    labels: ['肉体因', '精神因', '環境因', '危険因'],\r\n    datasets: [\r\n      {\r\n        label: '平均スコア',\r\n        data: [\r\n          workItems.reduce((sum, item) => sum + item.physicalScore, 0) / workItems.length,\r\n          workItems.reduce((sum, item) => sum + item.mentalScore, 0) / workItems.length,\r\n          workItems.reduce((sum, item) => sum + item.environmentalScore, 0) / workItems.length,\r\n          workItems.reduce((sum, item) => sum + item.hazardScore, 0) / workItems.length,\r\n        ].map(score => Math.round(score * 10) / 10),\r\n        backgroundColor: [\r\n          'rgba(59, 130, 246, 0.8)',   // 青\r\n          'rgba(168, 85, 247, 0.8)',   // 紫\r\n          'rgba(34, 197, 94, 0.8)',    // 緑\r\n          'rgba(239, 68, 68, 0.8)',    // 赤\r\n        ],\r\n        borderColor: [\r\n          'rgba(59, 130, 246, 1)',\r\n          'rgba(168, 85, 247, 1)',\r\n          'rgba(34, 197, 94, 1)',\r\n          'rgba(239, 68, 68, 1)',\r\n        ],\r\n        borderWidth: 2,\r\n      },\r\n    ],\r\n  }\r\n\r\n  // 工場別作業分布\r\n  const factoryData = () => {\r\n    const factories = [...new Set(workItems.map(item => item.factoryName))]\r\n    const factoryStats = factories.map(factory => {\r\n      const factoryItems = workItems.filter(item => item.factoryName === factory)\r\n      return {\r\n        factory,\r\n        count: factoryItems.length,\r\n        avgScore: factoryItems.reduce((sum, item) => sum + item.kitsusaScore, 0) / factoryItems.length\r\n      }\r\n    })\r\n\r\n    return {\r\n      labels: factoryStats.map(stat => stat.factory),\r\n      datasets: [\r\n        {\r\n          label: '作業件数',\r\n          data: factoryStats.map(stat => stat.count),\r\n          backgroundColor: 'rgba(59, 130, 246, 0.8)',\r\n          borderColor: 'rgba(59, 130, 246, 1)',\r\n          borderWidth: 2,\r\n          yAxisID: 'y',\r\n        },\r\n        {\r\n          label: '平均キツさスコア',\r\n          data: factoryStats.map(stat => Math.round(stat.avgScore * 10) / 10),\r\n          backgroundColor: 'rgba(239, 68, 68, 0.8)',\r\n          borderColor: 'rgba(239, 68, 68, 1)',\r\n          borderWidth: 2,\r\n          type: 'line' as const,\r\n          yAxisID: 'y1',\r\n        },\r\n      ],\r\n    }\r\n  }\r\n\r\n  // レーダーチャート用データ（各因子の最大値比較）\r\n  const radarData = {\r\n    labels: ['肉体因', '精神因', '環境因', '危険因'],\r\n    datasets: [\r\n      {\r\n        label: '最高スコア',\r\n        data: [\r\n          Math.max(...workItems.map(item => item.physicalScore)),\r\n          Math.max(...workItems.map(item => item.mentalScore)),\r\n          Math.max(...workItems.map(item => item.environmentalScore)),\r\n          Math.max(...workItems.map(item => item.hazardScore)),\r\n        ],\r\n        backgroundColor: 'rgba(239, 68, 68, 0.2)',\r\n        borderColor: 'rgba(239, 68, 68, 1)',\r\n        borderWidth: 2,\r\n      },\r\n      {\r\n        label: '平均スコア',\r\n        data: [\r\n          workItems.reduce((sum, item) => sum + item.physicalScore, 0) / workItems.length,\r\n          workItems.reduce((sum, item) => sum + item.mentalScore, 0) / workItems.length,\r\n          workItems.reduce((sum, item) => sum + item.environmentalScore, 0) / workItems.length,\r\n          workItems.reduce((sum, item) => sum + item.hazardScore, 0) / workItems.length,\r\n        ].map(score => Math.round(score * 10) / 10),\r\n        backgroundColor: 'rgba(34, 197, 94, 0.2)',\r\n        borderColor: 'rgba(34, 197, 94, 1)',\r\n        borderWidth: 2,\r\n      },\r\n    ],\r\n  }\r\n\r\n  const chartOptions = {\r\n    responsive: true,\r\n    maintainAspectRatio: false,\r\n    plugins: {\r\n      legend: {\r\n        position: 'top' as const,\r\n        labels: {\r\n          font: {\r\n            size: 12,\r\n          },\r\n        },\r\n      },\r\n    },\r\n    scales: {\r\n      y: {\r\n        beginAtZero: true,\r\n        grid: {\r\n          color: 'rgba(0, 0, 0, 0.1)',\r\n        },\r\n      },\r\n      x: {\r\n        grid: {\r\n          color: 'rgba(0, 0, 0, 0.1)',\r\n        },\r\n      },\r\n    },\r\n  }\r\n\r\n  const dualAxisOptions = {\r\n    responsive: true,\r\n    maintainAspectRatio: false,\r\n    plugins: {\r\n      legend: {\r\n        position: 'top' as const,\r\n      },\r\n    },\r\n    scales: {\r\n      y: {\r\n        type: 'linear' as const,\r\n        display: true,\r\n        position: 'left' as const,\r\n        beginAtZero: true,\r\n        title: {\r\n          display: true,\r\n          text: '作業件数',\r\n        },\r\n      },\r\n      y1: {\r\n        type: 'linear' as const,\r\n        display: true,\r\n        position: 'right' as const,\r\n        beginAtZero: true,\r\n        title: {\r\n          display: true,\r\n          text: '平均スコア',\r\n        },\r\n        grid: {\r\n          drawOnChartArea: false,\r\n        },\r\n      },\r\n      x: {\r\n        grid: {\r\n          color: 'rgba(0, 0, 0, 0.1)',\r\n        },\r\n      },\r\n    },\r\n  }\r\n\r\n  const radarOptions = {\r\n    responsive: true,\r\n    maintainAspectRatio: false,\r\n    scales: {\r\n      r: {\r\n        beginAtZero: true,\r\n        max: 10,\r\n        ticks: {\r\n          stepSize: 2,\r\n        },\r\n      },\r\n    },\r\n    plugins: {\r\n      legend: {\r\n        position: 'top' as const,\r\n      },\r\n    },\r\n  }\r\n\r\n  return (\r\n    <div className={`grid grid-cols-1 lg:grid-cols-2 gap-6 ${className}`}>\r\n      {/* 3K指数分布 */}\r\n      <div className=\"bg-white rounded-lg p-6 border shadow-sm\">\r\n        <h3 className=\"text-lg font-semibold mb-4 text-gray-800\">3K指数分布</h3>\r\n        <div className=\"h-64\">\r\n          <Pie data={threekIndexData} options={{ \r\n            ...chartOptions, \r\n            plugins: { \r\n              ...chartOptions.plugins,\r\n              legend: { \r\n                ...chartOptions.plugins.legend, \r\n                position: 'bottom' as const \r\n              } \r\n            } \r\n          }} />\r\n        </div>\r\n        <div className=\"mt-4 text-sm text-gray-600\">\r\n          <p>改善要対象: <span className=\"font-semibold text-red-600\">\r\n            {workItems.filter(item => item.kitsusaScore >= 4).length}件\r\n          </span> / 全{workItems.length}件</p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* 因子別平均スコア */}\r\n      <div className=\"bg-white rounded-lg p-6 border shadow-sm\">\r\n        <h3 className=\"text-lg font-semibold mb-4 text-gray-800\">因子別平均スコア</h3>\r\n        <div className=\"h-64\">\r\n          <Bar data={factorScoreData} options={chartOptions} />\r\n        </div>\r\n        <div className=\"mt-4 text-sm text-gray-600\">\r\n          <p>最高平均: <span className=\"font-semibold\">\r\n            {Math.max(...(factorScoreData.datasets[0]?.data ?? [0])).toFixed(1)}点\r\n          </span></p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* 工場別分析 */}\r\n      <div className=\"bg-white rounded-lg p-6 border shadow-sm\">\r\n        <h3 className=\"text-lg font-semibold mb-4 text-gray-800\">工場別作業分析</h3>\r\n        <div className=\"h-64\">\r\n          <Bar data={factoryData() as ChartData<'bar'>} options={dualAxisOptions} />\r\n        </div>\r\n        <div className=\"mt-4 text-sm text-gray-600\">\r\n          <p>総工場数: <span className=\"font-semibold\">\r\n            {[...new Set(workItems.map(item => item.factoryName))].length}工場\r\n          </span></p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* レーダーチャート */}\r\n      <div className=\"bg-white rounded-lg p-6 border shadow-sm\">\r\n        <h3 className=\"text-lg font-semibold mb-4 text-gray-800\">因子別リスク評価</h3>\r\n        <div className=\"h-64\">\r\n          <Radar data={radarData} options={radarOptions} />\r\n        </div>\r\n        <div className=\"mt-4 text-sm text-gray-600\">\r\n          <p>最高リスク因子: <span className=\"font-semibold text-red-600\">\r\n            {['肉体因', '精神因', '環境因', '危険因'][\r\n              (radarData.datasets[0]?.data ?? []).indexOf(Math.max(...(radarData.datasets[0]?.data ?? [0])))\r\n            ] ?? '不明'}\r\n          </span></p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\dashboard\\DashboardStats.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\dashboard\\EnhancedDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\dashboard\\ReportsDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\dashboard\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\electron\\ElectronTitleBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\AppHome.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\DynamicMatrixDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\EnhancedEnvironmentalFactorDetail.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'evaluationNo' is defined but never used. Allowed unused args must match /^_/u.","line":187,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":187,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'creator' is defined but never used. Allowed unused args must match /^_/u.","line":188,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":188,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'checker' is defined but never used. Allowed unused args must match /^_/u.","line":189,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":189,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'workInfo' is defined but never used. Allowed unused args must match /^_/u.","line":190,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":190,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'currentEvaluation' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":195,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":195,"endColumn":28},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'calculateOverallRisk'. Either include it or remove the dependency array.","line":238,"column":6,"nodeType":"ArrayExpression","endLine":238,"endColumn":66,"suggestions":[{"desc":"Update the dependencies array to be: [environmentalData.substances, environmentalData.conditions, calculateOverallRisk]","fix":{"range":[5642,5702],"text":"[environmentalData.substances, environmentalData.conditions, calculateOverallRisk]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleSave' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":362,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":362,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'files' is defined but never used. Allowed unused args must match /^_/u.","line":374,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":374,"endColumn":34},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleBackToMain' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":378,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":378,"endColumn":25}],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleCheckboxChange' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":279,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":279,"endColumn":29,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport React, { useState, useEffect } from 'react'\r\nimport { FileUpload, Input, Button } from '@/components/ui'\r\nimport { PhotoViewer } from '@/components/evaluation'\r\nimport { useEvaluationStore } from '@/hooks/useEvaluationStore'\r\n\r\nexport interface EnvironmentalSubstance {\r\n  id: string\r\n  substanceName: string\r\n  category: 'chemical' | 'physical' | 'biological'\r\n  standardValue: number\r\n  measuredValue: number\r\n  measurementUnit: string\r\n  exposureTime: number\r\n  protectionLevel: 'none' | 'low' | 'medium' | 'high'\r\n  riskLevel: number\r\n  notes?: string\r\n}\r\n\r\nexport interface EnvironmentalCondition {\r\n  id: string\r\n  conditionType: 'temperature' | 'humidity' | 'lighting' | 'ventilation' | 'noise' | 'vibration'\r\n  label: string\r\n  standardMin: number\r\n  standardMax: number\r\n  currentValue: number\r\n  measurementUnit: string\r\n  isOutOfRange: boolean\r\n  severity: 'low' | 'medium' | 'high' | 'critical'\r\n}\r\n\r\nexport interface EnvironmentalDetails {\r\n  checkboxes: {\r\n    chemicals: boolean\r\n    temperature: boolean\r\n    noise: boolean\r\n    vibration: boolean\r\n    lighting: boolean\r\n    dust: boolean\r\n    humidity: boolean\r\n    ventilation: boolean\r\n  }\r\n  substances: EnvironmentalSubstance[]\r\n  conditions: EnvironmentalCondition[]\r\n  overallRiskAssessment: {\r\n    chemicalRisk: number\r\n    physicalRisk: number\r\n    biologicalRisk: number\r\n    combinedRisk: number\r\n  }\r\n  protectiveMeasures: {\r\n    personalProtection: string[]\r\n    engineeringControls: string[]\r\n    administrativeControls: string[]\r\n    emergencyProcedures: string[]\r\n  }\r\n}\r\n\r\nexport interface EnhancedEnvironmentalFactorDetailProps {\r\n  evaluationNo?: string\r\n  creator?: {\r\n    department: string\r\n    name: string\r\n    date: string\r\n  }\r\n  checker?: {\r\n    department: string\r\n    name: string\r\n    date: string\r\n  }\r\n  workInfo?: {\r\n    workName: string\r\n    factoryName: string\r\n    processName: string\r\n  }\r\n  photoUrl?: string\r\n  initialData?: Partial<EnvironmentalDetails>\r\n}\r\n\r\nconst defaultSubstances: EnvironmentalSubstance[] = [\r\n  {\r\n    id: '1',\r\n    substanceName: 'アンモニア',\r\n    category: 'chemical',\r\n    standardValue: 25,\r\n    measuredValue: 0,\r\n    measurementUnit: 'ppm',\r\n    exposureTime: 8,\r\n    protectionLevel: 'none',\r\n    riskLevel: 1\r\n  },\r\n  {\r\n    id: '2',\r\n    substanceName: '一般化学物質',\r\n    category: 'chemical',\r\n    standardValue: 100,\r\n    measuredValue: 0,\r\n    measurementUnit: 'ppm',\r\n    exposureTime: 8,\r\n    protectionLevel: 'none',\r\n    riskLevel: 1\r\n  },\r\n  {\r\n    id: '3',\r\n    substanceName: '有機溶剤',\r\n    category: 'chemical',\r\n    standardValue: 200,\r\n    measuredValue: 0,\r\n    measurementUnit: 'ppm',\r\n    exposureTime: 8,\r\n    protectionLevel: 'none',\r\n    riskLevel: 1\r\n  }\r\n]\r\n\r\nconst defaultConditions: EnvironmentalCondition[] = [\r\n  {\r\n    id: '1',\r\n    conditionType: 'temperature',\r\n    label: '作業環境温度',\r\n    standardMin: 17,\r\n    standardMax: 28,\r\n    currentValue: 25,\r\n    measurementUnit: '°C',\r\n    isOutOfRange: false,\r\n    severity: 'low'\r\n  },\r\n  {\r\n    id: '2',\r\n    conditionType: 'humidity',\r\n    label: '相対湿度',\r\n    standardMin: 40,\r\n    standardMax: 70,\r\n    currentValue: 60,\r\n    measurementUnit: '%',\r\n    isOutOfRange: false,\r\n    severity: 'low'\r\n  },\r\n  {\r\n    id: '3',\r\n    conditionType: 'lighting',\r\n    label: '照度',\r\n    standardMin: 200,\r\n    standardMax: 1000,\r\n    currentValue: 500,\r\n    measurementUnit: 'lux',\r\n    isOutOfRange: false,\r\n    severity: 'low'\r\n  },\r\n  {\r\n    id: '4',\r\n    conditionType: 'noise',\r\n    label: '騒音レベル',\r\n    standardMin: 0,\r\n    standardMax: 85,\r\n    currentValue: 70,\r\n    measurementUnit: 'dB',\r\n    isOutOfRange: false,\r\n    severity: 'low'\r\n  },\r\n  {\r\n    id: '5',\r\n    conditionType: 'vibration',\r\n    label: '全身振動',\r\n    standardMin: 0,\r\n    standardMax: 0.5,\r\n    currentValue: 0.2,\r\n    measurementUnit: 'm/s²',\r\n    isOutOfRange: false,\r\n    severity: 'low'\r\n  },\r\n  {\r\n    id: '6',\r\n    conditionType: 'ventilation',\r\n    label: '換気量',\r\n    standardMin: 20,\r\n    standardMax: 100,\r\n    currentValue: 50,\r\n    measurementUnit: 'm³/h',\r\n    isOutOfRange: false,\r\n    severity: 'low'\r\n  }\r\n]\r\n\r\nexport function EnhancedEnvironmentalFactorDetail({\r\n  evaluationNo,\r\n  creator,\r\n  checker,\r\n  workInfo,\r\n  photoUrl = 'https://placehold.co/600x450/e5e7eb/4b5563?text=Environmental+Assessment',\r\n  initialData\r\n}: EnhancedEnvironmentalFactorDetailProps): React.JSX.Element {\r\n  \r\n  const { currentEvaluation } = useEvaluationStore()\r\n  \r\n  const [environmentalData, setEnvironmentalData] = useState<EnvironmentalDetails>({\r\n    checkboxes: {\r\n      chemicals: false,\r\n      temperature: false,\r\n      noise: false,\r\n      vibration: false,\r\n      lighting: false,\r\n      dust: false,\r\n      humidity: false,\r\n      ventilation: false\r\n    },\r\n    substances: defaultSubstances,\r\n    conditions: defaultConditions,\r\n    overallRiskAssessment: {\r\n      chemicalRisk: 1,\r\n      physicalRisk: 1,\r\n      biologicalRisk: 1,\r\n      combinedRisk: 1\r\n    },\r\n    protectiveMeasures: {\r\n      personalProtection: [],\r\n      engineeringControls: [],\r\n      administrativeControls: [],\r\n      emergencyProcedures: []\r\n    },\r\n    ...initialData\r\n  })\r\n\r\n  const [selectedMatrix, setSelectedMatrix] = useState({ strength: 1, duration: 1 })\r\n  const [finalScore, setFinalScore] = useState(1)\r\n  const [activeTab, setActiveTab] = useState<'substances' | 'conditions' | 'assessment' | 'protection'>('substances')\r\n\r\n  // 環境因用の評価マトリックス\r\n  const environmentalMatrix = [\r\n    [1, 1, 2, 4, 7],      // 軽微な暴露\r\n    [1, 2, 4, 7, 10],     // 中程度の暴露\r\n    [1, 4, 7, 10, 10]     // 重度の暴露\r\n  ]\r\n\r\n  useEffect(() => {\r\n    calculateOverallRisk()\r\n  }, [environmentalData.substances, environmentalData.conditions])\r\n\r\n  const calculateOverallRisk = () => {\r\n    // 化学物質リスク計算\r\n    const chemicalRisk = environmentalData.substances\r\n      .filter(s => s.category === 'chemical')\r\n      .reduce((max, substance) => {\r\n        const exposureRatio = substance.measuredValue / substance.standardValue\r\n        const riskLevel = exposureRatio > 1 ? Math.min(10, Math.ceil(exposureRatio * 3)) : 1\r\n        return Math.max(max, riskLevel)\r\n      }, 1)\r\n\r\n    // 物理的環境リスク計算\r\n    const physicalRisk = environmentalData.conditions\r\n      .reduce((max, condition) => {\r\n        if (condition.isOutOfRange) {\r\n          const severity = condition.severity === 'critical' ? 10 :\r\n                          condition.severity === 'high' ? 7 :\r\n                          condition.severity === 'medium' ? 4 : 2\r\n          return Math.max(max, severity)\r\n        }\r\n        return max\r\n      }, 1)\r\n\r\n    const biologicalRisk = 1 // 簡易実装\r\n\r\n    const combinedRisk = Math.max(chemicalRisk, physicalRisk, biologicalRisk)\r\n\r\n    setEnvironmentalData(prev => ({\r\n      ...prev,\r\n      overallRiskAssessment: {\r\n        chemicalRisk,\r\n        physicalRisk,\r\n        biologicalRisk,\r\n        combinedRisk\r\n      }\r\n    }))\r\n\r\n    setFinalScore(combinedRisk)\r\n  }\r\n\r\n  const handleCheckboxChange = (key: keyof typeof environmentalData.checkboxes) => { // eslint-disable-line @typescript-eslint/no-unused-vars\r\n    setEnvironmentalData(prev => ({\r\n      ...prev,\r\n      checkboxes: {\r\n        ...prev.checkboxes,\r\n        [key]: !prev.checkboxes[key]\r\n      }\r\n    }))\r\n  }\r\n\r\n  const handleSubstanceChange = (id: string, field: keyof EnvironmentalSubstance, value: unknown) => {\r\n    setEnvironmentalData(prev => ({\r\n      ...prev,\r\n      substances: prev.substances.map(substance =>\r\n        substance.id === id ? { ...substance, [field]: value } : substance\r\n      )\r\n    }))\r\n  }\r\n\r\n  const handleConditionChange = (id: string, field: keyof EnvironmentalCondition, value: unknown) => {\r\n    setEnvironmentalData(prev => ({\r\n      ...prev,\r\n      conditions: prev.conditions.map(condition => {\r\n        if (condition.id === id) {\r\n          const updated = { ...condition, [field]: value }\r\n          \r\n          // 範囲外チェック\r\n          if (field === 'currentValue') {\r\n            const numValue = Number(value)\r\n            updated.isOutOfRange = numValue < condition.standardMin || numValue > condition.standardMax\r\n            \r\n            if (updated.isOutOfRange) {\r\n              const deviation = Math.max(\r\n                (condition.standardMin - numValue) / condition.standardMin,\r\n                (numValue - condition.standardMax) / condition.standardMax\r\n              )\r\n              updated.severity = deviation > 0.5 ? 'critical' :\r\n                               deviation > 0.3 ? 'high' :\r\n                               deviation > 0.1 ? 'medium' : 'low'\r\n            } else {\r\n              updated.severity = 'low'\r\n            }\r\n          }\r\n          \r\n          return updated\r\n        }\r\n        return condition\r\n      })\r\n    }))\r\n  }\r\n\r\n  const addNewSubstance = () => {\r\n    const newSubstance: EnvironmentalSubstance = {\r\n      id: `custom_${Date.now()}`,\r\n      substanceName: '',\r\n      category: 'chemical',\r\n      standardValue: 0,\r\n      measuredValue: 0,\r\n      measurementUnit: 'ppm',\r\n      exposureTime: 8,\r\n      protectionLevel: 'none',\r\n      riskLevel: 1\r\n    }\r\n\r\n    setEnvironmentalData(prev => ({\r\n      ...prev,\r\n      substances: [...prev.substances, newSubstance]\r\n    }))\r\n  }\r\n\r\n  const removeSubstance = (id: string) => {\r\n    setEnvironmentalData(prev => ({\r\n      ...prev,\r\n      substances: prev.substances.filter(s => s.id !== id)\r\n    }))\r\n  }\r\n\r\n  const handleMatrixClick = (strength: number, duration: number) => {\r\n    setSelectedMatrix({ strength, duration })\r\n    const matrixScore = environmentalMatrix[duration]?.[strength] ?? 0\r\n    setFinalScore(Math.max(matrixScore, environmentalData.overallRiskAssessment.combinedRisk))\r\n  }\r\n\r\n  const handleSave = () => {\r\n    const evaluationData = {\r\n      environmentalDetails: environmentalData,\r\n      environmentalScore: finalScore,\r\n      environmentalMatrix: selectedMatrix\r\n    }\r\n\r\n    // updateEvaluationData(evaluationData)\r\n    console.log('環境因子データが保存されました', evaluationData)\r\n    alert('環境因子データが保存されました')\r\n  }\r\n\r\n  const handleFileUpload = (files: FileList) => {\r\n    // TODO: Process uploaded files\r\n  }\r\n\r\n  const handleBackToMain = () => {\r\n    window.location.href = '/evaluation/new'\r\n  }\r\n\r\n  const renderSubstancesTab = () => (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"flex justify-between items-center\">\r\n        <h3 className=\"text-lg font-semibold\">化学物質・有害物質評価</h3>\r\n        <Button onClick={addNewSubstance} variant=\"outline\" size=\"sm\">\r\n          + 物質追加\r\n        </Button>\r\n      </div>\r\n\r\n      <div className=\"space-y-4\">\r\n        {environmentalData.substances.map((substance) => (\r\n          <div key={substance.id} className=\"card p-4 border rounded\">\r\n            <div className=\"flex justify-between items-start mb-3\">\r\n              <div className=\"flex-1 grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                <Input\r\n                  label=\"物質名\"\r\n                  value={substance.substanceName}\r\n                  onChange={(e) => handleSubstanceChange(substance.id, 'substanceName', e.target.value)}\r\n                  placeholder=\"物質名を入力\"\r\n                />\r\n                \r\n                <div>\r\n                  <label className=\"block text-sm font-medium mb-1\">カテゴリ</label>\r\n                  <select\r\n                    value={substance.category}\r\n                    onChange={(e) => handleSubstanceChange(substance.id, 'category', e.target.value)}\r\n                    className=\"w-full p-2 border rounded\"\r\n                  >\r\n                    <option value=\"chemical\">化学物質</option>\r\n                    <option value=\"physical\">物理的要因</option>\r\n                    <option value=\"biological\">生物学的要因</option>\r\n                  </select>\r\n                </div>\r\n              </div>\r\n              \r\n              <Button\r\n                onClick={() => removeSubstance(substance.id)}\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                className=\"text-red-600 hover:text-red-800 ml-2\"\r\n              >\r\n                削除\r\n              </Button>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n              <Input\r\n                label=\"基準値\"\r\n                type=\"number\"\r\n                value={substance.standardValue.toString()}\r\n                onChange={(e) => handleSubstanceChange(substance.id, 'standardValue', parseFloat(e.target.value) || 0)}\r\n              />\r\n              \r\n              <Input\r\n                label=\"測定値\"\r\n                type=\"number\"\r\n                value={substance.measuredValue.toString()}\r\n                onChange={(e) => handleSubstanceChange(substance.id, 'measuredValue', parseFloat(e.target.value) || 0)}\r\n              />\r\n              \r\n              <Input\r\n                label=\"単位\"\r\n                value={substance.measurementUnit}\r\n                onChange={(e) => handleSubstanceChange(substance.id, 'measurementUnit', e.target.value)}\r\n              />\r\n              \r\n              <Input\r\n                label=\"暴露時間 (h)\"\r\n                type=\"number\"\r\n                value={substance.exposureTime.toString()}\r\n                onChange={(e) => handleSubstanceChange(substance.id, 'exposureTime', parseFloat(e.target.value) || 0)}\r\n              />\r\n            </div>\r\n\r\n            <div className=\"mt-3 flex items-center justify-between\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium mb-1\">防護レベル</label>\r\n                <select\r\n                  value={substance.protectionLevel}\r\n                  onChange={(e) => handleSubstanceChange(substance.id, 'protectionLevel', e.target.value)}\r\n                  className=\"p-2 border rounded\"\r\n                >\r\n                  <option value=\"none\">なし</option>\r\n                  <option value=\"low\">低</option>\r\n                  <option value=\"medium\">中</option>\r\n                  <option value=\"high\">高</option>\r\n                </select>\r\n              </div>\r\n              \r\n              <div className=\"text-right\">\r\n                <div className=\"text-sm text-gray-600\">リスク比率</div>\r\n                <div className={`font-bold ${\r\n                  substance.measuredValue / substance.standardValue > 1 ? 'text-red-600' : \r\n                  substance.measuredValue / substance.standardValue > 0.8 ? 'text-orange-600' : 'text-green-600'\r\n                }`}>\r\n                  {substance.standardValue > 0 ? \r\n                    `${((substance.measuredValue / substance.standardValue) * 100).toFixed(1)}%` : \r\n                    'N/A'\r\n                  }\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  )\r\n\r\n  const renderConditionsTab = () => (\r\n    <div className=\"space-y-4\">\r\n      <h3 className=\"text-lg font-semibold\">作業環境条件</h3>\r\n      \r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n        {environmentalData.conditions.map((condition) => (\r\n          <div key={condition.id} className={`card p-4 border rounded ${\r\n            condition.isOutOfRange ? 'border-red-300 bg-red-50' : 'border-gray-300'\r\n          }`}>\r\n            <div className=\"flex justify-between items-center mb-3\">\r\n              <h4 className=\"font-medium\">{condition.label}</h4>\r\n              <span className={`px-2 py-1 text-xs rounded ${\r\n                condition.severity === 'critical' ? 'bg-red-600 text-white' :\r\n                condition.severity === 'high' ? 'bg-red-400 text-white' :\r\n                condition.severity === 'medium' ? 'bg-orange-400 text-white' :\r\n                'bg-green-400 text-white'\r\n              }`}>\r\n                {condition.severity === 'critical' ? '危険' :\r\n                 condition.severity === 'high' ? '高リスク' :\r\n                 condition.severity === 'medium' ? '注意' : '正常'}\r\n              </span>\r\n            </div>\r\n            \r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span>基準範囲:</span>\r\n                <span>{condition.standardMin} - {condition.standardMax} {condition.measurementUnit}</span>\r\n              </div>\r\n              \r\n              <Input\r\n                label=\"測定値\"\r\n                type=\"number\"\r\n                value={condition.currentValue.toString()}\r\n                onChange={(e) => handleConditionChange(condition.id, 'currentValue', parseFloat(e.target.value) || 0)}\r\n              />\r\n              \r\n              {condition.isOutOfRange && (\r\n                <div className=\"text-sm text-red-600 font-medium\">\r\n                  ⚠️ 基準値範囲外です\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  )\r\n\r\n  const renderAssessmentTab = () => (\r\n    <div className=\"space-y-6\">\r\n      <h3 className=\"text-lg font-semibold\">総合リスク評価</h3>\r\n      \r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n        <div className=\"card p-4 text-center\">\r\n          <div className=\"text-2xl font-bold text-blue-600\">\r\n            {environmentalData.overallRiskAssessment.chemicalRisk}\r\n          </div>\r\n          <div className=\"text-sm text-gray-600\">化学的リスク</div>\r\n        </div>\r\n        \r\n        <div className=\"card p-4 text-center\">\r\n          <div className=\"text-2xl font-bold text-green-600\">\r\n            {environmentalData.overallRiskAssessment.physicalRisk}\r\n          </div>\r\n          <div className=\"text-sm text-gray-600\">物理的リスク</div>\r\n        </div>\r\n        \r\n        <div className=\"card p-4 text-center\">\r\n          <div className=\"text-2xl font-bold text-orange-600\">\r\n            {environmentalData.overallRiskAssessment.biologicalRisk}\r\n          </div>\r\n          <div className=\"text-sm text-gray-600\">生物学的リスク</div>\r\n        </div>\r\n        \r\n        <div className=\"card p-4 text-center\">\r\n          <div className=\"text-2xl font-bold text-red-600\">\r\n            {environmentalData.overallRiskAssessment.combinedRisk}\r\n          </div>\r\n          <div className=\"text-sm text-gray-600\">総合リスク</div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* マトリクス選択 */}\r\n      <div className=\"card p-6\">\r\n        <h4 className=\"text-lg font-semibold mb-4\">環境リスクマトリクス</h4>\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"w-full border-collapse\">\r\n            <thead>\r\n              <tr>\r\n                <th className=\"border p-2 bg-gray-100\">暴露レベル＼継続時間</th>\r\n                <th className=\"border p-2 bg-gray-100\">短時間<br/>(&lt;10%)</th>\r\n                <th className=\"border p-2 bg-gray-100\">短期間<br/>(10-25%)</th>\r\n                <th className=\"border p-2 bg-gray-100\">中期間<br/>(25-50%)</th>\r\n                <th className=\"border p-2 bg-gray-100\">長期間<br/>(50-75%)</th>\r\n                <th className=\"border p-2 bg-gray-100\">常時<br/>(&gt;75%)</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {environmentalMatrix.map((row, durIndex) => (\r\n                <tr key={durIndex}>\r\n                  <td className=\"border p-2 bg-gray-50 font-medium\">\r\n                    {durIndex === 0 ? '軽微な暴露' : durIndex === 1 ? '中程度の暴露' : '重度の暴露'}\r\n                  </td>\r\n                  {row.map((value, strIndex) => (\r\n                    <td\r\n                      key={strIndex}\r\n                      className={`border p-2 text-center cursor-pointer hover:bg-gray-100 ${\r\n                        selectedMatrix.strength === strIndex && selectedMatrix.duration === durIndex\r\n                          ? 'bg-blue-200 font-bold'\r\n                          : ''\r\n                      } ${\r\n                        value >= 7 ? 'bg-red-100' : value >= 4 ? 'bg-orange-100' : 'bg-green-100'\r\n                      }`}\r\n                      onClick={() => handleMatrixClick(strIndex, durIndex)}\r\n                    >\r\n                      {value}\r\n                    </td>\r\n                  ))}\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n        <div className=\"mt-4 text-center\">\r\n          <div className=\"text-lg font-semibold\">\r\n            最終環境因子スコア: <span className=\"text-blue-600\">{finalScore}</span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n\r\n  const renderProtectionTab = () => (\r\n    <div className=\"space-y-6\">\r\n      <h3 className=\"text-lg font-semibold\">保護対策・管理措置</h3>\r\n      \r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n        <div className=\"card p-4\">\r\n          <h4 className=\"font-semibold mb-3\">個人防護具</h4>\r\n          <div className=\"space-y-2\">\r\n            {['呼吸器保護具', '皮膚保護具', '眼・顔面保護具', '聴覚保護具'].map((item) => (\r\n              <label key={item} className=\"flex items-center\">\r\n                <input type=\"checkbox\" className=\"mr-2\" />\r\n                <span className=\"text-sm\">{item}</span>\r\n              </label>\r\n            ))}\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"card p-4\">\r\n          <h4 className=\"font-semibold mb-3\">工学的対策</h4>\r\n          <div className=\"space-y-2\">\r\n            {['局所排気装置', '密閉化', '換気システム', '自動化・遠隔操作'].map((item) => (\r\n              <label key={item} className=\"flex items-center\">\r\n                <input type=\"checkbox\" className=\"mr-2\" />\r\n                <span className=\"text-sm\">{item}</span>\r\n              </label>\r\n            ))}\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"card p-4\">\r\n          <h4 className=\"font-semibold mb-3\">管理的対策</h4>\r\n          <div className=\"space-y-2\">\r\n            {['作業手順書', '教育訓練', '健康管理', '作業時間制限'].map((item) => (\r\n              <label key={item} className=\"flex items-center\">\r\n                <input type=\"checkbox\" className=\"mr-2\" />\r\n                <span className=\"text-sm\">{item}</span>\r\n              </label>\r\n            ))}\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"card p-4\">\r\n          <h4 className=\"font-semibold mb-3\">緊急時対応</h4>\r\n          <div className=\"space-y-2\">\r\n            {['緊急シャワー', '洗眼設備', '応急処置', '避難経路'].map((item) => (\r\n              <label key={item} className=\"flex items-center\">\r\n                <input type=\"checkbox\" className=\"mr-2\" />\r\n                <span className=\"text-sm\">{item}</span>\r\n              </label>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900\">\r\n      <section className=\"flex-1 p-3 overflow-hidden\">\r\n        {/* 上段: 写真・資料エリア */}\r\n        <div className=\"mb-4\">\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4\">\r\n            <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-4\">\r\n              <div className=\"lg:col-span-1\">\r\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-3\">作業写真</h3>\r\n                <PhotoViewer\r\n                  mainPhoto={photoUrl}\r\n                  className=\"rounded-lg\"\r\n                />\r\n              </div>\r\n              <div className=\"lg:col-span-3\">\r\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-3\">追加資料</h3>\r\n                <FileUpload\r\n                  onFileUpload={handleFileUpload}\r\n                  variant=\"document\"\r\n                  layout=\"vertical\"\r\n                  size=\"md\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* 下段: 評価エリア */}\r\n        <div className=\"environmental-factors bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 flex-1 flex flex-col min-h-0\">\r\n          {/* タブナビゲーション */}\r\n          <div className=\"border-b border-gray-200 dark:border-gray-700\">\r\n            <nav className=\"flex flex-wrap gap-2 px-4 py-3\">\r\n              {[\r\n                { key: 'substances', label: '物質評価', icon: '🧪' },\r\n                { key: 'conditions', label: '環境条件', icon: '🌡️' },\r\n                { key: 'assessment', label: 'リスク評価', icon: '📊' },\r\n                { key: 'protection', label: '保護対策', icon: '🛡️' }\r\n              ].map((tab) => (\r\n                <button\r\n                  key={tab.key}\r\n                  onClick={() => setActiveTab(tab.key as 'substances' | 'conditions' | 'protection')}\r\n                  className={`flex items-center space-x-2 px-4 py-2 rounded-lg font-medium text-sm transition-colors ${\r\n                    activeTab === tab.key\r\n                      ? 'bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 border border-blue-200 dark:border-blue-700'\r\n                      : 'text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700'\r\n                  }`}\r\n                    >\r\n                      <span>{tab.icon}</span>\r\n                      <span>{tab.label}</span>\r\n                    </button>\r\n                  ))}\r\n            </nav>\r\n          </div>\r\n\r\n          {/* タブコンテンツ */}\r\n          <div className=\"flex-1 p-4 overflow-y-auto\">\r\n            {activeTab === 'substances' && renderSubstancesTab()}\r\n            {activeTab === 'conditions' && renderConditionsTab()}\r\n            {activeTab === 'assessment' && renderAssessmentTab()}\r\n            {activeTab === 'protection' && renderProtectionTab()}\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n    </div>\r\n  )\r\n}","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\EnhancedWorkTimeDetail.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'OptimizedImage' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEvaluationStore' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'evaluationNo' is defined but never used. Allowed unused args must match /^_/u.","line":145,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":145,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'creator' is defined but never used. Allowed unused args must match /^_/u.","line":146,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":146,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'checker' is defined but never used. Allowed unused args must match /^_/u.","line":147,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":147,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'workInfo' is defined but never used. Allowed unused args must match /^_/u.","line":148,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":148,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setShiftPatterns' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":156,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":156,"endColumn":41},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'selectedShift' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":157,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":157,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'setSelectedShift' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":157,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":157,"endColumn":41},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'calculateMaxTime', 'calculateProductivity', and 'performAnalysis'. Either include them or remove the dependency array.","line":169,"column":6,"nodeType":"ArrayExpression","endLine":169,"endColumn":33,"suggestions":[{"desc":"Update the dependencies array to be: [workerList, shiftPatterns, calculateMaxTime, performAnalysis, calculateProductivity]","fix":{"range":[3892,3919],"text":"[workerList, shiftPatterns, calculateMaxTime, performAnalysis, calculateProductivity]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleSave' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":306,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":306,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'files' is defined but never used. Allowed unused args must match /^_/u.","line":323,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":323,"endColumn":34},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleBackToMain' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":327,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":327,"endColumn":25},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":692,"column":15,"nodeType":"JSXOpeningElement","endLine":696,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport React, { useState, useEffect } from 'react'\r\nimport { FileUpload, Input, Button } from '@/components/ui'\r\nimport { OptimizedImage } from '@/components/optimized/OptimizedImage'\r\nimport { useEvaluationStore } from '@/hooks/useEvaluationStore'\r\n\r\nexport interface Worker {\r\n  id: string\r\n  name: string\r\n  laborTime: number\r\n  actualWorkTime: number\r\n  ratio: number\r\n  timeClass: string\r\n  restTime: number\r\n  overtimeHours: number\r\n  nightShiftHours: number\r\n  workLoad: number\r\n}\r\n\r\nexport interface ShiftPattern {\r\n  id: string\r\n  name: string\r\n  startTime: string\r\n  endTime: string\r\n  duration: number\r\n  breakTime: number\r\n  effectiveWorkTime: number\r\n  nightShiftBonus: number\r\n}\r\n\r\nexport interface WorkTimeAnalysis {\r\n  totalWorkers: number\r\n  averageWorkTime: number\r\n  averageEfficiency: number\r\n  overtimeWorkers: number\r\n  overtimeHours: number\r\n  fatigueIndex: number\r\n  riskLevel: 'low' | 'medium' | 'high' | 'critical'\r\n  recommendations: string[]\r\n}\r\n\r\nexport interface ProductivityMetrics {\r\n  workEfficiency: number\r\n  timeUtilization: number\r\n  restTimeRatio: number\r\n  overallProductivity: number\r\n  bottleneckFactors: string[]\r\n}\r\n\r\nexport interface EnhancedWorkTimeDetailProps {\r\n  evaluationNo?: string\r\n  creator?: {\r\n    department: string\r\n    name: string\r\n    date: string\r\n  }\r\n  checker?: {\r\n    department: string\r\n    name: string\r\n    date: string\r\n  }\r\n  workInfo?: {\r\n    workName: string\r\n    factoryName: string\r\n    processName: string\r\n  }\r\n  photoUrl?: string\r\n  workers?: Worker[]\r\n}\r\n\r\nconst defaultWorkers: Worker[] = [\r\n  {\r\n    id: '1',\r\n    name: 'Aさん',\r\n    laborTime: 8.0,\r\n    actualWorkTime: 6.8,\r\n    ratio: 85,\r\n    timeClass: 'e',\r\n    restTime: 1.0,\r\n    overtimeHours: 0,\r\n    nightShiftHours: 0,\r\n    workLoad: 7\r\n  },\r\n  {\r\n    id: '2',\r\n    name: 'Bさん',\r\n    laborTime: 8.0,\r\n    actualWorkTime: 7.2,\r\n    ratio: 90,\r\n    timeClass: 'e',\r\n    restTime: 0.8,\r\n    overtimeHours: 0.5,\r\n    nightShiftHours: 0,\r\n    workLoad: 8\r\n  },\r\n  {\r\n    id: '3',\r\n    name: 'Cさん',\r\n    laborTime: 8.0,\r\n    actualWorkTime: 1.0,\r\n    ratio: 13,\r\n    timeClass: 'c',\r\n    restTime: 6.0,\r\n    overtimeHours: 0,\r\n    nightShiftHours: 0,\r\n    workLoad: 2\r\n  }\r\n]\r\n\r\nconst defaultShiftPatterns: ShiftPattern[] = [\r\n  {\r\n    id: '1',\r\n    name: '昼勤',\r\n    startTime: '08:00',\r\n    endTime: '17:00',\r\n    duration: 8.0,\r\n    breakTime: 1.0,\r\n    effectiveWorkTime: 7.0,\r\n    nightShiftBonus: 1.0\r\n  },\r\n  {\r\n    id: '2',\r\n    name: '夜勤',\r\n    startTime: '20:00',\r\n    endTime: '05:00',\r\n    duration: 8.0,\r\n    breakTime: 1.0,\r\n    effectiveWorkTime: 7.0,\r\n    nightShiftBonus: 1.2\r\n  },\r\n  {\r\n    id: '3',\r\n    name: '交代制A',\r\n    startTime: '06:00',\r\n    endTime: '14:00',\r\n    duration: 8.0,\r\n    breakTime: 1.0,\r\n    effectiveWorkTime: 7.0,\r\n    nightShiftBonus: 1.0\r\n  }\r\n]\r\n\r\nexport function EnhancedWorkTimeDetail({\r\n  evaluationNo,\r\n  creator,\r\n  checker,\r\n  workInfo,\r\n  photoUrl = 'https://placehold.co/600x450/e5e7eb/4b5563?text=Work+Time+Analysis',\r\n  workers = defaultWorkers\r\n}: EnhancedWorkTimeDetailProps): React.JSX.Element {\r\n  \r\n  // const { updateEvaluationData } = useEvaluationStore()\r\n  \r\n  const [workerList, setWorkerList] = useState(workers)\r\n  const [shiftPatterns, setShiftPatterns] = useState(defaultShiftPatterns)\r\n  const [selectedShift, setSelectedShift] = useState('1')\r\n  const [maxTime, setMaxTime] = useState(0)\r\n  const [maxTimeClass, setMaxTimeClass] = useState('')\r\n  const [maxWorkerId, setMaxWorkerId] = useState('')\r\n  const [analysis, setAnalysis] = useState<WorkTimeAnalysis | null>(null)\r\n  const [productivity, setProductivity] = useState<ProductivityMetrics | null>(null)\r\n  const [activeTab, setActiveTab] = useState<'workers' | 'shifts' | 'analysis' | 'productivity'>('workers')\r\n\r\n  useEffect(() => {\r\n    calculateMaxTime()\r\n    performAnalysis()\r\n    calculateProductivity()\r\n  }, [workerList, shiftPatterns])\r\n\r\n  const getTimeClass = (hours: number): string => {\r\n    if (hours < 0.25) return 'a'\r\n    if (hours < 1) return 'b'\r\n    if (hours < 3) return 'c'\r\n    if (hours < 6.5) return 'd'\r\n    return 'e'\r\n  }\r\n\r\n  const calculateRatio = (laborTime: number, actualWorkTime: number): number => {\r\n    if (laborTime === 0) return 0\r\n    return Math.round((actualWorkTime / laborTime) * 100)\r\n  }\r\n\r\n  const calculateMaxTime = () => {\r\n    if (workerList.length === 0) return\r\n    \r\n    const maxWorker = workerList.reduce((max, worker) => \r\n      worker.actualWorkTime > max.actualWorkTime ? worker : max\r\n    )\r\n    \r\n    setMaxTime(maxWorker.actualWorkTime)\r\n    setMaxTimeClass(maxWorker.timeClass)\r\n    setMaxWorkerId(maxWorker.id)\r\n  }\r\n\r\n  const performAnalysis = () => {\r\n    const totalWorkers = workerList.length\r\n    const totalWorkTime = workerList.reduce((sum, w) => sum + w.actualWorkTime, 0)\r\n    const totalOvertimeHours = workerList.reduce((sum, w) => sum + w.overtimeHours, 0)\r\n    const overtimeWorkers = workerList.filter(w => w.overtimeHours > 0).length\r\n    \r\n    const averageWorkTime = totalWorkers > 0 ? totalWorkTime / totalWorkers : 0\r\n    const averageEfficiency = totalWorkers > 0 ? \r\n      workerList.reduce((sum, w) => sum + w.ratio, 0) / totalWorkers : 0\r\n    \r\n    // 疲労指数の計算（労働時間・残業・夜勤を考慮）\r\n    const fatigueIndex = workerList.reduce((total, worker) => {\r\n      const base = worker.actualWorkTime\r\n      const overtime = worker.overtimeHours * 1.5\r\n      const nightShift = worker.nightShiftHours * 1.3\r\n      const workLoad = worker.workLoad * 0.1\r\n      return total + (base + overtime + nightShift + workLoad)\r\n    }, 0) / totalWorkers\r\n\r\n    // リスクレベル判定\r\n    let riskLevel: 'low' | 'medium' | 'high' | 'critical' = 'low'\r\n    if (fatigueIndex > 10) riskLevel = 'critical'\r\n    else if (fatigueIndex > 8) riskLevel = 'high'\r\n    else if (fatigueIndex > 6) riskLevel = 'medium'\r\n\r\n    // 推奨事項\r\n    const recommendations: string[] = []\r\n    if (averageWorkTime > 7) recommendations.push('長時間労働の改善が必要')\r\n    if (overtimeWorkers > totalWorkers * 0.5) recommendations.push('残業時間の削減を検討')\r\n    if (averageEfficiency < 70) recommendations.push('作業効率の向上が必要')\r\n    if (fatigueIndex > 8) recommendations.push('疲労軽減対策の実施が必要')\r\n\r\n    setAnalysis({\r\n      totalWorkers,\r\n      averageWorkTime,\r\n      averageEfficiency,\r\n      overtimeWorkers,\r\n      overtimeHours: totalOvertimeHours,\r\n      fatigueIndex,\r\n      riskLevel,\r\n      recommendations\r\n    })\r\n  }\r\n\r\n  const calculateProductivity = () => {\r\n    if (workerList.length === 0) return\r\n\r\n    const totalLaborTime = workerList.reduce((sum, w) => sum + w.laborTime, 0)\r\n    const totalActualTime = workerList.reduce((sum, w) => sum + w.actualWorkTime, 0)\r\n    const totalRestTime = workerList.reduce((sum, w) => sum + w.restTime, 0)\r\n\r\n    const workEfficiency = totalLaborTime > 0 ? (totalActualTime / totalLaborTime) * 100 : 0\r\n    const timeUtilization = (totalLaborTime + totalRestTime) > 0 ? \r\n      (totalActualTime / (totalLaborTime + totalRestTime)) * 100 : 0\r\n    const restTimeRatio = totalLaborTime > 0 ? (totalRestTime / totalLaborTime) * 100 : 0\r\n    \r\n    const overallProductivity = (workEfficiency + timeUtilization) / 2\r\n\r\n    const bottleneckFactors: string[] = []\r\n    if (workEfficiency < 70) bottleneckFactors.push('作業効率の低下')\r\n    if (restTimeRatio > 30) bottleneckFactors.push('過剰な休憩時間')\r\n    if (timeUtilization < 60) bottleneckFactors.push('時間活用の非効率')\r\n\r\n    setProductivity({\r\n      workEfficiency,\r\n      timeUtilization,\r\n      restTimeRatio,\r\n      overallProductivity,\r\n      bottleneckFactors\r\n    })\r\n  }\r\n\r\n  const updateWorker = (id: string, field: keyof Worker, value: string | number) => {\r\n    setWorkerList(prev => prev.map(worker => {\r\n      if (worker.id === id) {\r\n        const updated = { ...worker, [field]: typeof value === 'string' ? parseFloat(value) || 0 : value }\r\n        if (field === 'laborTime' || field === 'actualWorkTime') {\r\n          updated.ratio = calculateRatio(updated.laborTime, updated.actualWorkTime)\r\n          updated.timeClass = getTimeClass(updated.actualWorkTime)\r\n        }\r\n        return updated\r\n      }\r\n      return worker\r\n    }))\r\n  }\r\n\r\n  const addWorker = () => {\r\n    const workerCount = workerList.length\r\n    const workerLetter = String.fromCharCode(65 + workerCount)\r\n    \r\n    const newWorker: Worker = {\r\n      id: `worker_${Date.now()}`,\r\n      name: `${workerLetter}さん`,\r\n      laborTime: 8.0,\r\n      actualWorkTime: 7.0,\r\n      ratio: 88,\r\n      timeClass: 'e',\r\n      restTime: 1.0,\r\n      overtimeHours: 0,\r\n      nightShiftHours: 0,\r\n      workLoad: 5\r\n    }\r\n    \r\n    setWorkerList(prev => [...prev, newWorker])\r\n  }\r\n\r\n  const removeWorker = (id: string) => {\r\n    setWorkerList(prev => prev.filter(w => w.id !== id))\r\n  }\r\n\r\n  const handleSave = () => {\r\n    const evaluationData = {\r\n      workTimeDetails: {\r\n        workers: workerList,\r\n        maxTime,\r\n        maxTimeClass,\r\n        analysis,\r\n        productivity\r\n      },\r\n      workTimeScore: analysis?.fatigueIndex || 1\r\n    }\r\n\r\n    // updateEvaluationData(evaluationData)\r\n    console.log('作業時間データが保存されました', evaluationData)\r\n    alert('作業時間データが保存されました')\r\n  }\r\n\r\n  const handleFileUpload = (files: FileList) => {\r\n    // TODO: Process uploaded files\r\n  }\r\n\r\n  const handleBackToMain = () => {\r\n    window.location.href = '/evaluation/new'\r\n  }\r\n\r\n  const renderWorkersTab = () => (\r\n    <div className=\"space-y-4\">\r\n      <div className=\"flex justify-between items-center\">\r\n        <h3 className=\"text-lg font-semibold\">作業者別時間分析</h3>\r\n        <Button onClick={addWorker} variant=\"outline\" size=\"sm\">\r\n          + 作業者追加\r\n        </Button>\r\n      </div>\r\n\r\n      <div className=\"overflow-x-auto\">\r\n        <table className=\"w-full border-collapse border\">\r\n          <thead>\r\n            <tr className=\"bg-gray-50\">\r\n              <th className=\"border p-2 text-left\">作業者</th>\r\n              <th className=\"border p-2\">労働時間(h)</th>\r\n              <th className=\"border p-2\">実働時間(h)</th>\r\n              <th className=\"border p-2\">休憩時間(h)</th>\r\n              <th className=\"border p-2\">残業時間(h)</th>\r\n              <th className=\"border p-2\">夜勤時間(h)</th>\r\n              <th className=\"border p-2\">作業負荷</th>\r\n              <th className=\"border p-2\">効率(%)</th>\r\n              <th className=\"border p-2\">時間級</th>\r\n              <th className=\"border p-2\">操作</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {workerList.map((worker) => (\r\n              <tr key={worker.id} className={worker.id === maxWorkerId ? 'bg-yellow-50' : ''}>\r\n                <td className=\"border p-2\">\r\n                  <Input\r\n                    value={worker.name}\r\n                    onChange={(e) => updateWorker(worker.id, 'name', e.target.value)}\r\n                    className=\"w-20\"\r\n                  />\r\n                </td>\r\n                <td className=\"border p-2\">\r\n                  <Input\r\n                    type=\"number\"\r\n                    value={worker.laborTime.toString()}\r\n                    onChange={(e) => updateWorker(worker.id, 'laborTime', e.target.value)}\r\n                    className=\"w-20\"\r\n                  />\r\n                </td>\r\n                <td className=\"border p-2\">\r\n                  <Input\r\n                    type=\"number\"\r\n                    step=\"0.1\"\r\n                    value={worker.actualWorkTime.toString()}\r\n                    onChange={(e) => updateWorker(worker.id, 'actualWorkTime', e.target.value)}\r\n                    className=\"w-20\"\r\n                  />\r\n                </td>\r\n                <td className=\"border p-2\">\r\n                  <Input\r\n                    type=\"number\"\r\n                    step=\"0.1\"\r\n                    value={worker.restTime.toString()}\r\n                    onChange={(e) => updateWorker(worker.id, 'restTime', e.target.value)}\r\n                    className=\"w-20\"\r\n                  />\r\n                </td>\r\n                <td className=\"border p-2\">\r\n                  <Input\r\n                    type=\"number\"\r\n                    step=\"0.1\"\r\n                    value={worker.overtimeHours.toString()}\r\n                    onChange={(e) => updateWorker(worker.id, 'overtimeHours', e.target.value)}\r\n                    className=\"w-20\"\r\n                  />\r\n                </td>\r\n                <td className=\"border p-2\">\r\n                  <Input\r\n                    type=\"number\"\r\n                    step=\"0.1\"\r\n                    value={worker.nightShiftHours.toString()}\r\n                    onChange={(e) => updateWorker(worker.id, 'nightShiftHours', e.target.value)}\r\n                    className=\"w-20\"\r\n                  />\r\n                </td>\r\n                <td className=\"border p-2\">\r\n                  <Input\r\n                    type=\"number\"\r\n                    min=\"1\"\r\n                    max=\"10\"\r\n                    value={worker.workLoad.toString()}\r\n                    onChange={(e) => updateWorker(worker.id, 'workLoad', e.target.value)}\r\n                    className=\"w-20\"\r\n                  />\r\n                </td>\r\n                <td className=\"border p-2 text-center font-semibold\">\r\n                  {worker.ratio}%\r\n                </td>\r\n                <td className=\"border p-2 text-center\">\r\n                  <span className={`px-2 py-1 rounded text-sm font-medium ${\r\n                    worker.timeClass === 'e' ? 'bg-red-100 text-red-700' :\r\n                    worker.timeClass === 'd' ? 'bg-orange-100 text-orange-700' :\r\n                    worker.timeClass === 'c' ? 'bg-yellow-100 text-yellow-700' :\r\n                    'bg-green-100 text-green-700'\r\n                  }`}>\r\n                    {worker.timeClass.toUpperCase()}\r\n                  </span>\r\n                </td>\r\n                <td className=\"border p-2 text-center\">\r\n                  <Button\r\n                    onClick={() => removeWorker(worker.id)}\r\n                    variant=\"ghost\"\r\n                    size=\"sm\"\r\n                    className=\"text-red-600 hover:text-red-800\"\r\n                  >\r\n                    削除\r\n                  </Button>\r\n                </td>\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      <div className=\"card p-4 bg-blue-50\">\r\n        <h4 className=\"font-semibold mb-2\">時間級について</h4>\r\n        <div className=\"grid grid-cols-2 md:grid-cols-5 gap-2 text-sm\">\r\n          <div><strong>A級:</strong> &lt;0.25時間</div>\r\n          <div><strong>B級:</strong> 0.25-1時間</div>\r\n          <div><strong>C級:</strong> 1-3時間</div>\r\n          <div><strong>D級:</strong> 3-6.5時間</div>\r\n          <div><strong>E級:</strong> &gt;6.5時間</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n\r\n  const renderShiftsTab = () => (\r\n    <div className=\"space-y-4\">\r\n      <h3 className=\"text-lg font-semibold\">シフトパターン管理</h3>\r\n      \r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n        {shiftPatterns.map((shift) => (\r\n          <div key={shift.id} className=\"card p-4 border rounded\">\r\n            <h4 className=\"font-medium mb-3\">{shift.name}</h4>\r\n            \r\n            <div className=\"space-y-2 text-sm\">\r\n              <div className=\"flex justify-between\">\r\n                <span>開始時間:</span>\r\n                <span className=\"font-medium\">{shift.startTime}</span>\r\n              </div>\r\n              <div className=\"flex justify-between\">\r\n                <span>終了時間:</span>\r\n                <span className=\"font-medium\">{shift.endTime}</span>\r\n              </div>\r\n              <div className=\"flex justify-between\">\r\n                <span>総労働時間:</span>\r\n                <span className=\"font-medium\">{shift.duration}時間</span>\r\n              </div>\r\n              <div className=\"flex justify-between\">\r\n                <span>休憩時間:</span>\r\n                <span className=\"font-medium\">{shift.breakTime}時間</span>\r\n              </div>\r\n              <div className=\"flex justify-between\">\r\n                <span>実働時間:</span>\r\n                <span className=\"font-medium text-blue-600\">{shift.effectiveWorkTime}時間</span>\r\n              </div>\r\n              <div className=\"flex justify-between\">\r\n                <span>夜勤倍率:</span>\r\n                <span className=\"font-medium\">{shift.nightShiftBonus}倍</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  )\r\n\r\n  const renderAnalysisTab = () => (\r\n    <div className=\"space-y-6\">\r\n      <h3 className=\"text-lg font-semibold\">作業時間分析結果</h3>\r\n      \r\n      {analysis && (\r\n        <>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n            <div className=\"card p-4 text-center\">\r\n              <div className=\"text-2xl font-bold text-blue-600\">{analysis.totalWorkers}</div>\r\n              <div className=\"text-sm text-gray-600\">総作業者数</div>\r\n            </div>\r\n            \r\n            <div className=\"card p-4 text-center\">\r\n              <div className=\"text-2xl font-bold text-green-600\">\r\n                {analysis.averageWorkTime.toFixed(1)}h\r\n              </div>\r\n              <div className=\"text-sm text-gray-600\">平均労働時間</div>\r\n            </div>\r\n            \r\n            <div className=\"card p-4 text-center\">\r\n              <div className=\"text-2xl font-bold text-orange-600\">\r\n                {analysis.averageEfficiency.toFixed(1)}%\r\n              </div>\r\n              <div className=\"text-sm text-gray-600\">平均作業効率</div>\r\n            </div>\r\n            \r\n            <div className=\"card p-4 text-center\">\r\n              <div className=\"text-2xl font-bold text-purple-600\">\r\n                {analysis.fatigueIndex.toFixed(1)}\r\n              </div>\r\n              <div className=\"text-sm text-gray-600\">疲労指数</div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"card p-6\">\r\n            <h4 className=\"text-lg font-semibold mb-4\">リスク評価</h4>\r\n            <div className=\"flex items-center space-x-4 mb-4\">\r\n              <span className=\"text-gray-600\">総合リスクレベル:</span>\r\n              <span className={`px-3 py-1 rounded font-medium ${\r\n                analysis.riskLevel === 'critical' ? 'bg-red-600 text-white' :\r\n                analysis.riskLevel === 'high' ? 'bg-red-400 text-white' :\r\n                analysis.riskLevel === 'medium' ? 'bg-orange-400 text-white' :\r\n                'bg-green-400 text-white'\r\n              }`}>\r\n                {analysis.riskLevel === 'critical' ? '緊急' :\r\n                 analysis.riskLevel === 'high' ? '高リスク' :\r\n                 analysis.riskLevel === 'medium' ? '中リスク' : '低リスク'}\r\n              </span>\r\n            </div>\r\n\r\n            <div>\r\n              <h5 className=\"font-medium mb-2\">推奨改善事項</h5>\r\n              <ul className=\"list-disc list-inside space-y-1\">\r\n                {analysis.recommendations.map((rec, index) => (\r\n                  <li key={index} className=\"text-sm\">{rec}</li>\r\n                ))}\r\n              </ul>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"card p-6\">\r\n            <h4 className=\"text-lg font-semibold mb-4\">残業分析</h4>\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n              <div className=\"text-center\">\r\n                <div className=\"text-xl font-bold\">{analysis.overtimeWorkers}</div>\r\n                <div className=\"text-sm text-gray-600\">残業対象者</div>\r\n              </div>\r\n              <div className=\"text-center\">\r\n                <div className=\"text-xl font-bold\">{analysis.overtimeHours.toFixed(1)}h</div>\r\n                <div className=\"text-sm text-gray-600\">総残業時間</div>\r\n              </div>\r\n              <div className=\"text-center\">\r\n                <div className=\"text-xl font-bold\">\r\n                  {analysis.totalWorkers > 0 ? \r\n                    ((analysis.overtimeWorkers / analysis.totalWorkers) * 100).toFixed(1) : 0}%\r\n                </div>\r\n                <div className=\"text-sm text-gray-600\">残業率</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  )\r\n\r\n  const renderProductivityTab = () => (\r\n    <div className=\"space-y-6\">\r\n      <h3 className=\"text-lg font-semibold\">生産性分析</h3>\r\n      \r\n      {productivity && (\r\n        <>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n            <div className=\"card p-4 text-center\">\r\n              <div className=\"text-2xl font-bold text-blue-600\">\r\n                {productivity.workEfficiency.toFixed(1)}%\r\n              </div>\r\n              <div className=\"text-sm text-gray-600\">作業効率</div>\r\n            </div>\r\n            \r\n            <div className=\"card p-4 text-center\">\r\n              <div className=\"text-2xl font-bold text-green-600\">\r\n                {productivity.timeUtilization.toFixed(1)}%\r\n              </div>\r\n              <div className=\"text-sm text-gray-600\">時間活用率</div>\r\n            </div>\r\n            \r\n            <div className=\"card p-4 text-center\">\r\n              <div className=\"text-2xl font-bold text-orange-600\">\r\n                {productivity.restTimeRatio.toFixed(1)}%\r\n              </div>\r\n              <div className=\"text-sm text-gray-600\">休憩時間比率</div>\r\n            </div>\r\n            \r\n            <div className=\"card p-4 text-center\">\r\n              <div className=\"text-2xl font-bold text-purple-600\">\r\n                {productivity.overallProductivity.toFixed(1)}%\r\n              </div>\r\n              <div className=\"text-sm text-gray-600\">総合生産性</div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"card p-6\">\r\n            <h4 className=\"text-lg font-semibold mb-4\">生産性レーダーチャート</h4>\r\n            <div className=\"flex items-center justify-center h-64 bg-gray-50 rounded\">\r\n              <div className=\"text-center\">\r\n                <div className=\"text-4xl mb-2\">📊</div>\r\n                <div className=\"text-gray-600\">チャート表示エリア</div>\r\n                <div className=\"text-sm text-gray-500 mt-1\">\r\n                  実装時にChart.jsまたは他のライブラリを使用\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"card p-6\">\r\n            <h4 className=\"text-lg font-semibold mb-4\">ボトルネック要因</h4>\r\n            {productivity.bottleneckFactors.length > 0 ? (\r\n              <ul className=\"list-disc list-inside space-y-2\">\r\n                {productivity.bottleneckFactors.map((factor, index) => (\r\n                  <li key={index} className=\"text-sm text-red-600\">\r\n                    ⚠️ {factor}\r\n                  </li>\r\n                ))}\r\n              </ul>\r\n            ) : (\r\n              <div className=\"text-green-600\">\r\n                ✅ 主要なボトルネック要因は検出されませんでした\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          <div className=\"card p-6\">\r\n            <h4 className=\"text-lg font-semibold mb-4\">改善提案</h4>\r\n            <div className=\"space-y-3\">\r\n              {productivity.workEfficiency < 70 && (\r\n                <div className=\"p-3 bg-red-50 border border-red-200 rounded\">\r\n                  <h5 className=\"font-medium text-red-800\">作業効率改善</h5>\r\n                  <p className=\"text-sm text-red-700\">作業プロセスの見直し、自動化の検討、スキル向上研修の実施</p>\r\n                </div>\r\n              )}\r\n              \r\n              {productivity.timeUtilization < 60 && (\r\n                <div className=\"p-3 bg-orange-50 border border-orange-200 rounded\">\r\n                  <h5 className=\"font-medium text-orange-800\">時間活用改善</h5>\r\n                  <p className=\"text-sm text-orange-700\">作業スケジュールの最適化、待機時間の削減対策</p>\r\n                </div>\r\n              )}\r\n              \r\n              {productivity.restTimeRatio > 30 && (\r\n                <div className=\"p-3 bg-yellow-50 border border-yellow-200 rounded\">\r\n                  <h5 className=\"font-medium text-yellow-800\">休憩時間適正化</h5>\r\n                  <p className=\"text-sm text-yellow-700\">休憩時間の見直し、作業負荷の分散検討</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </>\r\n      )}\r\n    </div>\r\n  )\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50\">\r\n      <section className=\"container mx-auto px-4 py-6\">\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-6\">\r\n          {/* 左側: 写真表示エリア */}\r\n          <div className=\"lg:col-span-1\">\r\n            <div className=\"card p-4\">\r\n              <h3 className=\"text-lg font-semibold mb-4\">作業写真・資料</h3>\r\n              <img\r\n                src={photoUrl}\r\n                alt=\"Work time analysis\"\r\n                className=\"w-full h-48 object-cover rounded mb-4\"\r\n              />\r\n              <div className=\"mt-4\">\r\n                <FileUpload\r\n                  onFileUpload={handleFileUpload}\r\n                  variant=\"document\"\r\n                  layout=\"vertical\"\r\n                  size=\"md\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* 最大時間表示 */}\r\n            <div className=\"card p-4 mt-4\">\r\n              <h4 className=\"font-semibold mb-2\">最大労働時間</h4>\r\n              <div className=\"text-center\">\r\n                <div className=\"text-2xl font-bold text-red-600\">\r\n                  {maxTime.toFixed(1)}h\r\n                </div>\r\n                <div className=\"text-sm text-gray-600\">\r\n                  時間級: {maxTimeClass.toUpperCase()}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* 右側: 評価エリア */}\r\n          <form className=\"lg:col-span-3 evaluation-form\" role=\"form\">\r\n            {/* タブナビゲーション */}\r\n            <div className=\"card mb-6\">\r\n              <div className=\"border-b\">\r\n                <nav className=\"flex space-x-8 px-6 py-4\">\r\n                  {[\r\n                    { key: 'workers', label: '作業者分析', icon: '👥' },\r\n                    { key: 'shifts', label: 'シフト管理', icon: '⏰' },\r\n                    { key: 'analysis', label: '時間分析', icon: '📊' },\r\n                    { key: 'productivity', label: '生産性分析', icon: '🎯' }\r\n                  ].map((tab) => (\r\n                    <button\r\n                      key={tab.key}\r\n                      onClick={() => setActiveTab(tab.key as 'analysis' | 'workers' | 'shifts' | 'productivity')}\r\n                      className={`flex items-center space-x-2 py-2 px-1 border-b-2 font-medium text-sm transition-colors ${\r\n                        activeTab === tab.key\r\n                          ? 'border-blue-500 text-blue-600'\r\n                          : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\r\n                      }`}\r\n                    >\r\n                      <span>{tab.icon}</span>\r\n                      <span>{tab.label}</span>\r\n                    </button>\r\n                  ))}\r\n                </nav>\r\n              </div>\r\n\r\n              <div className=\"p-6\">\r\n                {activeTab === 'workers' && renderWorkersTab()}\r\n                {activeTab === 'shifts' && renderShiftsTab()}\r\n                {activeTab === 'analysis' && renderAnalysisTab()}\r\n                {activeTab === 'productivity' && renderProductivityTab()}\r\n              </div>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </section>\r\n\r\n    </div>\r\n  )\r\n}","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\EnvironmentalFactorDetail.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'EVALUATION_STANDARDS' is defined but never used. Allowed unused vars must match /^_/u.","line":7,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'DEFAULT_EVALUATION_DATA' is defined but never used. Allowed unused vars must match /^_/u.","line":7,"column":32,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":55},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'files' is defined but never used. Allowed unused args must match /^_/u.","line":81,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":81,"endColumn":34},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleBackToMain' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":85,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":85,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport React, { useState } from 'react'\r\nimport { Header } from '@/components/layout'\r\nimport { FileUpload, Input, Button } from '@/components/ui'\r\nimport { PhotoViewer } from '@/components/evaluation'\r\nimport { EVALUATION_STANDARDS, DEFAULT_EVALUATION_DATA } from '@/data/defaultEvaluationData'\r\n\r\nexport interface EnvironmentalItem {\r\n  id: string\r\n  label: string\r\n  isChecked: boolean\r\n  thinkingValue?: string\r\n  standardValue?: string\r\n  measuredValue?: string\r\n  exposureDuration?: string\r\n  evaluation?: string\r\n  unit?: string\r\n}\r\n\r\nexport interface EnvironmentalFactorDetailProps {\r\n  evaluationNo?: string\r\n  creator?: {\r\n    department: string\r\n    name: string\r\n    date: string\r\n  }\r\n  checker?: {\r\n    department: string\r\n    name: string\r\n    date: string\r\n  }\r\n  workInfo?: {\r\n    workName: string\r\n    factoryName: string\r\n    processName: string\r\n  }\r\n  photoUrl?: string\r\n  environmentalItems?: EnvironmentalItem[]\r\n}\r\n\r\n// デフォルトの環境因子項目\r\nconst defaultEnvironmentalItems: EnvironmentalItem[] = [\r\n  { id: '1', label: '一般化学物質', isChecked: false, unit: 'ppm' },\r\n  { id: '2', label: 'アンモニア', isChecked: false, standardValue: '20ppm', unit: 'ppm' },\r\n  { id: '3', label: '汚れ付着', isChecked: false },\r\n  { id: '4', label: '粉塵雰囲気', isChecked: false, unit: 'ppm' },\r\n  { id: '5', label: '高温', isChecked: false, unit: 'WBGT°C' },\r\n  { id: '6', label: '寒冷', isChecked: false, unit: '°C' },\r\n  { id: '7', label: '環境騒音', isChecked: false, unit: 'dB' },\r\n  { id: '8', label: '衝撃騒音', isChecked: false, unit: 'dB' },\r\n  { id: '9', label: '全身振動', isChecked: false, unit: 'm/s2' },\r\n  { id: '10', label: '手腕振動', isChecked: false, unit: 'm/s2' },\r\n  { id: '11', label: '紫外線', isChecked: false, unit: 'J/m2' }\r\n]\r\n\r\nexport function EnvironmentalFactorDetail({\r\n  evaluationNo,\r\n  creator,\r\n  checker,\r\n  workInfo,\r\n  photoUrl = 'https://placehold.co/600x450/e5e7eb/4b5563?text=Photo',\r\n  environmentalItems = defaultEnvironmentalItems\r\n}: EnvironmentalFactorDetailProps): React.JSX.Element {\r\n  const [items, setItems] = useState(environmentalItems)\r\n  const [selectedMatrix, setSelectedMatrix] = useState({ strength: 1, duration: 1 })\r\n  const [finalScore, setFinalScore] = useState(1)\r\n\r\n  const handleCheckboxChange = (itemId: string, checked: boolean) => {\r\n    setItems(prev => prev.map(item =>\r\n      item.id === itemId ? { ...item, isChecked: checked } : item\r\n    ))\r\n  }\r\n\r\n  const handleInputChange = (itemId: string, field: string, value: string) => {\r\n    setItems(prev => prev.map(item =>\r\n      item.id === itemId ? { ...item, [field]: value } : item\r\n    ))\r\n  }\r\n\r\n  const handleFileUpload = (files: FileList) => {\r\n    // TODO: Process uploaded files\r\n  }\r\n\r\n  const handleBackToMain = () => {\r\n    window.location.href = '/evaluation/new'\r\n  }\r\n\r\n  // 環境因用の評価マトリックス (4-6段階評価)\r\n  // HTMLファイルの設計に合わせた3×5マトリックス\r\n  const environmentalMatrix = [\r\n    [1, 1, 2, 4, 7],      // <10%\r\n    [1, 2, 4, 7, 10],     // 10-50%\r\n    [1, 4, 7, 10, 10]     // >50%\r\n  ]\r\n\r\n  const getMatrixValue = (strength: number, duration: number) => {\r\n    return environmentalMatrix[duration]?.[strength] ?? 0\r\n  }\r\n\r\n  const handleMatrixClick = (strength: number, duration: number) => {\r\n    setSelectedMatrix({ strength, duration })\r\n    const score = getMatrixValue(strength, duration)\r\n    setFinalScore(score)\r\n  }\r\n\r\n  const getMatrixCellClass = (value: number, isSelected: boolean) => {\r\n    let baseClass = 'cursor-pointer transition-all duration-200 flex items-center justify-center text-xs font-bold border border-gray-200 dark:border-gray-600 p-2'\r\n    \r\n    if (isSelected) {\r\n      baseClass += ' bg-yellow-200 dark:bg-yellow-800 border-2 border-yellow-500 dark:border-yellow-400 text-yellow-900 dark:text-yellow-100 ring-4 ring-yellow-400 dark:ring-yellow-300 scale-105 shadow-lg'\r\n    } else {\r\n      switch(value) {\r\n        case 1: baseClass += ' bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-200'; break\r\n        case 2: baseClass += ' bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200'; break\r\n        case 4: baseClass += ' bg-orange-100 dark:bg-orange-900 text-orange-800 dark:text-orange-200'; break\r\n        case 7: baseClass += ' bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200'; break\r\n        case 10: baseClass += ' bg-red-200 dark:bg-red-800 text-red-900 dark:text-red-100'; break\r\n        default: baseClass += ' bg-gray-50 dark:bg-gray-700 text-gray-600 dark:text-gray-300'\r\n      }\r\n    }\r\n    \r\n    return baseClass + ' hover:scale-105'\r\n  }\r\n\r\n  return (\r\n    <div className=\"aspect-container\">\r\n      <Header\r\n        variant=\"standard\"\r\n        evaluationNo={evaluationNo}\r\n        creator={creator}\r\n        checker={checker}\r\n        workInfo={workInfo}\r\n      />\r\n\r\n      <section className=\"flex-grow p-3 flex flex-row gap-3 overflow-hidden bg-white\">\r\n        {/* 左列: 写真ギャラリー & ファイルアップロード */}\r\n        <div className=\"w-3/12 flex flex-col h-full space-y-3\">\r\n          <PhotoViewer\r\n            mainPhoto={photoUrl}\r\n            thumbnails={[\r\n              photoUrl,\r\n              'https://placehold.co/120x90/e2e8f0/475569?text=Photo+1',\r\n              'https://placehold.co/120x90/e2e8f0/475569?text=Photo+2',\r\n              'https://placehold.co/120x90/e2e8f0/475569?text=Photo+3'\r\n            ]}\r\n            showGalleryInfo={true}\r\n            galleryTitle=\"環境写真\"\r\n            className=\"flex-grow\"\r\n          />\r\n          <div className=\"grid grid-cols-2 gap-2 flex-shrink-0\">\r\n            <FileUpload\r\n              variant=\"document\"\r\n              layout=\"vertical\"\r\n              size=\"sm\"\r\n              onFileUpload={handleFileUpload}\r\n              label=\"SDS/基準書\"\r\n            />\r\n            <FileUpload\r\n              variant=\"document\"\r\n              layout=\"vertical\"\r\n              size=\"sm\"\r\n              onFileUpload={handleFileUpload}\r\n              label=\"測定結果\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        {/* 中央列: 入力フォーム */}\r\n        <div className=\"w-6/12 flex flex-col h-full border rounded-lg p-2 space-y-3\">\r\n          <h2 className=\"text-sm font-bold flex-shrink-0\">評価対象</h2>\r\n          <div className=\"text-xs space-y-1 overflow-y-auto flex-grow pr-2 max-h-80\">\r\n            <div className=\"grid grid-cols-[auto_1fr_auto_auto_auto_auto_auto] gap-x-2 items-center text-[10px] font-bold text-gray-500 mb-1 sticky top-0 bg-white\">\r\n              <div></div><div>評価項目</div><div>考え方</div><div>基準値</div><div>測定値</div><div>暴露持続</div><div>評価</div>\r\n            </div>\r\n            {items.map((item) => (\r\n              <div key={item.id} className=\"grid grid-cols-[auto_1fr_auto_auto_auto_auto_auto] gap-x-2 items-center p-1 rounded hover:bg-gray-50\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  className=\"h-4 w-4\"\r\n                  checked={item.isChecked}\r\n                  onChange={(e) => handleCheckboxChange(item.id, e.target.checked)}\r\n                />\r\n                <label className=\"text-xs\">{item.label}</label>\r\n                <button className=\"p-1 rounded-full hover:bg-gray-200\">\r\n                  <svg className=\"h-4 w-4 text-gray-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.79 4 4s-1.79 4-4 4-4-1.79-4-4c0-1.105.448-2.09 1.172-2.828M12 14v.01M12 18v-2m-3-5a3 3 0 116 0 3 3 0 01-6 0z\" />\r\n                  </svg>\r\n                </button>\r\n                <Input\r\n                  className=\"w-16 p-1 text-right text-xs\"\r\n                  placeholder={item.standardValue || item.unit || '基準値'}\r\n                  value={item.thinkingValue || ''}\r\n                  onChange={(e) => handleInputChange(item.id, 'thinkingValue', e.target.value)}\r\n                />\r\n                {item.label === '汚れ付着' ? (\r\n                  <select className=\"w-16 p-1 border rounded-md text-xs\">\r\n                    <option>弱</option>\r\n                    <option>強</option>\r\n                  </select>\r\n                ) : (\r\n                  <Input\r\n                    className=\"w-16 p-1 text-right text-xs\"\r\n                    placeholder={item.unit}\r\n                    value={item.measuredValue || ''}\r\n                    onChange={(e) => handleInputChange(item.id, 'measuredValue', e.target.value)}\r\n                    disabled={!item.isChecked}\r\n                    type=\"number\"\r\n                    step=\"0.1\"\r\n                  />\r\n                )}\r\n                <select\r\n                  className=\"w-16 p-1 border rounded-md text-xs\"\r\n                  value={item.exposureDuration || '40%'}\r\n                  onChange={(e) => handleInputChange(item.id, 'exposureDuration', e.target.value)}\r\n                  disabled={!item.isChecked}\r\n                >\r\n                  <option>5%</option>\r\n                  <option>10%</option>\r\n                  <option>20%</option>\r\n                  <option>40%</option>\r\n                  <option>60%</option>\r\n                  <option>80%</option>\r\n                </select>\r\n                <div className=\"w-16 p-1 text-center font-bold text-gray-500\">\r\n                  {item.evaluation || '-'}\r\n                </div>\r\n              </div>\r\n            ))}\r\n            <div className=\"p-1 mt-2 border-t pt-2 text-xs\">\r\n              <div className=\"grid grid-cols-[auto_1fr_auto_auto_auto_auto_auto] gap-x-2 items-center\">\r\n                <input type=\"checkbox\" className=\"h-4 w-4\" />\r\n                <label>エイヤ</label>\r\n                <button className=\"p-1 rounded-full hover:bg-gray-200\">\r\n                  <svg className=\"h-4 w-4 text-gray-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.79 4 4s-1.79 4-4 4-4-1.79-4-4c0-1.105.448-2.09 1.172-2.828M12 14v.01M12 18v-2m-3-5a3 3 0 116 0 3 3 0 01-6 0z\" />\r\n                  </svg>\r\n                </button>\r\n                <div className=\"flex items-center gap-1 col-span-4 justify-self-end\">\r\n                  <select className=\"border rounded-md p-1 text-xs w-24\">\r\n                    <option>選択...</option>\r\n                  </select>\r\n                  <select className=\"border rounded-md p-1 text-xs w-20\">\r\n                    <option>&lt;20%</option>\r\n                    <option>&gt;20%</option>\r\n                  </select>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          {/* 備考欄 */}\r\n          <div className=\"p-2 border-t flex-shrink-0 text-xs space-y-1 bg-gray-50 dark:bg-gray-800 h-32\">\r\n            <h3 className=\"font-bold text-sm mb-1 text-gray-800 dark:text-gray-200\">備考欄</h3>\r\n            <div className=\"space-y-2\">\r\n              <textarea \r\n                className=\"w-full h-16 p-2 text-xs border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-200 resize-none\"\r\n                placeholder=\"環境因子に関する特記事項を記入してください。&#10;&#10;例:&#10;・測定時の気象条件や作業環境&#10;・使用した測定機器や測定方法&#10;・一時的な環境変化の影響&#10;・改善提案や対策\"\r\n              ></textarea>\r\n              \r\n              <div className=\"text-gray-600 dark:text-gray-400 text-[9px]\">\r\n                <p className=\"font-medium mb-1\">記入ポイント: 測定条件、環境変化、対策案などの定性的情報</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* 右列: 評価マトリクス & 結果 */}\r\n        <div className=\"w-3/12 flex flex-col h-full space-y-3\">\r\n          <div className=\"text-xs bg-gray-50 dark:bg-gray-800 p-2 rounded border dark:border-gray-600 flex-grow flex flex-col\">\r\n            <div className=\"grid grid-cols-[auto_repeat(5,1fr)] gap-px flex-grow bg-white dark:bg-gray-900 p-1 text-[10px]\">\r\n              <div className=\"font-bold col-span-6 text-center text-sm mb-1 text-gray-800 dark:text-gray-200\">環境因評価マトリクス</div>\r\n              <div className=\"font-bold self-center border-r pr-1 row-span-2 flex items-center justify-center -rotate-90 whitespace-nowrap text-gray-800 dark:text-gray-200\">②負荷持続</div>\r\n              <div className=\"col-span-5 font-bold text-center border-b border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200\">①強度</div>\r\n              <div className=\"font-bold text-center whitespace-normal text-[9px] text-gray-700 dark:text-gray-300\">どちらとも<br/>言えない</div>\r\n              <div className=\"font-bold text-center whitespace-normal text-[9px] text-gray-700 dark:text-gray-300\">比較的<br/>ある</div>\r\n              <div className=\"font-bold text-center text-[9px] text-gray-700 dark:text-gray-300\">高い</div>\r\n              <div className=\"font-bold text-center whitespace-normal text-[9px] text-gray-700 dark:text-gray-300\">非常に<br/>高い</div>\r\n              <div className=\"font-bold text-center whitespace-normal text-[9px] text-gray-700 dark:text-gray-300\">ほとんど<br/>限界</div>\r\n              \r\n              {/* マトリックス本体 - HTMLファイルの通り3×5 */}\r\n              <div className=\"font-bold self-center border-r pr-1 text-gray-700 dark:text-gray-300\">＜10%</div>\r\n              {[1, 1, 2, 4, 7].map((value, idx) => (\r\n                <div\r\n                  key={`0-${idx}`}\r\n                  className={getMatrixCellClass(value, selectedMatrix.duration === 0 && selectedMatrix.strength === idx)}\r\n                  onClick={() => handleMatrixClick(idx, 0)}\r\n                >\r\n                  {value}\r\n                </div>\r\n              ))}\r\n              \r\n              <div className=\"font-bold self-center border-r pr-1 text-gray-700 dark:text-gray-300\">10-50%</div>\r\n              {[1, 2, 4, 7, 10].map((value, idx) => (\r\n                <div\r\n                  key={`1-${idx}`}\r\n                  className={getMatrixCellClass(value, selectedMatrix.duration === 1 && selectedMatrix.strength === idx)}\r\n                  onClick={() => handleMatrixClick(idx, 1)}\r\n                >\r\n                  {value}\r\n                </div>\r\n              ))}\r\n              \r\n              <div className=\"font-bold self-center border-r pr-1 text-gray-700 dark:text-gray-300\">＞50%</div>\r\n              {[1, 4, 7, 10, 10].map((value, idx) => (\r\n                <div\r\n                  key={`2-${idx}`}\r\n                  className={getMatrixCellClass(value, selectedMatrix.duration === 2 && selectedMatrix.strength === idx)}\r\n                  onClick={() => handleMatrixClick(idx, 2)}\r\n                >\r\n                  {value}\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-2 text-center\">\r\n            <h3 className=\"text-sm font-medium text-blue-800\">環境因 (最終評価)</h3>\r\n            <p className=\"text-3xl font-bold text-blue-700\">{finalScore}</p>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n    </div>\r\n  )\r\n}","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\EvaluationEditModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\EvaluationListView.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used. Allowed unused vars must match /^_/u.","line":6,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'refreshData' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":159,"column":76,"nodeType":null,"messageId":"unusedVar","endLine":159,"endColumn":87},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isSaving' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":164,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":164,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleNavigateToEdit' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":265,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":265,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleBackToTop' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":269,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":269,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport React, { useState } from 'react'\r\nimport Image from 'next/image'\r\nimport { Header } from '@/components/layout'\r\nimport { Card, CardContent, Button } from '@/components/ui'\r\nimport { EvaluationEditModal } from './EvaluationEditModal'\r\nimport { useAuth } from '@/contexts/AuthContext'\r\nimport { useEvaluationData } from '@/hooks/useEvaluationData'\r\n\r\nexport interface WorkItem {\r\n  id: string\r\n  workName: string\r\n  factoryName: string\r\n  processName: string\r\n  photoUrl: string\r\n  kitsusaScore: number\r\n  threekIndex: string\r\n  physicalScore: number\r\n  mentalScore: number\r\n  environmentalScore: number\r\n  hazardScore: number\r\n  timeCategory: string\r\n  status: 'draft' | 'completed' | 'reviewed' | 'archived'\r\n}\r\n\r\nexport interface EvaluationListViewProps {\r\n  workItems?: WorkItem[]\r\n  onItemSelect?: (itemId: string) => void\r\n}\r\n\r\nconst defaultWorkItems: WorkItem[] = [\r\n  {\r\n    id: '1',\r\n    workName: '組立作業A',\r\n    factoryName: '第1工場',\r\n    processName: '組立工程',\r\n    photoUrl: 'https://placehold.co/400x300/e5e7eb/4b5563?text=Work+Photo',\r\n    kitsusaScore: 7,\r\n    threekIndex: 'IV',\r\n    physicalScore: 4,\r\n    mentalScore: 2,\r\n    environmentalScore: 1,\r\n    hazardScore: 0,\r\n    timeCategory: 'd',\r\n    status: 'completed'\r\n  },\r\n  {\r\n    id: '2',\r\n    workName: '検査作業B',\r\n    factoryName: '第2工場', \r\n    processName: '検査工程',\r\n    photoUrl: 'https://placehold.co/400x300/f3f4f6/6b7280?text=Work+Photo+2',\r\n    kitsusaScore: 3,\r\n    threekIndex: 'II',\r\n    physicalScore: 1,\r\n    mentalScore: 3,\r\n    environmentalScore: 1,\r\n    hazardScore: 2,\r\n    timeCategory: 'a',\r\n    status: 'draft'\r\n  },\r\n  {\r\n    id: '3',\r\n    workName: 'メンテナンス作業C',\r\n    factoryName: '第1工場',\r\n    processName: '保守工程',\r\n    photoUrl: 'https://placehold.co/400x300/fef3c7/d97706?text=Work+Photo+3',\r\n    kitsusaScore: 9,\r\n    threekIndex: 'V',\r\n    physicalScore: 5,\r\n    mentalScore: 4,\r\n    environmentalScore: 3,\r\n    hazardScore: 4,\r\n    timeCategory: 'e',\r\n    status: 'reviewed'\r\n  },\r\n  {\r\n    id: '4',\r\n    workName: '清掃作業D',\r\n    factoryName: '第3工場',\r\n    processName: '清掃工程',\r\n    photoUrl: 'https://placehold.co/400x300/dbeafe/3b82f6?text=Work+Photo+4',\r\n    kitsusaScore: 4,\r\n    threekIndex: 'II',\r\n    physicalScore: 2,\r\n    mentalScore: 1,\r\n    environmentalScore: 2,\r\n    hazardScore: 1,\r\n    timeCategory: 'c',\r\n    status: 'completed'\r\n  },\r\n  {\r\n    id: '5',\r\n    workName: '運搬作業E',\r\n    factoryName: '第2工場',\r\n    processName: '運搬工程',\r\n    photoUrl: 'https://placehold.co/400x300/dcfce7/16a34a?text=Work+Photo+5',\r\n    kitsusaScore: 6,\r\n    threekIndex: 'III',\r\n    physicalScore: 4,\r\n    mentalScore: 1,\r\n    environmentalScore: 2,\r\n    hazardScore: 1,\r\n    timeCategory: 'd',\r\n    status: 'draft'\r\n  },\r\n  {\r\n    id: '6',\r\n    workName: '溶接作業F',\r\n    factoryName: '第1工場',\r\n    processName: '溶接工程',\r\n    photoUrl: 'https://placehold.co/400x300/fed7d7/dc2626?text=Work+Photo+6',\r\n    kitsusaScore: 11,\r\n    threekIndex: 'V',\r\n    physicalScore: 4,\r\n    mentalScore: 3,\r\n    environmentalScore: 4,\r\n    hazardScore: 3,\r\n    timeCategory: 'e',\r\n    status: 'reviewed'\r\n  },\r\n  {\r\n    id: '7',\r\n    workName: '包装作業G',\r\n    factoryName: '第3工場',\r\n    processName: '包装工程',\r\n    photoUrl: 'https://placehold.co/400x300/fef3c7/ca8a04?text=Work+Photo+7',\r\n    kitsusaScore: 2,\r\n    threekIndex: 'I',\r\n    physicalScore: 1,\r\n    mentalScore: 1,\r\n    environmentalScore: 1,\r\n    hazardScore: 0,\r\n    timeCategory: 'b',\r\n    status: 'completed'\r\n  },\r\n  {\r\n    id: '8',\r\n    workName: '塗装作業H',\r\n    factoryName: '第2工場',\r\n    processName: '塗装工程',\r\n    photoUrl: 'https://placehold.co/400x300/e0e7ff/6366f1?text=Work+Photo+8',\r\n    kitsusaScore: 8,\r\n    threekIndex: 'IV',\r\n    physicalScore: 3,\r\n    mentalScore: 2,\r\n    environmentalScore: 3,\r\n    hazardScore: 2,\r\n    timeCategory: 'd',\r\n    status: 'draft'\r\n  }\r\n]\r\n\r\nexport function EvaluationListView({\r\n  workItems = defaultWorkItems,\r\n  onItemSelect\r\n}: EvaluationListViewProps): React.JSX.Element {\r\n  const { evaluations, isLoading, error, saveEvaluation, deleteEvaluation, refreshData } = useEvaluationData()\r\n  const items = evaluations.length > 0 ? evaluations : workItems\r\n  const [selectedItem, setSelectedItem] = useState<WorkItem | null>(items[0] || null)\r\n  const [editModalOpen, setEditModalOpen] = useState(false)\r\n  const [editingItem, setEditingItem] = useState<WorkItem | null>(null)\r\n  const [isSaving, setIsSaving] = useState(false)\r\n  const { checkPermission } = useAuth()\r\n\r\n  const handleItemClick = (item: WorkItem) => {\r\n    setSelectedItem(item)\r\n    onItemSelect?.(item.id)\r\n  }\r\n\r\n  const handleEditEvaluation = (itemId: string) => {\r\n    const item = items.find(i => i.id === itemId)\r\n    if (item && (checkPermission('canEdit') || checkPermission('canCheck'))) {\r\n      setEditingItem(item)\r\n      setEditModalOpen(true)\r\n    }\r\n  }\r\n\r\n  const handleSaveEvaluation = async (updatedItem: WorkItem) => {\r\n    setIsSaving(true)\r\n    try {\r\n      await saveEvaluation(updatedItem)\r\n      \r\n      // 選択中のアイテムも更新\r\n      if (selectedItem?.id === updatedItem.id) {\r\n        setSelectedItem(updatedItem)\r\n      }\r\n    } catch (error) {\r\n      console.error('評価の保存に失敗しました:', error)\r\n      alert('評価の保存に失敗しました。もう一度お試しください。')\r\n    } finally {\r\n      setIsSaving(false)\r\n    }\r\n  }\r\n\r\n  const handleDeleteEvaluation = async (itemId: string) => {\r\n    if (!confirm('この評価を削除しますか？この操作は取り消せません。')) {\r\n      return\r\n    }\r\n\r\n    try {\r\n      await deleteEvaluation(itemId)\r\n      \r\n      // 削除されたアイテムが選択中の場合、選択を解除\r\n      if (selectedItem?.id === itemId) {\r\n        setSelectedItem(items.find(item => item.id !== itemId) || null)\r\n      }\r\n    } catch (error) {\r\n      console.error('評価の削除に失敗しました:', error)\r\n      alert('評価の削除に失敗しました。もう一度お試しください。')\r\n    }\r\n  }\r\n\r\n  const getStatusColor = (status: string) => {\r\n    switch (status) {\r\n      case 'completed':\r\n        return 'bg-green-100 text-green-800'\r\n      case 'reviewed':\r\n        return 'bg-blue-100 text-blue-800'\r\n      case 'archived':\r\n        return 'bg-yellow-100 text-yellow-800'\r\n      default:\r\n        return 'bg-gray-100 text-gray-800'\r\n    }\r\n  }\r\n\r\n  const getThreekIndexColor = (index: string) => {\r\n    switch (index) {\r\n      case 'V':\r\n        return 'text-red-600'\r\n      case 'IV':\r\n        return 'text-orange-600'\r\n      case 'III':\r\n        return 'text-yellow-600'\r\n      case 'II':\r\n        return 'text-green-600'\r\n      default:\r\n        return 'text-blue-600'\r\n    }\r\n  }\r\n\r\n  const handleFactorDetail = (factorType: string) => {\r\n    switch (factorType) {\r\n      case 'physical':\r\n        window.location.href = '/evaluation/physical'\r\n        break\r\n      case 'mental':\r\n        window.location.href = '/evaluation/mental'\r\n        break\r\n      case 'environmental':\r\n        window.location.href = '/evaluation/environmental'\r\n        break\r\n      case 'hazard':\r\n        window.location.href = '/evaluation/hazard'\r\n        break\r\n      case 'worktime':\r\n        window.location.href = '/evaluation/worktime'\r\n        break\r\n      default:\r\n        // Unknown factor type\r\n    }\r\n  }\r\n\r\n  const handleNavigateToEdit = (itemId: string) => {\r\n    window.location.href = `/evaluation/edit/${itemId}`\r\n  }\r\n\r\n  const handleBackToTop = () => {\r\n    window.location.href = '/'\r\n  }\r\n\r\n  return (\r\n    <div className=\"aspect-container\">\r\n      <Header\r\n        variant=\"simple\"\r\n        title=\"評価画面\"\r\n        actions={\r\n          <div className=\"flex items-center gap-2\">\r\n            <button className=\"px-3 py-1 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-100\">権限設定</button>\r\n            <button className=\"px-3 py-1 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-100\">閲覧者</button>\r\n            <button className=\"px-3 py-1 text-xs font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-100\">設定登録</button>\r\n          </div>\r\n        }\r\n      />\r\n\r\n      <section className=\"flex-grow p-3 bg-gray-100 overflow-hidden\">\r\n        <div className=\"grid grid-cols-12 gap-3 h-full\">\r\n          \r\n          {/* 左列: 作業リスト */}\r\n          <div className=\"col-span-3 flex flex-col\">\r\n            <Card className=\"flex-grow\">\r\n              <CardContent className=\"p-2\">\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                  <h2 className=\"text-sm font-bold\">作業一覧</h2>\r\n                  {isLoading && (\r\n                    <div className=\"text-xs text-gray-500\">読み込み中...</div>\r\n                  )}\r\n                  {error && (\r\n                    <div className=\"text-xs text-red-500\" title={error}>エラー</div>\r\n                  )}\r\n                </div>\r\n                <div data-testid=\"work-list\" className=\"space-y-1 overflow-y-auto max-h-full\">\r\n                  {items.map((item) => (\r\n                    <div\r\n                      key={item.id}\r\n                      data-testid={item.kitsusaScore >= 7 ? \"high-risk-work-item\" : \"work-item\"}\r\n                      className={`p-1.5 rounded cursor-pointer transition-all text-xs ${\r\n                        selectedItem?.id === item.id\r\n                          ? 'evaluation-item-selected'\r\n                          : 'bg-gray-50 hover:bg-gray-100 border border-gray-200 hover:evaluation-item-hover dark:bg-gray-800 dark:hover:bg-gray-700 dark:border-gray-600'\r\n                      }`}\r\n                      onClick={() => handleItemClick(item)}\r\n                    >\r\n                      <div className=\"flex justify-between items-center mb-0.5\">\r\n                        <h3 className=\"font-bold text-xs truncate max-w-[120px]\">{item.workName}</h3>\r\n                        <div className=\"flex items-center gap-1\">\r\n                          <span className={`text-[10px] px-1 py-0.5 rounded ${getStatusColor(item.status)}`}>\r\n                            {item.status === 'completed' ? '完了' : \r\n                           item.status === 'draft' ? '下書' : \r\n                           item.status === 'reviewed' ? '査定' : \r\n                           item.status === 'archived' ? 'アーカイブ' : item.status}\r\n                          </span>\r\n                          <span className={`text-xs font-bold ${getThreekIndexColor(item.threekIndex)}`}>\r\n                            {item.threekIndex}\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n                      <p className=\"text-[10px] text-gray-600 truncate\">{item.factoryName} - {item.processName}</p>\r\n                      <div className=\"flex justify-between items-center mt-0.5\">\r\n                        <span className=\"text-[10px] text-gray-500\">キツさ: {item.kitsusaScore}</span>\r\n                        <div className=\"flex gap-1\">\r\n                          {(checkPermission('canEdit') || checkPermission('canCheck')) && (\r\n                            <button \r\n                              onClick={(e) => {\r\n                                e.stopPropagation()\r\n                                handleEditEvaluation(item.id)\r\n                              }}\r\n                              className=\"px-1 py-0.5 text-[8px] text-blue-600 hover:text-blue-800 bg-transparent hover:bg-blue-50 rounded border border-blue-200 hover:border-blue-300 transition-colors\"\r\n                            >\r\n                              編集\r\n                            </button>\r\n                          )}\r\n                          {checkPermission('canAdmin') && evaluations.length > 0 && (\r\n                            <button\r\n                              onClick={(e) => {\r\n                                e.stopPropagation()\r\n                                void handleDeleteEvaluation(item.id)\r\n                              }}\r\n                              className=\"px-1 py-0.5 text-[8px] text-red-600 hover:text-red-800 bg-transparent hover:bg-red-50 rounded border border-red-200 hover:border-red-300 transition-colors\"\r\n                            >\r\n                              削除\r\n                            </button>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          {/* 中央列: 写真 & 詳細 */}\r\n          <div className=\"col-span-3 flex flex-col gap-3\">\r\n            <Card className=\"h-1/2\">\r\n              <CardContent className=\"p-2 flex flex-col items-center justify-center h-full\">\r\n                <h2 className=\"text-sm font-bold mb-2 w-full\">写真</h2>\r\n                <Image\r\n                  src={selectedItem?.photoUrl || 'https://placehold.co/400x300/e5e7eb/4b5563?text=No+Photo'}\r\n                  width={400}\r\n                  height={300}\r\n                  className=\"evaluation-photo rounded\"\r\n                  alt=\"関連写真\"\r\n                  placeholder=\"blur\"\r\n                  blurDataURL=\"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAIAAoDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAv/xAAhEAACAQMDBQAAAAAAAAAAAAABAgMABAUGIWGRkqGx0f/EABUBAQEAAAAAAAAAAAAAAAAAAAMF/8QAGhEAAgIDAAAAAAAAAAAAAAAAAAECEgMRkf/aAAwDAQACEQMRAD8AltJagyeH0AthI5xdrLcNM91BF5pX2HaH9bcfaSXWGaRmknyJckliyjqTzSlT54b6bk+h0R//2Q==\"\r\n                />\r\n              </CardContent>\r\n            </Card>\r\n            \r\n            <Card className=\"h-1/2\">\r\n              <CardContent className=\"p-2 flex flex-col h-full\">\r\n                <h2 className=\"text-sm font-bold mb-2\">選択作業の詳細内訳</h2>\r\n                {selectedItem && (\r\n                  <div className=\"text-xs space-y-2 overflow-y-auto\">\r\n                    <div className=\"space-y-1\">\r\n                      <div className=\"flex items-center justify-between p-1 border border-gray-200 rounded\">\r\n                        <div>\r\n                          <span className=\"font-medium\">肉体因:</span>\r\n                          <span className=\"ml-1 text-green-600\">{selectedItem.physicalScore}</span>\r\n                        </div>\r\n                        <button \r\n                          onClick={() => handleFactorDetail('physical')}\r\n                          className=\"px-2 py-0.5 text-[10px] text-blue-600 hover:text-blue-800 bg-transparent hover:bg-blue-50 rounded border border-blue-200 hover:border-blue-300 transition-colors\"\r\n                        >\r\n                          詳細入力\r\n                        </button>\r\n                      </div>\r\n                      <div className=\"flex items-center justify-between p-1 border border-gray-200 rounded\">\r\n                        <div>\r\n                          <span className=\"font-medium\">精神因:</span>\r\n                          <span className=\"ml-1 text-green-600\">{selectedItem.mentalScore}</span>\r\n                        </div>\r\n                        <button \r\n                          onClick={() => handleFactorDetail('mental')}\r\n                          className=\"px-2 py-0.5 text-[10px] text-blue-600 hover:text-blue-800 bg-transparent hover:bg-blue-50 rounded border border-blue-200 hover:border-blue-300 transition-colors\"\r\n                        >\r\n                          詳細入力\r\n                        </button>\r\n                      </div>\r\n                      <div className=\"flex items-center justify-between p-1 border border-gray-200 rounded\">\r\n                        <div>\r\n                          <span className=\"font-medium\">環境因:</span>\r\n                          <span className=\"ml-1 text-yellow-600\">{selectedItem.environmentalScore}</span>\r\n                        </div>\r\n                        <button \r\n                          onClick={() => handleFactorDetail('environmental')}\r\n                          className=\"px-2 py-0.5 text-[10px] text-blue-600 hover:text-blue-800 bg-transparent hover:bg-blue-50 rounded border border-blue-200 hover:border-blue-300 transition-colors\"\r\n                        >\r\n                          詳細入力\r\n                        </button>\r\n                      </div>\r\n                      <div className=\"flex items-center justify-between p-1 border border-gray-200 rounded\">\r\n                        <div>\r\n                          <span className=\"font-medium\">危険因:</span>\r\n                          <span className=\"ml-1 text-gray-500\">{selectedItem.hazardScore}</span>\r\n                        </div>\r\n                        <button \r\n                          onClick={() => handleFactorDetail('hazard')}\r\n                          className=\"px-2 py-0.5 text-[10px] text-blue-600 hover:text-blue-800 bg-transparent hover:bg-blue-50 rounded border border-blue-200 hover:border-blue-300 transition-colors\"\r\n                        >\r\n                          詳細入力\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"pt-2 border-t\">\r\n                      <div className=\"flex items-center justify-between p-1 border border-gray-200 rounded\">\r\n                        <div>\r\n                          <span className=\"font-medium\">作業時間カテゴリ:</span>\r\n                          <span className=\"ml-1 text-blue-600\">{selectedItem.timeCategory}</span>\r\n                        </div>\r\n                        <button \r\n                          onClick={() => handleFactorDetail('worktime')}\r\n                          className=\"px-2 py-0.5 text-[10px] text-blue-600 hover:text-blue-800 bg-transparent hover:bg-blue-50 rounded border border-blue-200 hover:border-blue-300 transition-colors\"\r\n                        >\r\n                          詳細入力\r\n                        </button>\r\n                      </div>\r\n                      <div className=\"flex justify-between mt-1\">\r\n                        <span className=\"font-medium\">総合評価:</span>\r\n                        <span className={`font-bold ${getThreekIndexColor(selectedItem.threekIndex)}`}>\r\n                          {selectedItem.threekIndex} ({selectedItem.kitsusaScore})\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n\r\n          {/* 右列: グラフエリア */}\r\n          <div className=\"col-span-6 flex flex-col gap-3\">\r\n            <Card className=\"h-1/2\">\r\n              <CardContent className=\"p-2 flex flex-col h-full\">\r\n                <h2 className=\"text-sm font-bold mb-2\">作業のキツさ累積</h2>\r\n                <div className=\"flex-grow bg-gray-50 rounded flex items-center justify-center\">\r\n                  <p className=\"text-gray-500 text-sm\">グラフ表示エリア (Chart.js)</p>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n            \r\n            <Card className=\"h-1/2\">\r\n              <CardContent className=\"p-2 flex flex-col h-full\">\r\n                <h2 className=\"text-sm font-bold mb-2\">3K指数マップ (散布図)</h2>\r\n                <div className=\"flex-grow bg-gray-50 rounded flex items-center justify-center\">\r\n                  <p className=\"text-gray-500 text-sm\">散布図表示エリア (Chart.js)</p>\r\n                </div>\r\n              </CardContent>\r\n            </Card>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n      {editingItem && (\r\n        <EvaluationEditModal\r\n          workItem={editingItem}\r\n          isOpen={editModalOpen}\r\n          onClose={() => {\r\n            setEditModalOpen(false)\r\n            setEditingItem(null)\r\n          }}\r\n          onSave={(data) => { void handleSaveEvaluation(data) }}\r\n        />\r\n      )}\r\n\r\n    </div>\r\n  )\r\n}","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\EvaluationMain.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used. Allowed unused vars must match /^_/u.","line":7,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'isSaving' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":55,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":55,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'saveMessage' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":56,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":56,"endColumn":21},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'updateEvaluationForm'. Either include it or remove the dependency array.","line":73,"column":6,"nodeType":"ArrayExpression","endLine":73,"endColumn":78,"suggestions":[{"desc":"Update the dependencies array to be: [workInfo.workName, workInfo.factoryName, workInfo.processName, remarks, updateEvaluationForm]","fix":{"range":[1882,1954],"text":"[workInfo.workName, workInfo.factoryName, workInfo.processName, remarks, updateEvaluationForm]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'files' is defined but never used. Allowed unused args must match /^_/u.","line":75,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":75,"endColumn":34},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleSave' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":85,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":85,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'statusBadges' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":137,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":137,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport React, { useState, useEffect } from 'react'\r\nimport { useRouter } from 'next/navigation'\r\nimport { Header } from '@/components/layout'\r\nimport { PhotoViewer, FactorList, SummaryPanel, type FactorItem } from '@/components/evaluation'\r\nimport { Button } from '@/components/ui'\r\nimport { DocumentViewer } from '@/components/ui/DocumentViewer'\r\nimport { useDatabase } from '@/hooks/useDatabase'\r\nimport { useEvaluationStore } from '@/hooks/useEvaluationStore'\r\n\r\nexport interface EvaluationMainProps {\r\n  evaluationNo?: string\r\n  creator?: {\r\n    department: string\r\n    name: string\r\n    date: string\r\n  }\r\n  checker?: {\r\n    department: string\r\n    name: string\r\n    date: string\r\n  }\r\n  workInfo?: {\r\n    workName: string\r\n    factoryName: string\r\n    processName: string\r\n  }\r\n  photos?: string[]\r\n  factors?: FactorItem[]\r\n}\r\n\r\nexport function EvaluationMain({\r\n  evaluationNo,\r\n  creator = {\r\n    department: '生産技術企画部',\r\n    name: '山田 太郎',\r\n    date: '2024/08/20'\r\n  },\r\n  checker = {\r\n    department: '生産企画部',\r\n    name: '鈴木 一郎',\r\n    date: '2024/08/21'\r\n  },\r\n  workInfo = {\r\n    workName: 'サンプル作業',\r\n    factoryName: '〇〇工場',\r\n    processName: '△△工程'\r\n  },\r\n  photos,\r\n  factors\r\n}: EvaluationMainProps): React.JSX.Element {\r\n  const [remarks, setRemarks] = useState('')\r\n  const [, setSelectedPhoto] = useState(0)\r\n  const [isSaving, setIsSaving] = useState(false)\r\n  const [saveMessage, setSaveMessage] = useState('')\r\n\r\n  const router = useRouter()\r\n  const database = useDatabase()\r\n  const evaluationStore = useEvaluationStore()\r\n\r\n  // Zustandストアからデータを取得\r\n  const { evaluationForm, updateEvaluationForm } = evaluationStore\r\n\r\n  // workInfoをZustandに同期\r\n  useEffect(() => {\r\n    updateEvaluationForm({\r\n      workName: workInfo.workName,\r\n      factoryName: workInfo.factoryName,\r\n      processName: workInfo.processName,\r\n      remarks\r\n    })\r\n  }, [workInfo.workName, workInfo.factoryName, workInfo.processName, remarks]) // updateEvaluationFormを依存配列から削除\r\n\r\n  const handleFileUpload = (files: File[]) => {\r\n    // ファイルアップロード処理\r\n    // TODO: Process uploaded files\r\n  }\r\n\r\n  const handleAttachmentCheck = () => {\r\n    // 添付ファイル確認処理\r\n    // TODO: Implement attachments validation\r\n  }\r\n\r\n  const handleSave = async () => {\r\n    setIsSaving(true)\r\n    setSaveMessage('')\r\n\r\n    try {\r\n      const evaluationId = await database.saveEvaluation(evaluationForm)\r\n\r\n      if (evaluationId) {\r\n        setSaveMessage('保存が完了しました')\r\n\r\n        // 保存成功時、ダッシュボードに遷移\r\n        setTimeout(() => {\r\n          router.push('/dashboard')\r\n        }, 1500)\r\n      } else {\r\n        setSaveMessage('保存に失敗しました')\r\n      }\r\n    } catch (error) {\r\n      console.error('保存エラー:', error)\r\n      setSaveMessage('保存中にエラーが発生しました')\r\n    } finally {\r\n      setIsSaving(false)\r\n\r\n      // メッセージを3秒後にクリア\r\n      setTimeout(() => {\r\n        setSaveMessage('')\r\n      }, 3000)\r\n    }\r\n  }\r\n\r\n  const handleFactorDetail = (factorType: string) => {\r\n    switch (factorType) {\r\n      case 'physical':\r\n        window.location.href = '/evaluation/physical'\r\n        break\r\n      case 'mental':\r\n        window.location.href = '/evaluation/mental'\r\n        break\r\n      case 'environmental':\r\n        window.location.href = '/evaluation/environmental'\r\n        break\r\n      case 'hazard':\r\n        window.location.href = '/evaluation/hazard'\r\n        break\r\n      case 'worktime':\r\n        window.location.href = '/evaluation/worktime'\r\n        break\r\n      default:\r\n        // Unknown factor type\r\n    }\r\n  }\r\n\r\n  const statusBadges = [\r\n    { label: '未記入あり', color: 'gray' as const },\r\n    { label: 'エイヤ記入部', color: 'lime' as const },\r\n    { label: '記入完了', color: 'green' as const },\r\n    { label: '確認完了', color: 'blue' as const }\r\n  ]\r\n\r\n  // 因子データにonDetailClickハンドラーを追加\r\n  const factorsWithHandlers = [\r\n    { id: 'physical', name: '肉体因', score: 4, colorScheme: 'green' as const, onDetailClick: () => handleFactorDetail('physical') },\r\n    { id: 'mental', name: '精神因', score: 2, colorScheme: 'green' as const, onDetailClick: () => handleFactorDetail('mental') },\r\n    { id: 'environmental', name: '環境因', score: 1, colorScheme: 'lime' as const, onDetailClick: () => handleFactorDetail('environmental') },\r\n    { id: 'hazard', name: '危険因', score: '-', colorScheme: 'gray' as const, onDetailClick: () => handleFactorDetail('hazard') },\r\n    { id: 'worktime', name: '作業時間', score: 'd', colorScheme: 'blue' as const, onDetailClick: () => handleFactorDetail('worktime') }\r\n  ]\r\n\r\n  return (\r\n    <div className=\"aspect-container\">\r\n      <Header\r\n        variant=\"standard\"\r\n        evaluationNo={evaluationNo}\r\n        creator={creator}\r\n        checker={checker}\r\n        workInfo={workInfo}\r\n      />\r\n\r\n      <section className=\"flex-grow p-3 flex flex-col gap-3 overflow-hidden bg-white dark:bg-gray-900\">\r\n        {/* 上段：写真と因子リスト */}\r\n        <div className=\"flex flex-col sm:flex-row gap-3 flex-1 min-h-0\">\r\n          <PhotoViewer\r\n            thumbnails={photos}\r\n            onPhotoSelect={setSelectedPhoto}\r\n          />\r\n          \r\n          <FactorList \r\n            factors={factors || factorsWithHandlers}\r\n          />\r\n        </div>\r\n        \r\n        {/* 下段：資料閲覧とサマリー */}\r\n        <div className=\"flex flex-col lg:flex-row gap-3 flex-1 min-h-0\">\r\n          <DocumentViewer\r\n            documents={[\r\n              {\r\n                id: '1',\r\n                name: '作業手順書.pdf',\r\n                type: 'application/pdf',\r\n                url: '/sample-document.pdf',\r\n                size: 1024000\r\n              },\r\n              {\r\n                id: '2',\r\n                name: '安全マニュアル.pdf',\r\n                type: 'application/pdf',\r\n                url: '/safety-manual.pdf',\r\n                size: 2048000\r\n              }\r\n            ]}\r\n            onFileUpload={handleFileUpload}\r\n            className=\"flex-1\"\r\n          />\r\n          \r\n          <SummaryPanel\r\n            remarks={remarks}\r\n            onRemarksChange={setRemarks}\r\n            onFileUpload={handleFileUpload}\r\n            onAttachmentCheck={handleAttachmentCheck}\r\n          />\r\n        </div>\r\n      </section>\r\n\r\n      \r\n      <style jsx global>{`\r\n        .aspect-container {\r\n          width: 100%;\r\n          max-width: 1440px;\r\n          margin: auto;\r\n          aspect-ratio: 16 / 9;\r\n          display: flex;\r\n          flex-direction: column;\r\n          background-color: white;\r\n          border-radius: 0.75rem;\r\n          box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);\r\n          overflow: hidden;\r\n        }\r\n        \r\n        .scrollbar-thin::-webkit-scrollbar {\r\n          height: 6px;\r\n        }\r\n        \r\n        .scrollbar-thin::-webkit-scrollbar-track {\r\n          background: rgb(243 244 246);\r\n        }\r\n        \r\n        .scrollbar-thin::-webkit-scrollbar-thumb {\r\n          background: rgb(156 163 175);\r\n          border-radius: 3px;\r\n        }\r\n        \r\n        .scrollbar-thin::-webkit-scrollbar-thumb:hover {\r\n          background: rgb(107 114 128);\r\n        }\r\n      `}</style>\r\n    </div>\r\n  )\r\n}","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\FactorList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\GenericFactorDetail.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Button' is defined but never used. Allowed unused vars must match /^_/u.","line":7,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'factorType' is defined but never used. Allowed unused args must match /^_/u.","line":40,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":40,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'selectedPosture' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":54,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":54,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleChemicalEvaluation' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":56,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":56,"endColumn":33},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleBackToMain' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":60,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":60,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleBackToDashboard' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":64,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":64,"endColumn":30},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":115,"column":13,"nodeType":"JSXOpeningElement","endLine":115,"endColumn":83},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'row' is defined but never used. Allowed unused args must match /^_/u.","line":141,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":141,"endColumn":34},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'col' is defined but never used. Allowed unused args must match /^_/u.","line":141,"column":36,"nodeType":null,"messageId":"unusedVar","endLine":141,"endColumn":39},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'value' is defined but never used. Allowed unused args must match /^_/u.","line":141,"column":41,"nodeType":null,"messageId":"unusedVar","endLine":141,"endColumn":46}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":10,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport React, { type ReactNode, useState } from 'react'\r\nimport { Header } from '@/components/layout'\r\nimport { TabInterface, type Tab } from '@/components/ui/TabInterface'\r\nimport { PostureList, MatrixDisplay, type Posture } from '@/components/evaluation'\r\nimport { Button } from '@/components/ui'\r\n\r\nexport interface GenericFactorDetailProps {\r\n  title: string\r\n  factorType?: string\r\n  evaluationNo?: string\r\n  creator?: {\r\n    department: string\r\n    name: string\r\n    date: string\r\n  }\r\n  checker?: {\r\n    department: string\r\n    name: string\r\n    date: string\r\n  }\r\n  workInfo?: {\r\n    workName: string\r\n    factoryName: string\r\n    processName: string\r\n  }\r\n  photoUrl?: string\r\n  postures?: Posture[]\r\n  tabs?: Tab[]\r\n  matrixTitle?: string\r\n  resultScore?: number\r\n  resultUnit?: string\r\n  resultColor?: string\r\n  rightPanelContent?: ReactNode\r\n}\r\n\r\nexport function GenericFactorDetail({\r\n  title,\r\n  factorType,\r\n  evaluationNo,\r\n  creator,\r\n  checker,\r\n  workInfo,\r\n  photoUrl = 'https://placehold.co/400x300/e5e7eb/4b5563?text=Photo',\r\n  postures,\r\n  tabs = [],\r\n  matrixTitle = '評価マトリクス',\r\n  resultScore = 0,\r\n  resultUnit = 'スコア',\r\n  resultColor = 'text-blue-600',\r\n  rightPanelContent\r\n}: GenericFactorDetailProps): React.JSX.Element {\r\n  const [selectedPosture, setSelectedPosture] = useState<string>('')\r\n\r\n  const handleChemicalEvaluation = () => {\r\n    window.location.href = '/evaluation/environmental/chemical'\r\n  }\r\n\r\n  const handleBackToMain = () => {\r\n    window.location.href = '/evaluation/new'\r\n  }\r\n\r\n  const handleBackToDashboard = () => {\r\n    window.location.href = '/dashboard'\r\n  }\r\n\r\n  const defaultTabs: Tab[] = [\r\n    {\r\n      id: 'tab1',\r\n      label: '① 基本評価',\r\n      content: (\r\n        <div className=\"space-y-2 text-sm\">\r\n          <p className=\"text-gray-600\">{title}の評価項目</p>\r\n          <div className=\"space-y-2\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <label className=\"text-xs\">評価項目1:</label>\r\n              <select className=\"border rounded-md p-1 text-xs\">\r\n                <option>低い</option>\r\n                <option>普通</option>\r\n                <option>高い</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )\r\n    },\r\n    {\r\n      id: 'tab2',\r\n      label: '② 詳細設定',\r\n      content: (\r\n        <div className=\"space-y-2 text-sm\">\r\n          <p className=\"text-gray-600\">詳細な評価設定</p>\r\n        </div>\r\n      )\r\n    }\r\n  ]\r\n\r\n  const tabsToUse = tabs.length > 0 ? tabs : defaultTabs\r\n\r\n  return (\r\n    <div className=\"aspect-container\">\r\n      <Header\r\n        variant=\"standard\"\r\n        evaluationNo={evaluationNo}\r\n        creator={creator}\r\n        checker={checker}\r\n        workInfo={workInfo}\r\n      />\r\n\r\n      <section className=\"flex-grow p-3 flex flex-row gap-3 overflow-hidden bg-white\">\r\n        {/* 左列: 写真 & 姿勢リスト */}\r\n        <div className=\"w-1/3 flex flex-col h-full space-y-3\">\r\n          <div className=\"flex-shrink-0 bg-gray-100 rounded-lg flex items-center justify-center p-2 h-40\">\r\n            <img src={photoUrl} className=\"evaluation-photo rounded\" alt=\"関連写真\" />\r\n          </div>\r\n          <PostureList\r\n            postures={postures}\r\n            onPostureSelect={setSelectedPosture}\r\n            onAddPosture={() => {/* TODO: Add new posture */}}\r\n          />\r\n        </div>\r\n\r\n        {/* 中央列: 入力フォーム (タブ形式) */}\r\n        <div className=\"w-1/3 flex flex-col h-full\">\r\n          <TabInterface tabs={tabsToUse} defaultTab={tabsToUse[0]?.id} />\r\n          \r\n          {/* 基準表示エリア */}\r\n          <div className=\"p-2 border-t flex-shrink-0 text-xs space-y-1 bg-gray-50 h-1/3 overflow-y-auto\">\r\n            <h3 className=\"font-bold text-sm mb-1\">基準表示エリア</h3>\r\n            <p className=\"text-gray-600\">{title}の評価基準が表示されます。</p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* 右列: 評価マトリクス, 結果 & 備考 */}\r\n        <div className=\"w-1/3 flex flex-col h-full space-y-3\">\r\n          {rightPanelContent || (\r\n            <>\r\n              <MatrixDisplay\r\n                title={matrixTitle}\r\n                onCellClick={(row, col, value) => {/* Handle cell selection */}}\r\n              />\r\n              \r\n              {/* 結果表示エリア */}\r\n              <div className=\"flex-shrink-0 bg-white border rounded-lg p-3\">\r\n                <div className=\"text-center\">\r\n                  <h3 className=\"text-sm font-bold text-gray-700\">計算結果</h3>\r\n                  <div className=\"mt-2\">\r\n                    <span className={`text-2xl font-bold ${resultColor}`}>{resultScore}</span>\r\n                    <p className=\"text-xs text-gray-500 mt-1\">{title}{resultUnit}</p>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </>\r\n          )}\r\n        </div>\r\n      </section>\r\n\r\n    </div>\r\n  )\r\n}","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\HazardFactorDetail.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'hazardStandards' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":42,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":42,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'evaluationNo' is defined but never used. Allowed unused args must match /^_/u.","line":107,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":107,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'creator' is defined but never used. Allowed unused args must match /^_/u.","line":108,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":108,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'checker' is defined but never used. Allowed unused args must match /^_/u.","line":109,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":109,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'workInfo' is defined but never used. Allowed unused args must match /^_/u.","line":110,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":110,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'files' is defined but never used. Allowed unused args must match /^_/u.","line":184,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":184,"endColumn":34},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'handleBackToMain' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":188,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":188,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport React, { useState } from 'react'\r\nimport { FileUpload, Button } from '@/components/ui'\r\nimport { PhotoViewer } from '@/components/evaluation'\r\nimport { EVALUATION_STANDARDS, DEFAULT_EVALUATION_DATA } from '@/data/defaultEvaluationData'\r\n\r\nexport interface HazardEvent {\r\n  id: string\r\n  eventDescription: string\r\n  encounterFrequency: number // Px\r\n  possibility: number // Py\r\n  occurrenceProbability: string // P\r\n  severityLevel: string // S\r\n  riskPoint: number\r\n  riskLevel: string\r\n}\r\n\r\nexport interface HazardFactorDetailProps {\r\n  evaluationNo?: string\r\n  creator?: {\r\n    department: string\r\n    name: string\r\n    date: string\r\n  }\r\n  checker?: {\r\n    department: string\r\n    name: string\r\n    date: string\r\n  }\r\n  workInfo?: {\r\n    workName: string\r\n    factoryName: string\r\n    processName: string\r\n  }\r\n  photoUrl?: string\r\n  hazardEvents?: HazardEvent[]\r\n}\r\n\r\n// デフォルトデータから危険因子項目を生成\r\nconst generateHazardEvents = (): HazardEvent[] => {\r\n  const hazardStandards = EVALUATION_STANDARDS.hazard\r\n  const defaultData = DEFAULT_EVALUATION_DATA.hazardDefaults\r\n\r\n  // データが存在しない場合はデフォルトの危険因子イベントを返す\r\n  if (!defaultData || !defaultData.hazardEvents) {\r\n    return [\r\n      {\r\n        id: '1',\r\n        eventDescription: '機械への挟まれ・巻き込まれ',\r\n        encounterFrequency: 2,\r\n        possibility: 2,\r\n        occurrenceProbability: 'P2',\r\n        severityLevel: 'S4',\r\n        riskPoint: 8,\r\n        riskLevel: 'B'\r\n      },\r\n      {\r\n        id: '2', \r\n        eventDescription: '重量物の落下・飛散',\r\n        encounterFrequency: 1,\r\n        possibility: 2,\r\n        occurrenceProbability: 'P1',\r\n        severityLevel: 'S3',\r\n        riskPoint: 3,\r\n        riskLevel: 'C'\r\n      }\r\n    ]\r\n  }\r\n  \r\n  return defaultData.hazardEvents.map((event, index) => ({\r\n    id: event.id || `${index + 1}`,\r\n    eventDescription: event.hazardEvent,\r\n    encounterFrequency: event.encounterFrequency || 2,\r\n    possibility: event.dangerPossibility || 2,\r\n    occurrenceProbability: `P${event.encounterFrequency}`,\r\n    severityLevel: `S${event.dangerPossibility}`,\r\n    riskPoint: typeof event.riskLevel === 'number' ? event.riskLevel : 8,\r\n    riskLevel: (typeof event.riskLevel === 'number' && event.riskLevel >= 10) ? 'A' : (typeof event.riskLevel === 'number' && event.riskLevel >= 6) ? 'B' : 'C'\r\n  }))\r\n}\r\n\r\nconst defaultHazardEvents: HazardEvent[] = generateHazardEvents() || [\r\n  {\r\n    id: '1',\r\n    eventDescription: '重量物による挟まれ',\r\n    encounterFrequency: 2,\r\n    possibility: 2,\r\n    occurrenceProbability: 'P2',\r\n    severityLevel: 'S4',\r\n    riskPoint: 8,\r\n    riskLevel: 'B'\r\n  },\r\n  {\r\n    id: '2',\r\n    eventDescription: '回転部への巻き込まれ',\r\n    encounterFrequency: 2,\r\n    possibility: 1,\r\n    occurrenceProbability: 'P2',\r\n    severityLevel: 'S5',\r\n    riskPoint: 10,\r\n    riskLevel: 'A'\r\n  }\r\n]\r\n\r\nexport function HazardFactorDetail({\r\n  evaluationNo,\r\n  creator,\r\n  checker,\r\n  workInfo,\r\n  photoUrl = 'https://placehold.co/600x450/e5e7eb/4b5563?text=Photo',\r\n  hazardEvents = defaultHazardEvents\r\n}: HazardFactorDetailProps): React.JSX.Element {\r\n  const [events, setEvents] = useState(hazardEvents)\r\n  const [highlightedCell, setHighlightedCell] = useState<{ p: string, s: string } | null>(null)\r\n\r\n  const calculateOccurrenceProbability = (px: number, py: number): string => {\r\n    const sum = px + py\r\n    if (sum <= 2) return 'P1'\r\n    if (sum <= 4) return 'P2'\r\n    if (sum <= 5) return 'P3'\r\n    if (sum <= 6) return 'P4'\r\n    return 'P5'\r\n  }\r\n\r\n  const calculateRiskPoint = (p: string, s: string): number => {\r\n    // 元の基準に従ったリスクマトリックス\r\n    const riskMatrix: { [key: string]: { [key: string]: number } } = {\r\n      'P1': { 'S1': 1, 'S2': 2, 'S3': 3, 'S4': 4, 'S5': 5 },\r\n      'P2': { 'S1': 2, 'S2': 4, 'S3': 6, 'S4': 8, 'S5': 10 },\r\n      'P3': { 'S1': 3, 'S2': 6, 'S3': 9, 'S4': 12, 'S5': 15 },\r\n      'P4': { 'S1': 4, 'S2': 8, 'S3': 12, 'S4': 16, 'S5': 20 },\r\n      'P5': { 'S1': 5, 'S2': 10, 'S3': 15, 'S4': 20, 'S5': 25 }\r\n    }\r\n    return riskMatrix[p]?.[s] || 0\r\n  }\r\n\r\n  const calculateRiskLevel = (point: number): string => {\r\n    if (point >= 10) return 'A' // 許容不可\r\n    if (point >= 5) return 'B'  // 条件付き許容\r\n    return 'C' // 許容可能\r\n  }\r\n\r\n  const handleEventChange = (id: string, field: string, value: string | number) => {\r\n    setEvents(prev => prev.map(event => {\r\n      if (event.id === id) {\r\n        const updated = { ...event, [field]: value }\r\n        \r\n        if (field === 'encounterFrequency' || field === 'possibility') {\r\n          const px = field === 'encounterFrequency' ? Number(value) : event.encounterFrequency\r\n          const py = field === 'possibility' ? Number(value) : event.possibility\r\n          updated.occurrenceProbability = calculateOccurrenceProbability(px, py)\r\n          updated.riskPoint = calculateRiskPoint(updated.occurrenceProbability, updated.severityLevel)\r\n          updated.riskLevel = calculateRiskLevel(updated.riskPoint)\r\n        } else if (field === 'severityLevel') {\r\n          updated.riskPoint = calculateRiskPoint(updated.occurrenceProbability, String(value))\r\n          updated.riskLevel = calculateRiskLevel(updated.riskPoint)\r\n        }\r\n        \r\n        return updated\r\n      }\r\n      return event\r\n    }))\r\n  }\r\n\r\n  const addNewEvent = () => {\r\n    const newEvent: HazardEvent = {\r\n      id: String(Date.now()), // より安全なID生成\r\n      eventDescription: '',\r\n      encounterFrequency: 1,\r\n      possibility: 1,\r\n      occurrenceProbability: 'P1',\r\n      severityLevel: 'S1',\r\n      riskPoint: 0,\r\n      riskLevel: 'C'\r\n    }\r\n    setEvents([...events, newEvent])\r\n  }\r\n\r\n  const removeEvent = (id: string) => {\r\n    setEvents(prev => prev.filter(event => event.id !== id))\r\n  }\r\n\r\n  const handleFileUpload = (files: FileList) => {\r\n    // TODO: Process uploaded files\r\n  }\r\n\r\n  const handleBackToMain = () => {\r\n    window.location.href = '/evaluation/new'\r\n  }\r\n\r\n  const getMaxRiskEvent = () => {\r\n    if (events.length === 0) return null\r\n    return events.reduce((max, event) => {\r\n      if (!max) return event\r\n      return event.riskPoint > max.riskPoint ? event : max\r\n    }, events[0])\r\n  }\r\n\r\n  const maxRiskEvent = getMaxRiskEvent()\r\n\r\n  // リスクポイントを1,2,4,7,10の評価点に変換\r\n  const convertRiskPointToEvaluation = (riskPoint: number): number => {\r\n    if (riskPoint >= 20) return 10;\r\n    if (riskPoint >= 15) return 7;\r\n    if (riskPoint >= 10) return 4;\r\n    if (riskPoint >= 5) return 2;\r\n    return 1;\r\n  }\r\n\r\n  // 点数変換マトリックスのセルの色を取得\r\n  const getConversionMatrixCellClass = (riskPoint: number, evaluation: number, isSelected: boolean) => {\r\n    let baseClass = 'flex items-center justify-center text-[10px] font-bold p-1 border border-gray-200 dark:border-gray-600'\r\n    \r\n    if (isSelected) {\r\n      baseClass += ' bg-yellow-200 dark:bg-yellow-300 border-2 border-yellow-400 text-yellow-900 dark:text-yellow-800'\r\n    } else {\r\n      switch(evaluation) {\r\n        case 10: baseClass += ' bg-red-400 dark:bg-red-500 text-white'; break\r\n        case 7: baseClass += ' bg-red-200 dark:bg-red-300 text-red-900 dark:text-red-800'; break\r\n        case 4: baseClass += ' bg-orange-200 dark:bg-orange-300 text-orange-900 dark:text-orange-800'; break\r\n        case 2: baseClass += ' bg-yellow-200 dark:bg-yellow-300 text-yellow-900 dark:text-yellow-800'; break\r\n        case 1: baseClass += ' bg-green-200 dark:bg-green-300 text-green-900 dark:text-green-800'; break\r\n        default: baseClass += ' bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300'\r\n      }\r\n    }\r\n    \r\n    return baseClass\r\n  }\r\n\r\n  // リスクマトリックスのセルの色を評価点に基づいて設定（ダークモード対応）\r\n  const getRiskMatrixCellClass = (p: string, s: string, value: number) => {\r\n    const isHighlighted = highlightedCell?.p === p && highlightedCell?.s === s\r\n    const isMaxRisk = maxRiskEvent && \r\n                      maxRiskEvent.occurrenceProbability === p && \r\n                      maxRiskEvent.severityLevel === s\r\n    \r\n    const evaluationScore = convertRiskPointToEvaluation(value)\r\n    let baseClass = 'flex items-center justify-center text-[10px] font-bold p-1 border border-gray-200 dark:border-gray-600'\r\n    \r\n    if (isMaxRisk) {\r\n      baseClass += ' bg-yellow-200 dark:bg-yellow-300 border-2 border-yellow-400 text-yellow-900 dark:text-yellow-800'\r\n    } else if (isHighlighted) {\r\n      baseClass += ' bg-gray-200 dark:bg-gray-600 border border-gray-400 text-gray-800 dark:text-gray-200'\r\n    } else {\r\n      // 評価点に基づく色分け\r\n      switch(evaluationScore) {\r\n        case 10: baseClass += ' bg-red-500 dark:bg-red-600 text-white'; break\r\n        case 7: baseClass += ' bg-red-300 dark:bg-red-400 text-red-900 dark:text-red-100'; break\r\n        case 4: baseClass += ' bg-orange-300 dark:bg-orange-400 text-orange-900 dark:text-orange-100'; break\r\n        case 2: baseClass += ' bg-yellow-300 dark:bg-yellow-400 text-yellow-900 dark:text-yellow-800'; break\r\n        case 1: baseClass += ' bg-green-300 dark:bg-green-400 text-green-900 dark:text-green-800'; break\r\n        default: baseClass += ' bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300'\r\n      }\r\n    }\r\n    \r\n    return baseClass\r\n  }\r\n\r\n  return (\r\n    <div className=\"aspect-container\">\r\n      <section className=\"flex-grow p-3 flex flex-row gap-3 overflow-hidden bg-white\">\r\n        {/* 左列: 写真ギャラリー & 書類アップロード */}\r\n        <div className=\"w-4/12 flex flex-col h-full space-y-3\">\r\n          <PhotoViewer\r\n            mainPhoto={photoUrl}\r\n            thumbnails={[\r\n              photoUrl,\r\n              'https://placehold.co/120x90/e2e8f0/475569?text=Photo+1',\r\n              'https://placehold.co/120x90/e2e8f0/475569?text=Photo+2',\r\n              'https://placehold.co/120x90/e2e8f0/475569?text=Photo+3'\r\n            ]}\r\n            showGalleryInfo={true}\r\n            galleryTitle=\"危険箇所写真\"\r\n            className=\"flex-grow\"\r\n          />\r\n          <FileUpload\r\n            variant=\"document\"\r\n            layout=\"vertical\"\r\n            size=\"md\"\r\n            onFileUpload={handleFileUpload}\r\n            label=\"書類をアップロード\"\r\n          />\r\n        </div>\r\n\r\n        {/* 右列: 入力表 & 評価 */}\r\n        <div className=\"w-8/12 flex flex-col h-full space-y-3\">\r\n          <div className=\"flex-grow flex flex-col border rounded-lg p-2 overflow-hidden\">\r\n            <div className=\"flex items-center mb-2\">\r\n              <h2 className=\"text-sm font-bold flex-shrink-0\">残留リスク評価</h2>\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                className=\"ml-auto text-xs\"\r\n                onClick={addNewEvent}\r\n              >\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-3.5 w-3.5 mr-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M12 4v16m8-8H4\" />\r\n                </svg>\r\n                危険事象を追加\r\n              </Button>\r\n            </div>\r\n            <div className=\"table-container text-xs overflow-auto\">\r\n              <table className=\"w-full\">\r\n                <thead className=\"bg-gray-50 sticky top-0\">\r\n                  <tr>\r\n                    <th className=\"p-1 border w-8\">No.</th>\r\n                    <th className=\"p-1 border w-2/5\">危険事象</th>\r\n                    <th className=\"p-1 border\">遭遇頻度 Px</th>\r\n                    <th className=\"p-1 border\">可能性 Py</th>\r\n                    <th className=\"p-1 border\">発生可能性 P</th>\r\n                    <th className=\"p-1 border\">危害の重大性</th>\r\n                    <th className=\"p-1 border\">リスクポイント</th>\r\n                    <th className=\"p-1 border\">リスクレベル</th>\r\n                    <th className=\"p-1 border w-8\">操作</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {events.map((event) => {\r\n                    const isMaxRisk = event.id === maxRiskEvent?.id\r\n                    return (\r\n                      <tr key={event.id} className={isMaxRisk ? 'bg-yellow-50 dark:bg-yellow-900/20' : 'hover:bg-gray-50 dark:hover:bg-gray-800'}>\r\n                        <td className=\"p-1 border text-center font-bold\">\r\n                          <div className={isMaxRisk ? 'bg-yellow-200 dark:bg-yellow-300 rounded text-yellow-900 dark:text-yellow-800' : ''}>{event.id}</div>\r\n                        </td>\r\n                        <td className=\"p-1 border\">\r\n                          <textarea\r\n                            className={`w-full border rounded p-1 text-xs ${isMaxRisk ? 'bg-yellow-50 dark:bg-yellow-900/30' : 'bg-white dark:bg-gray-700'} text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600`}\r\n                            rows={1}\r\n                            value={event.eventDescription}\r\n                            onChange={(e) => handleEventChange(event.id, 'eventDescription', e.target.value)}\r\n                          />\r\n                        </td>\r\n                        <td className=\"p-1 border\">\r\n                          <select\r\n                            className={`w-full p-1 border rounded ${isMaxRisk ? 'bg-yellow-50 dark:bg-yellow-900/30' : 'bg-white dark:bg-gray-700'} text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600`}\r\n                            value={event.encounterFrequency}\r\n                            onChange={(e) => handleEventChange(event.id, 'encounterFrequency', Number(e.target.value))}\r\n                          >\r\n                            {[1, 2, 3].map(n => (\r\n                              <option key={`encounter-${event.id}-${n}`} value={n}>{n}</option>\r\n                            ))}\r\n                          </select>\r\n                        </td>\r\n                        <td className=\"p-1 border\">\r\n                          <select\r\n                            className={`w-full p-1 border rounded ${isMaxRisk ? 'bg-yellow-50 dark:bg-yellow-900/30' : 'bg-white dark:bg-gray-700'} text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600`}\r\n                            value={event.possibility}\r\n                            onChange={(e) => handleEventChange(event.id, 'possibility', Number(e.target.value))}\r\n                          >\r\n                            {[1, 2, 3].map(n => (\r\n                              <option key={`possibility-${event.id}-${n}`} value={n}>{n}</option>\r\n                            ))}\r\n                          </select>\r\n                        </td>\r\n                        <td className=\"p-1 border text-center bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200\">{event.occurrenceProbability}</td>\r\n                        <td className=\"p-1 border\">\r\n                          <select\r\n                            className={`w-full p-1 border rounded ${isMaxRisk ? 'bg-yellow-50 dark:bg-yellow-900/30' : 'bg-white dark:bg-gray-700'} text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600`}\r\n                            value={event.severityLevel}\r\n                            onChange={(e) => handleEventChange(event.id, 'severityLevel', e.target.value)}\r\n                          >\r\n                            {['S1', 'S2', 'S3', 'S4', 'S5'].map(s => (\r\n                              <option key={`severity-${event.id}-${s}`} value={s}>{s}</option>\r\n                            ))}\r\n                          </select>\r\n                        </td>\r\n                        <td className=\"p-1 border text-center bg-gray-100 dark:bg-gray-700 font-bold text-gray-800 dark:text-gray-200\">{event.riskPoint}</td>\r\n                        <td className=\"p-1 border text-center bg-gray-100 dark:bg-gray-700 font-bold text-gray-800 dark:text-gray-200\">{event.riskLevel}</td>\r\n                        <td className=\"p-1 border text-center\">\r\n                          <button\r\n                            onClick={() => removeEvent(event.id)}\r\n                            className=\"text-red-600 hover:text-red-800 p-1\"\r\n                            title=\"削除\"\r\n                          >\r\n                            <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\r\n                            </svg>\r\n                          </button>\r\n                        </td>\r\n                      </tr>\r\n                    )\r\n                  })}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"flex-shrink-0 grid grid-cols-3 gap-3\">\r\n            {/* リスクマトリックス */}\r\n            <div className=\"risk-matrix text-xs bg-gray-50 p-2 rounded border\">\r\n              <p className=\"font-bold mb-1 text-center text-sm\">リスクマトリックス</p>\r\n              <div className=\"grid grid-cols-6 gap-px bg-white p-1 text-[10px]\">\r\n                <div className=\"font-bold\"></div>\r\n                {['S1', 'S2', 'S3', 'S4', 'S5'].map(s => (\r\n                  <div key={`header-${s}`} className={`font-bold text-center p-1 ${s === maxRiskEvent?.severityLevel ? 'bg-blue-100' : ''}`}>{s}</div>\r\n                ))}\r\n                \r\n                {['P5', 'P4', 'P3', 'P2', 'P1'].map(p => (\r\n                  <React.Fragment key={`row-${p}`}>\r\n                    <div className={`font-bold text-center p-1 ${p === maxRiskEvent?.occurrenceProbability ? 'bg-blue-100' : ''}`}>{p}</div>\r\n                    {['S1', 'S2', 'S3', 'S4', 'S5'].map(s => {\r\n                      const value = calculateRiskPoint(p, s)\r\n                      return (\r\n                        <div\r\n                          key={`matrix-${p}-${s}`}\r\n                          className={getRiskMatrixCellClass(p, s, value)}\r\n                          onMouseEnter={() => setHighlightedCell({ p, s })}\r\n                          onMouseLeave={() => setHighlightedCell(null)}\r\n                        >\r\n                          {value}\r\n                        </div>\r\n                      )\r\n                    })}\r\n                  </React.Fragment>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            {/* 点数変換マトリックス */}\r\n            <div className=\"text-xs bg-gray-50 p-2 rounded border\">\r\n              <p className=\"font-bold mb-1 text-center text-sm\">点数変換</p>\r\n              <div className=\"space-y-1\">\r\n                <div className=\"grid grid-cols-2 gap-1 text-[10px] font-bold text-center\">\r\n                  <div>リスクポイント</div>\r\n                  <div>評価点</div>\r\n                </div>\r\n                {[\r\n                  { range: \"20-25\", points: [20, 21, 22, 23, 24, 25], evaluation: 10 },\r\n                  { range: \"15-19\", points: [15, 16, 17, 18, 19], evaluation: 7 },\r\n                  { range: \"10-14\", points: [10, 11, 12, 13, 14], evaluation: 4 },\r\n                  { range: \"5-9\", points: [5, 6, 7, 8, 9], evaluation: 2 },\r\n                  { range: \"1-4\", points: [1, 2, 3, 4], evaluation: 1 }\r\n                ].map((item) => {\r\n                  const isSelected = maxRiskEvent ? item.points.includes(maxRiskEvent.riskPoint) : false\r\n                  return (\r\n                    <div key={`risk-${item.range}`} className=\"grid grid-cols-2 gap-1\">\r\n                      <div className={`text-center p-1 text-[10px] ${isSelected ? 'bg-yellow-100' : 'bg-gray-100'}`}>\r\n                        {item.range}\r\n                      </div>\r\n                      <div className={getConversionMatrixCellClass(maxRiskEvent?.riskPoint || 0, item.evaluation, isSelected)}>\r\n                        {item.evaluation}\r\n                      </div>\r\n                    </div>\r\n                  )\r\n                })}\r\n              </div>\r\n            </div>\r\n            \r\n            {/* 最終評価と説明 */}\r\n            <div className=\"flex flex-col justify-between\">\r\n              <div className=\"bg-gray-50 border rounded-lg p-2 text-xs\">\r\n                <h3 className=\"font-bold mb-1\">評価手順</h3>\r\n                <div className=\"text-gray-600 space-y-1\">\r\n                  <p>1. リスクポイント: {maxRiskEvent?.riskPoint || 0}</p>\r\n                  <p>2. 発生可能性: {maxRiskEvent?.occurrenceProbability}</p>\r\n                  <p>3. 危害の重大性: {maxRiskEvent?.severityLevel}</p>\r\n                  <p>4. 変換後評価: {convertRiskPointToEvaluation(maxRiskEvent?.riskPoint || 0)}</p>\r\n                </div>\r\n              </div>\r\n              <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-2 text-center\">\r\n                <h3 className=\"text-sm font-medium text-blue-800\">危険因 (最終評価)</h3>\r\n                <p className=\"text-3xl font-bold text-blue-700\">{convertRiskPointToEvaluation(maxRiskEvent?.riskPoint || 0)}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n    </div>\r\n  )\r\n}","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\HazardPsychologicalAssessment.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\MatrixDisplay.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'selectedRow' is defined but never used. Allowed unused args must match /^_/u.","line":20,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'selectedCol' is defined but never used. Allowed unused args must match /^_/u.","line":21,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":21,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport React, { useState } from 'react'\r\nimport matrixData from '@/data/evaluation-matrix.json'\r\nimport type { EvaluationMatrixData, ComprehensiveMatrixData, RULAMatrixData } from '@/types/evaluation-matrix'\r\n\r\nexport interface MatrixDisplayProps {\r\n  title?: string\r\n  type?: 'COMPREHENSIVE' | 'RULA' | 'OWAS' | 'NIOSH'\r\n  selectedRow?: string\r\n  selectedCol?: string\r\n  onCellClick?: (row: string, col: string, value: number) => void\r\n  onScoreChange?: (score: number) => void\r\n  className?: string\r\n}\r\n\r\nexport function MatrixDisplay({\r\n  title,\r\n  type = 'COMPREHENSIVE',\r\n  selectedRow,\r\n  selectedCol,\r\n  onCellClick,\r\n  onScoreChange,\r\n  className = ''\r\n}: MatrixDisplayProps): React.JSX.Element {\r\n  const [highlightedCell, setHighlightedCell] = useState<{ posture: string, duration: string, strength: number } | null>(null)\r\n\r\n  // JSONデータから該当する評価タイプのデータを取得\r\n  const evalData = matrixData as unknown as EvaluationMatrixData\r\n  const currentMatrix = evalData[type] as ComprehensiveMatrixData | RULAMatrixData | undefined\r\n  const displayTitle = title || (currentMatrix && 'name' in currentMatrix ? String(currentMatrix.name) : '')\r\n\r\n  if (!currentMatrix) {\r\n    return <div className=\"p-4 text-center text-red-500\">評価データが見つかりません</div>\r\n  }\r\n\r\n  // OWAS特殊処理 - 新しい4次元マトリックス構造\r\n  if (type === 'OWAS') {\r\n    return (\r\n      <div className={`text-xs bg-gray-50 dark:bg-gray-800 p-3 rounded border dark:border-gray-600 flex-grow flex flex-col ${className}`}>\r\n        <div className=\"mb-3 text-center\">\r\n          <p className=\"font-bold text-sm text-gray-800 dark:text-gray-200 mb-1\">{displayTitle}</p>\r\n          <p className=\"text-xs text-gray-600 dark:text-gray-400\">OWAS評価は専用コンポーネントを使用してください</p>\r\n        </div>\r\n        <div className=\"flex-grow flex items-center justify-center text-gray-500 dark:text-gray-400\">\r\n          OWASMatrixコンポーネントを使用\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // 従来のマトリックス形式（RULA, NIOSH）の処理\r\n  if (type !== 'COMPREHENSIVE') {\r\n    const matrix = currentMatrix as RULAMatrixData\r\n\r\n    const handleCellClick = (rowIndex: number, colIndex: number, value: number): void => {\r\n      const row = matrix.rows[rowIndex]\r\n      const col = matrix.columns[colIndex]\r\n      if (row && col) {\r\n        onCellClick?.(row, col, value)\r\n      }\r\n      onScoreChange?.(value)\r\n    }\r\n\r\n    const getCellClasses = (value: number): string => {\r\n      const scoreStr = value.toString()\r\n      const colorClass = matrix.scoreColors[scoreStr] ?? 'text-gray-600 bg-gray-50 dark:text-gray-400 dark:bg-gray-700'\r\n\r\n      const baseClasses = 'cursor-pointer transition-all duration-200 flex flex-col items-center justify-center text-xs font-bold border border-gray-200 dark:border-gray-600 min-h-[32px] p-1'\r\n      const highlightClass = 'hover:scale-105 hover:shadow-md'\r\n\r\n      return `${baseClasses} ${colorClass} ${highlightClass}`\r\n    }\r\n\r\n    return (\r\n      <div className={`text-xs bg-gray-50 dark:bg-gray-800 p-3 rounded border dark:border-gray-600 flex-grow flex flex-col ${className}`}>\r\n        <div className=\"mb-3 text-center\">\r\n          <p className=\"font-bold text-sm text-gray-800 dark:text-gray-200 mb-1\">{displayTitle}</p>\r\n          {currentMatrix && 'description' in currentMatrix && currentMatrix.description && (\r\n            <p className=\"text-xs text-gray-600 dark:text-gray-400\">{String(currentMatrix.description)}</p>\r\n          )}\r\n        </div>\r\n        \r\n        <div className=\"flex-grow overflow-auto\">\r\n          <table className=\"w-full border-collapse\">\r\n            <thead>\r\n              <tr>\r\n                <th className=\"border border-gray-300 dark:border-gray-600 p-1 bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 text-xs min-w-[60px]\"></th>\r\n                {matrix.columns.map((col, colIndex) => (\r\n                  <th key={colIndex} className=\"border border-gray-300 dark:border-gray-600 p-1 bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 text-xs min-w-[60px]\">\r\n                    {col}\r\n                  </th>\r\n                ))}\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {matrix.rows.map((row, rowIndex) => (\r\n                <tr key={rowIndex}>\r\n                  <td className=\"border border-gray-300 dark:border-gray-600 p-1 bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200 text-xs font-medium min-w-[60px]\">\r\n                    {row}\r\n                  </td>\r\n                  {matrix.matrix[rowIndex]?.map((value, colIndex) => {\r\n                    const scoreStr = value.toString()\r\n                    const label = matrix.scoreLabels[scoreStr] ?? value.toString()\r\n\r\n                    return (\r\n                      <td\r\n                        key={colIndex}\r\n                        className={getCellClasses(value)}\r\n                        onClick={() => { handleCellClick(rowIndex, colIndex, value) }}\r\n                        title={`${label} (${value})`}\r\n                      >\r\n                        <div className=\"font-bold\">{value}</div>\r\n                        <div className=\"text-[9px] leading-none\">{label}</div>\r\n                      </td>\r\n                    )\r\n                  })}\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  // マトリックス評価（COMPREHENSIVE）の処理\r\n  const comprehensiveMatrix = currentMatrix as ComprehensiveMatrixData\r\n\r\n  const handleComprehensiveCellClick = (posture: string, duration: string, strengthIndex: number, value: number): void => {\r\n    setHighlightedCell({ posture, duration, strength: strengthIndex })\r\n    onCellClick?.(posture, duration, value)\r\n    onScoreChange?.(value)\r\n  }\r\n\r\n  const getCellClasses = (value: number, posture: string, duration: string, strengthIndex: number): string => {\r\n    const isHighlighted = highlightedCell?.posture === posture &&\r\n                         highlightedCell?.duration === duration &&\r\n                         highlightedCell?.strength === strengthIndex\r\n    const scoreStr = value.toString()\r\n    const colorClass = comprehensiveMatrix.scoreColors[scoreStr] ?? 'text-gray-600 bg-gray-50 dark:text-gray-400 dark:bg-gray-700'\r\n\r\n    const baseClasses = 'cursor-pointer transition-all duration-200 flex items-center justify-center text-xs font-bold border border-gray-200 dark:border-gray-600 min-h-[44px] p-1 matrix-button'\r\n    const highlightClass = isHighlighted ? 'ring-4 ring-yellow-400 dark:ring-yellow-300 scale-110 z-10 bg-yellow-200 dark:bg-yellow-800 shadow-lg border-yellow-500 dark:border-yellow-400' : 'hover:scale-105 hover:shadow-md hover:bg-gray-100 dark:hover:bg-gray-600'\r\n\r\n    return `${baseClasses} ${colorClass} ${highlightClass}`\r\n  }\r\n\r\n  return (\r\n    <div className={`text-xs bg-gray-50 dark:bg-gray-800 p-3 rounded border dark:border-gray-600 flex-grow flex flex-col evaluation-matrix-mobile mobile-chrome-visible ${className}`}>\r\n      <div className=\"mb-3 text-center\">\r\n        <p className=\"font-bold text-sm text-gray-800 dark:text-gray-200 mb-1\">{displayTitle}</p>\r\n        {comprehensiveMatrix.description && (\r\n          <p className=\"text-xs text-gray-600 dark:text-gray-400\">{comprehensiveMatrix.description}</p>\r\n        )}\r\n      </div>\r\n\r\n      {/* マトリックス評価 */}\r\n      <div className=\"flex-grow overflow-auto\">\r\n        <div className=\"grid grid-cols-[auto_auto_1fr_1fr_1fr_1fr_1fr] gap-1 text-center text-[9px]\">\r\n          {/* Column Headers */}\r\n          <div className=\"col-span-2\"></div>\r\n          {comprehensiveMatrix.strengthLevels.map((strength, index) => (\r\n            <div key={index} className=\"font-bold text-gray-800 dark:text-gray-200\">{strength}</div>\r\n          ))}\r\n\r\n          {/* Matrix Content */}\r\n          {comprehensiveMatrix.postureGroups.map((posture, postureIndex) => {\r\n            const rows: React.JSX.Element[] = []\r\n\r\n            comprehensiveMatrix.durationLevels.forEach((duration, durationIndex) => {\r\n              const isFirstDurationForPosture = durationIndex === 0\r\n\r\n              const row = (\r\n                <React.Fragment key={`${postureIndex}-${durationIndex}`}>\r\n                  {isFirstDurationForPosture && (\r\n                    <div\r\n                      className=\"border-r-2 border-gray-300 dark:border-gray-600 flex items-center justify-center bg-gray-100 dark:bg-gray-700\"\r\n                      style={{ gridRow: `span ${comprehensiveMatrix.durationLevels.length}` }}\r\n                    >\r\n                      <div className=\"text-[10px] font-bold -rotate-90 whitespace-nowrap text-gray-800 dark:text-gray-200\">\r\n                        {posture}\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                  <div className=\"text-[10px] font-bold self-center border-r pr-1 text-gray-800 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 p-1\">\r\n                    {duration}\r\n                  </div>\r\n                  {comprehensiveMatrix.matrix[posture]?.[duration]?.map((value, strengthIndex) => (\r\n                    <div\r\n                      key={strengthIndex}\r\n                      className={getCellClasses(value, posture, duration, strengthIndex)}\r\n                      onClick={() => { handleComprehensiveCellClick(posture, duration, strengthIndex, value) }}\r\n                      title={`${posture} × ${duration} × ${comprehensiveMatrix.strengthLevels[strengthIndex] ?? ''}: ${value}`}\r\n                    >\r\n                      {value}\r\n                    </div>\r\n                  ))}\r\n                </React.Fragment>\r\n              )\r\n\r\n              rows.push(row)\r\n            })\r\n\r\n            return rows\r\n          }).flat()}\r\n        </div>\r\n      </div>\r\n\r\n      {/* 選択されたセルの情報 */}\r\n      {highlightedCell && (\r\n        <div className=\"mt-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded text-xs\">\r\n          <p className=\"text-gray-800 dark:text-gray-200\">\r\n            選択: <span className=\"font-medium\">{highlightedCell.posture} × {highlightedCell.duration} × {comprehensiveMatrix.strengthLevels[highlightedCell.strength] ?? ''}</span> =\r\n            <span className=\"font-bold ml-1 text-blue-600 dark:text-blue-400\">\r\n              {comprehensiveMatrix.matrix[highlightedCell.posture]?.[highlightedCell.duration]?.[highlightedCell.strength]}\r\n            </span>\r\n          </p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\MatrixTestPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\MentalFactorDetail.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\OWASMatrix.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\PhotoViewer.tsx","messages":[],"suppressedMessages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":41,"column":9,"nodeType":"JSXOpeningElement","endLine":45,"endColumn":11,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":60,"column":15,"nodeType":"JSXOpeningElement","endLine":69,"endColumn":17,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\PhysicalFactorDetail.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\PostureList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\PsychologicalStressAssessment.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\RULAMatrix.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\StandardsLegend.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\SummaryPanel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\WorkTimeDetail.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":190,"column":13,"nodeType":"JSXOpeningElement","endLine":190,"endColumn":83}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport React, { useState, useEffect } from 'react'\r\nimport { Header } from '@/components/layout'\r\nimport { FileUpload, Input, Button } from '@/components/ui'\r\nimport { EVALUATION_STANDARDS, DEFAULT_EVALUATION_DATA } from '@/data/defaultEvaluationData'\r\n\r\nexport interface Worker {\r\n  id: string\r\n  name: string\r\n  laborTime: number\r\n  actualWorkTime: number\r\n  ratio: number\r\n  timeClass: string\r\n}\r\n\r\nexport interface WorkTimeDetailProps {\r\n  evaluationNo?: string\r\n  creator?: {\r\n    department: string\r\n    name: string\r\n    date: string\r\n  }\r\n  checker?: {\r\n    department: string\r\n    name: string\r\n    date: string\r\n  }\r\n  workInfo?: {\r\n    workName: string\r\n    factoryName: string\r\n    processName: string\r\n  }\r\n  photoUrl?: string\r\n  workers?: Worker[]\r\n}\r\n\r\ninterface WorkerData {\r\n  name: string\r\n  laborTime: number\r\n  actualWorkTime: number\r\n  timeClass?: string\r\n}\r\n\r\ninterface WorkTimeFactorData {\r\n  workers?: WorkerData[]\r\n}\r\n\r\n// デフォルトデータから作業時間項目を生成\r\nconst generateWorkers = (): Worker[] => {\r\n  const _workTimeStandards = EVALUATION_STANDARDS.workTime\r\n  const defaultData = DEFAULT_EVALUATION_DATA as Record<string, unknown>\r\n  const workTimeFactor = (defaultData.workTimeFactor ?? defaultData.workTimeDefaults ?? {}) as WorkTimeFactorData\r\n\r\n  const workers = workTimeFactor.workers ?? []\r\n\r\n  return workers.map((worker: WorkerData, index: number): Worker => ({\r\n    id: `${index + 1}`,\r\n    name: worker.name,\r\n    laborTime: worker.laborTime,\r\n    actualWorkTime: worker.actualWorkTime,\r\n    ratio: Math.round((worker.actualWorkTime / worker.laborTime) * 100),\r\n    timeClass: worker.timeClass || 'e'\r\n  }))\r\n}\r\n\r\nconst defaultWorkers: Worker[] = generateWorkers() || [\r\n  {\r\n    id: '1',\r\n    name: 'Aさん',\r\n    laborTime: 8.0,\r\n    actualWorkTime: 6.8,\r\n    ratio: 85,\r\n    timeClass: 'e'\r\n  },\r\n  {\r\n    id: '2',\r\n    name: 'Bさん',\r\n    laborTime: 8.0,\r\n    actualWorkTime: 7.2,\r\n    ratio: 90,\r\n    timeClass: 'e'\r\n  }\r\n]\r\n\r\nexport function WorkTimeDetail({\r\n  evaluationNo,\r\n  creator,\r\n  checker,\r\n  workInfo,\r\n  photoUrl = 'https://placehold.co/600x450/e5e7eb/4b5563?text=Photo',\r\n  workers = defaultWorkers\r\n}: WorkTimeDetailProps): React.JSX.Element {\r\n  const [workerList, setWorkerList] = useState(workers)\r\n  const [maxTime, setMaxTime] = useState(0)\r\n  const [maxTimeClass, setMaxTimeClass] = useState('')\r\n  const [maxWorkerId, setMaxWorkerId] = useState('')\r\n\r\n  const getTimeClass = (hours: number): string => {\r\n    if (hours < 0.25) return 'a'\r\n    if (hours < 1) return 'b'\r\n    if (hours < 3) return 'c'\r\n    if (hours < 6.5) return 'd'\r\n    return 'e'\r\n  }\r\n\r\n  const calculateRatio = (laborTime: number, actualWorkTime: number): number => {\r\n    if (laborTime === 0) return 0\r\n    return Math.round((actualWorkTime / laborTime) * 100)\r\n  }\r\n\r\n  const updateWorker = (id: string, field: 'laborTime' | 'actualWorkTime', value: string): void => {\r\n    setWorkerList(prev => prev.map(worker => {\r\n      if (worker.id === id) {\r\n        const updated = { ...worker }\r\n        updated[field] = parseFloat(value) || 0\r\n        updated.ratio = calculateRatio(updated.laborTime, updated.actualWorkTime)\r\n        updated.timeClass = getTimeClass(updated.actualWorkTime)\r\n        return updated\r\n      }\r\n      return worker\r\n    }))\r\n  }\r\n\r\n  const addWorker = () => {\r\n    const workerCount = workerList.length\r\n    const workerLetter = String.fromCharCode(65 + workerCount) // C, D, E...\r\n    const workTimeValue = workerLetter === 'C' ? 1.0 : 7.0\r\n\r\n    const newWorker: Worker = {\r\n      id: String(workerCount + 1),\r\n      name: `${workerLetter}さん`,\r\n      laborTime: 8.0,\r\n      actualWorkTime: workTimeValue,\r\n      ratio: calculateRatio(8.0, workTimeValue),\r\n      timeClass: getTimeClass(workTimeValue)\r\n    }\r\n    setWorkerList([...workerList, newWorker])\r\n  }\r\n\r\n  // 最大作業時間の計算\r\n  useEffect(() => {\r\n    let max = 0\r\n    let maxClass = ''\r\n    let maxId = ''\r\n    \r\n    workerList.forEach(worker => {\r\n      if (worker.actualWorkTime > max) {\r\n        max = worker.actualWorkTime\r\n        maxClass = worker.timeClass\r\n        maxId = worker.id\r\n      }\r\n    })\r\n    \r\n    setMaxTime(max)\r\n    setMaxTimeClass(maxClass)\r\n    setMaxWorkerId(maxId)\r\n  }, [workerList])\r\n\r\n  const handleFileUpload = (_files: FileList): void => {\r\n    // TODO: Process uploaded files\r\n  }\r\n\r\n  const _handleBackToMain = (): void => {\r\n    window.location.href = '/evaluation/new'\r\n  }\r\n\r\n  const timeClassRanges = [\r\n    { class: 'a', range: 'T < 0.25h', label: 'a' },\r\n    { class: 'b', range: '0.25h ≤ T < 1h', label: 'b' },\r\n    { class: 'c', range: '1h ≤ T < 3h', label: 'c' },\r\n    { class: 'd', range: '3h ≤ T < 6.5h', label: 'd' },\r\n    { class: 'e', range: 'T ≥ 6.5h', label: 'e' }\r\n  ]\r\n\r\n  return (\r\n    <div className=\"aspect-container\">\r\n      <Header\r\n        variant=\"standard\"\r\n        evaluationNo={evaluationNo}\r\n        creator={creator}\r\n        checker={checker}\r\n        workInfo={workInfo}\r\n      />\r\n\r\n      <section className=\"flex-grow p-3 flex flex-row gap-3 overflow-hidden bg-white\">\r\n        {/* 左列: 写真 & 書類アップロード */}\r\n        <div className=\"w-4/12 flex flex-col h-full space-y-3\">\r\n          <div className=\"flex-grow bg-gray-100 rounded-lg flex items-center justify-center p-2\">\r\n            <img src={photoUrl} className=\"evaluation-photo rounded\" alt=\"関連写真\" />\r\n          </div>\r\n          <FileUpload\r\n            variant=\"document\"\r\n            layout=\"vertical\"\r\n            size=\"sm\"\r\n            onFileUpload={handleFileUpload}\r\n            label=\"資料をアップロード\"\r\n            showAttachedFiles={true}\r\n            attachedFiles={[\r\n              {\r\n                id: '1',\r\n                name: '作業時間管理基準書.pdf',\r\n                size: 1024000,\r\n                type: 'application/pdf',\r\n                url: 'https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf'\r\n              },\r\n              {\r\n                id: '2',\r\n                name: '評価写真.jpg',\r\n                size: 512000,\r\n                type: 'image/jpeg',\r\n                url: 'https://placehold.co/800x600/e5e7eb/4b5563?text=Sample+Image'\r\n              },\r\n              {\r\n                id: '3',\r\n                name: '参考資料.docx',\r\n                size: 256000,\r\n                type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\r\n                url: '#'\r\n              }\r\n            ]}\r\n          />\r\n        </div>\r\n\r\n        {/* 右列: 入力表 & 評価 */}\r\n        <div className=\"w-8/12 flex flex-col h-full space-y-3\">\r\n          <div className=\"flex-grow flex flex-col border rounded-lg p-2 overflow-hidden\">\r\n            <div className=\"flex items-center mb-2\">\r\n              <h2 className=\"text-sm font-bold flex-shrink-0\">作業時間入力</h2>\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                className=\"ml-auto text-xs\"\r\n                onClick={addWorker}\r\n              >\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-3.5 w-3.5 mr-1\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth=\"2\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M12 4v16m8-8H4\" />\r\n                </svg>\r\n                作業者を追加\r\n              </Button>\r\n            </div>\r\n            <div className=\"table-container text-xs overflow-auto\">\r\n              <table className=\"w-full\">\r\n                <thead className=\"bg-gray-50 dark:bg-gray-700 sticky top-0\">\r\n                  <tr>\r\n                    <th className=\"p-1 border border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200\">作業者</th>\r\n                    <th className=\"p-1 border border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200\">労働時間 (h)</th>\r\n                    <th className=\"p-1 border border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200\">当該作業に対する実際作業時間 (h)</th>\r\n                    <th className=\"p-1 border border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200\">割合</th>\r\n                    <th className=\"p-1 border border-gray-300 dark:border-gray-600 text-gray-800 dark:text-gray-200\">時間分類</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  {workerList.map((worker) => {\r\n                    const isMax = worker.id === maxWorkerId\r\n                    return (\r\n                      <tr key={worker.id} className={isMax ? 'bg-yellow-50 dark:bg-yellow-900/20' : 'hover:bg-gray-50 dark:hover:bg-gray-800'}>\r\n                        <td className=\"p-1 border border-gray-300 dark:border-gray-600 font-bold text-gray-800 dark:text-gray-200\">{worker.name}</td>\r\n                        <td className=\"p-1 border border-gray-300 dark:border-gray-600\">\r\n                          <Input\r\n                            type=\"text\"\r\n                            className={`w-full p-1 text-right text-xs ${isMax ? 'bg-yellow-50 dark:bg-yellow-900/30' : 'bg-white dark:bg-gray-700'} text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600`}\r\n                            value={worker.laborTime.toFixed(1)}\r\n                            onChange={(e) => updateWorker(worker.id, 'laborTime', e.target.value)}\r\n                          />\r\n                        </td>\r\n                        <td className=\"p-1 border border-gray-300 dark:border-gray-600\">\r\n                          <Input\r\n                            type=\"text\"\r\n                            className={`w-full p-1 text-right text-xs ${isMax ? 'bg-yellow-50 dark:bg-yellow-900/30' : 'bg-white dark:bg-gray-700'} text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600`}\r\n                            value={worker.actualWorkTime.toFixed(1)}\r\n                            onChange={(e) => updateWorker(worker.id, 'actualWorkTime', e.target.value)}\r\n                          />\r\n                        </td>\r\n                        <td className=\"p-1 border border-gray-300 dark:border-gray-600 text-center bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200\">{worker.ratio}%</td>\r\n                        <td className=\"p-1 border border-gray-300 dark:border-gray-600 text-center bg-gray-100 dark:bg-gray-700 font-bold text-gray-800 dark:text-gray-200\">{worker.timeClass}</td>\r\n                      </tr>\r\n                    )\r\n                  })}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"flex-shrink-0 grid grid-cols-2 gap-3\">\r\n            <div className=\"text-xs bg-gray-50 dark:bg-gray-800 p-2 rounded border border-gray-200 dark:border-gray-600\">\r\n              <p className=\"font-bold mb-2 text-center text-sm text-gray-800 dark:text-gray-200\">時間分類マトリクス</p>\r\n              <div className=\"space-y-1 text-[10px]\">\r\n                {timeClassRanges.map((range) => (\r\n                  <div\r\n                    key={range.class}\r\n                    className={`p-1 rounded ${\r\n                      range.class === maxTimeClass\r\n                        ? 'bg-yellow-200 dark:bg-yellow-300 font-bold border border-yellow-400 text-yellow-900 dark:text-yellow-800'\r\n                        : 'text-gray-700 dark:text-gray-300'\r\n                    }`}\r\n                  >\r\n                    {range.label}: {range.range}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n            <div className=\"bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-700 rounded-lg p-2 text-center flex flex-col justify-center\">\r\n              <h3 className=\"text-sm font-medium text-blue-800 dark:text-blue-200\">作業時間 (最大)</h3>\r\n              <div className=\"flex items-baseline justify-center gap-2\">\r\n                <p className=\"text-5xl font-bold text-blue-700 dark:text-blue-300\">\r\n                  {maxTime.toFixed(1)} <span className=\"text-lg\">h</span>\r\n                </p>\r\n                <p className=\"text-3xl font-bold text-blue-700 dark:text-blue-300\">({maxTimeClass})</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n\r\n    </div>\r\n  )\r\n}","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\evaluation\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\layout\\AspectContainer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\layout\\EvaluationLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\layout\\FactorPageLayout.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'title' is defined but never used. Allowed unused args must match /^_/u.","line":36,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":36,"endColumn":8},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'breadcrumbLabel' is defined but never used. Allowed unused args must match /^_/u.","line":37,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":37,"endColumn":18}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport React, { type ReactNode } from 'react'\r\nimport { useRouter } from 'next/navigation'\r\nimport { Header, Footer } from '@/components/layout'\r\nimport { Button } from '@/components/ui'\r\n\r\nexport interface FactorPageLayoutProps {\r\n  children: ReactNode\r\n  title: string\r\n  breadcrumbLabel: string\r\n  evaluationNo?: string\r\n  creator?: {\r\n    department: string\r\n    name: string\r\n    date: string\r\n  }\r\n  checker?: {\r\n    department: string\r\n    name: string\r\n    date: string\r\n  }\r\n  workInfo?: {\r\n    workName: string\r\n    factoryName: string\r\n    processName: string\r\n  }\r\n  showAiButton?: boolean\r\n  aiButtonText?: string\r\n  onAiClick?: () => void\r\n  customActions?: ReactNode\r\n}\r\n\r\nexport function FactorPageLayout({\r\n  children,\r\n  title,\r\n  breadcrumbLabel,\r\n  evaluationNo = 'EV-2024-001',\r\n  creator = {\r\n    department: '生産技術企画部',\r\n    name: '山田 太郎',\r\n    date: '2024/08/20'\r\n  },\r\n  checker = {\r\n    department: '生産企画部',\r\n    name: '鈴木 一郎',\r\n    date: '2024/08/21'\r\n  },\r\n  workInfo = {\r\n    workName: 'サンプル作業',\r\n    factoryName: '〇〇工場',\r\n    processName: '△△工程'\r\n  },\r\n  showAiButton = true,\r\n  aiButtonText = 'AIで自動選択する',\r\n  onAiClick,\r\n  customActions\r\n}: FactorPageLayoutProps): React.JSX.Element {\r\n  const router = useRouter()\r\n\r\n  const handleBackToMain = () => {\r\n    router.push('/evaluation/new')\r\n  }\r\n\r\n  const handleBackToDashboard = () => {\r\n    router.push('/dashboard')\r\n  }\r\n\r\n  const handleSave = () => {\r\n    // TODO: Implement save functionality\r\n  }\r\n\r\n  return (\r\n    <div className=\"aspect-container\">\r\n      <Header\r\n        variant=\"standard\"\r\n        evaluationNo={evaluationNo}\r\n        creator={creator}\r\n        checker={checker}\r\n        workInfo={workInfo}\r\n      />\r\n\r\n      <main className=\"flex-grow overflow-hidden bg-white dark:bg-gray-900\">\r\n        {children}\r\n      </main>\r\n\r\n      <Footer\r\n        variant=\"standard\"\r\n        status=\"unsaved\"\r\n        showAiButton={showAiButton}\r\n        aiButtonText={aiButtonText}\r\n        onAiButtonClick={onAiClick}\r\n        actions={\r\n          customActions || (\r\n            <div className=\"flex gap-2\">\r\n              <Button \r\n                variant=\"outline\" \r\n                size=\"sm\"\r\n                onClick={handleBackToMain}\r\n              >\r\n                ← メイン画面\r\n              </Button>\r\n              <Button \r\n                variant=\"outline\" \r\n                size=\"sm\"\r\n                onClick={handleBackToDashboard}\r\n              >\r\n                ダッシュボード\r\n              </Button>\r\n              <Button \r\n                variant=\"primary\" \r\n                size=\"sm\"\r\n                onClick={handleSave}\r\n              >\r\n                保存\r\n              </Button>\r\n            </div>\r\n          )\r\n        }\r\n      />\r\n    </div>\r\n  )\r\n}","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\layout\\Footer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\layout\\Header.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\layout\\PageLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\layout\\UnifiedEvaluationLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\layout\\UnifiedHeader.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'Image' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport React from 'react'\r\nimport Link from 'next/link'\r\nimport Image from 'next/image'\r\nimport { usePathname } from 'next/navigation'\r\n\r\ninterface UnifiedHeaderProps {\r\n  title: string\r\n  score?: string | number\r\n  showLogo?: boolean\r\n  variant?: 'home' | 'evaluation' | 'dashboard'\r\n}\r\n\r\nconst ScoreBadge = ({ score }: { score: string | number }) => {\r\n  return (\r\n    <div className=\"flex items-center space-x-2\">\r\n      <div className=\"bg-green-500 text-white px-3 py-1 rounded-full text-sm font-semibold\">\r\n        {score}\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default function UnifiedHeader({\r\n  title,\r\n  score,\r\n  showLogo = true,\r\n  variant = 'evaluation'\r\n}: UnifiedHeaderProps): React.JSX.Element {\r\n  const pathname = usePathname()\r\n\r\n  const getHeaderStyles = () => {\r\n    switch (variant) {\r\n      case 'home':\r\n        return 'bg-gradient-to-r from-blue-600 to-blue-700 text-white'\r\n      case 'dashboard':\r\n        return 'bg-white border-b border-gray-200 text-gray-900'\r\n      case 'evaluation':\r\n      default:\r\n        return 'bg-white border-b border-gray-200 text-gray-900'\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className={`sticky top-0 z-50 ${getHeaderStyles()}`}>\r\n      <div className=\"container mx-auto px-4\">\r\n        <div className=\"flex items-center justify-between h-16\">\r\n          {/* Left side - Logo and Title */}\r\n          <div className=\"flex items-center space-x-4\">\r\n            {showLogo && (\r\n              <Link href=\"/\" className=\"flex items-center space-x-2\">\r\n                <div className=\"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center\">\r\n                  <span className=\"text-white text-sm font-bold\">3K</span>\r\n                </div>\r\n                <span className={`font-semibold ${variant === 'home' ? 'text-white' : 'text-gray-900'}`}>\r\n                  3K指数評価アプリ\r\n                </span>\r\n              </Link>\r\n            )}\r\n\r\n            <div className=\"flex items-center space-x-2\">\r\n              {score && <ScoreBadge score={score} />}\r\n              <h1 className={`text-xl font-semibold ${\r\n                variant === 'home' ? 'text-white' : 'text-gray-900'\r\n              }`}>\r\n                {title}\r\n              </h1>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Right side - Navigation */}\r\n          <div className=\"flex items-center space-x-4\">\r\n            {variant !== 'home' && (\r\n              <>\r\n                <Link\r\n                  href=\"/\"\r\n                  className={`px-3 py-2 rounded-md text-sm font-medium hover:bg-opacity-80 transition-colors ${\r\n                    pathname === '/'\r\n                      ? 'bg-blue-100 text-blue-700'\r\n                      : (variant as string) === 'home'\r\n                        ? 'text-blue-100 hover:text-white'\r\n                        : 'text-gray-600 hover:text-gray-900'\r\n                  }`}\r\n                >\r\n                  ホーム\r\n                </Link>\r\n                <Link\r\n                  href=\"/dashboard\"\r\n                  className={`px-3 py-2 rounded-md text-sm font-medium hover:bg-opacity-80 transition-colors ${\r\n                    pathname === '/dashboard'\r\n                      ? 'bg-blue-100 text-blue-700'\r\n                      : (variant as string) === 'home'\r\n                        ? 'text-blue-100 hover:text-white'\r\n                        : 'text-gray-600 hover:text-gray-900'\r\n                  }`}\r\n                >\r\n                  ダッシュボード\r\n                </Link>\r\n                <div className={`px-3 py-2 text-sm ${\r\n                  (variant as string) === 'home' ? 'text-blue-200' : 'text-gray-400'\r\n                }`}>\r\n                  ログアウト\r\n                </div>\r\n              </>\r\n            )}\r\n\r\n            {variant === 'home' && (\r\n              <div className=\"flex items-center space-x-2 text-blue-200 text-sm\">\r\n                <span>バージョン 1.0.0</span>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\layout\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\navigation\\UnifiedNavigationBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\optimized\\DynamicAIAssistant.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\optimized\\DynamicEvaluationComponents.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\optimized\\DynamicImports.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\optimized\\LazyLoadWrapper.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect was passed a dependency list that is not an array literal. This means we can't statically verify whether you've passed the correct dependencies.","line":222,"column":6,"nodeType":"Identifier","endLine":222,"endColumn":10,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'importFunction'. Either include it or remove the dependency array. If 'importFunction' changes too often, find the parent component that defines it and wrap that definition in useCallback.","line":222,"column":6,"nodeType":"Identifier","endLine":222,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [importFunction]","fix":{"range":[5299,5303],"text":"[importFunction]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\optimized\\OptimizedImage.tsx","messages":[{"ruleId":"jsx-a11y/alt-text","severity":1,"message":"Image elements must have an alt prop, either with meaningful text, or an empty string for decorative images.","line":204,"column":9,"nodeType":"JSXOpeningElement","endLine":211,"endColumn":11}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\n/**\r\n * 最適化画像コンポーネント\r\n * TDD Green Phase実装 - 画像パフォーマンス問題の解決\r\n */\r\n\r\nimport React, { useState, useRef, useEffect } from 'react';\r\nimport Image from 'next/image';\r\nimport { cn } from '@/lib/utils';\r\n\r\ninterface OptimizedImageProps {\r\n  src: string;\r\n  alt: string;\r\n  width?: number;\r\n  height?: number;\r\n  className?: string;\r\n  /**\r\n   * 画像の優先度\r\n   * - 'high': 重要な画像（LCPに影響する可能性）\r\n   * - 'normal': 通常の画像（デフォルト）\r\n   * - 'low': 低優先度の画像\r\n   */\r\n  priority?: 'high' | 'normal' | 'low';\r\n  /**\r\n   * 遅延読み込み設定\r\n   */\r\n  loading?: 'lazy' | 'eager';\r\n  /**\r\n   * レスポンシブ対応のサイズ設定\r\n   */\r\n  sizes?: string;\r\n  /**\r\n   * 品質設定（1-100）\r\n   */\r\n  quality?: number;\r\n  /**\r\n   * フォールバック画像\r\n   */\r\n  fallback?: string;\r\n  /**\r\n   * 読み込み完了コールバック\r\n   */\r\n  onLoad?: () => void;\r\n  /**\r\n   * エラーコールバック\r\n   */\r\n  onError?: () => void;\r\n  /**\r\n   * コンテナのアスペクト比\r\n   */\r\n  aspectRatio?: '16/9' | '4/3' | '1/1' | 'auto';\r\n  /**\r\n   * ブラー効果付きプレースホルダー\r\n   */\r\n  enableBlurPlaceholder?: boolean;\r\n}\r\n\r\n/**\r\n * 最適化画像コンポーネント\r\n *\r\n * TDD分析結果に基づく改善:\r\n * - Next.js Image component活用による自動WebP/AVIF変換\r\n * - 適切な遅延読み込み設定\r\n * - レスポンシブ対応のsizes属性\r\n * - 品質最適化とファイルサイズ削減\r\n * - Core Web Vitals向上（LCP改善）\r\n */\r\nexport const OptimizedImage: React.FC<OptimizedImageProps> = ({\r\n  src,\r\n  alt,\r\n  width,\r\n  height,\r\n  className,\r\n  priority = 'normal',\r\n  loading = 'lazy',\r\n  sizes = '(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw',\r\n  quality = 85,\r\n  fallback = '/images/placeholder.jpg',\r\n  onLoad,\r\n  onError,\r\n  aspectRatio = 'auto',\r\n  enableBlurPlaceholder = true,\r\n  ...props\r\n}) => {\r\n  const [imageError, setImageError] = useState(false);\r\n  const [isLoaded, setIsLoaded] = useState(false);\r\n  const [isInView, setIsInView] = useState(false);\r\n  const imageRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Intersection Observer for lazy loading\r\n  useEffect(() => {\r\n    if (loading === 'eager' || priority === 'high') {\r\n      setIsInView(true);\r\n      return;\r\n    }\r\n\r\n    const observer = new IntersectionObserver(\r\n      ([entry]) => {\r\n        if (entry?.isIntersecting) {\r\n          setIsInView(true);\r\n          observer.disconnect();\r\n        }\r\n      },\r\n      {\r\n        rootMargin: '50px', // 50px手前から読み込み開始\r\n        threshold: 0.1\r\n      }\r\n    );\r\n\r\n    if (imageRef.current) {\r\n      observer.observe(imageRef.current);\r\n    }\r\n\r\n    return () => observer.disconnect();\r\n  }, [loading, priority]);\r\n\r\n  // アスペクト比のスタイル\r\n  const aspectRatioStyles = {\r\n    '16/9': 'aspect-[16/9]',\r\n    '4/3': 'aspect-[4/3]',\r\n    '1/1': 'aspect-square',\r\n    'auto': ''\r\n  };\r\n\r\n  // 画像読み込み処理\r\n  const handleLoad = () => {\r\n    setIsLoaded(true);\r\n    onLoad?.();\r\n  };\r\n\r\n  // エラー処理\r\n  const handleError = () => {\r\n    setImageError(true);\r\n    onError?.();\r\n  };\r\n\r\n  // プレースホルダー生成\r\n  const generateBlurDataURL = (w: number, h: number) => {\r\n    // SSRセーフ: サーバーサイドではデフォルトのプレースホルダーを返す\r\n    if (typeof document === 'undefined') {\r\n      return 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiBmaWxsPSIjZjNmNGY2IiAvPjwvc3ZnPg==';\r\n    }\r\n\r\n    const canvas = document.createElement('canvas');\r\n    canvas.width = w;\r\n    canvas.height = h;\r\n    const ctx = canvas.getContext('2d');\r\n    if (ctx) {\r\n      ctx.fillStyle = '#f3f4f6'; // gray-100\r\n      ctx.fillRect(0, 0, w, h);\r\n    }\r\n    return canvas.toDataURL();\r\n  };\r\n\r\n  // 画像サイズの決定\r\n  const imageWidth = width || 800;\r\n  const imageHeight = height || 600;\r\n\r\n  // Next.js Image props\r\n  const imageProps = {\r\n    src: imageError ? fallback : src,\r\n    alt,\r\n    width: imageWidth,\r\n    height: imageHeight,\r\n    priority: priority === 'high',\r\n    loading: loading as 'lazy' | 'eager',\r\n    sizes,\r\n    quality,\r\n    onLoad: handleLoad,\r\n    onError: handleError,\r\n    className: cn(\r\n      'transition-opacity duration-300',\r\n      isLoaded ? 'opacity-100' : 'opacity-0',\r\n      'object-cover w-full h-full'\r\n    ),\r\n    ...(enableBlurPlaceholder && typeof document !== 'undefined' && {\r\n      placeholder: 'blur' as const,\r\n      blurDataURL: generateBlurDataURL(20, 20)\r\n    })\r\n  };\r\n\r\n  const containerClasses = cn(\r\n    'relative overflow-hidden bg-gray-100',\r\n    aspectRatioStyles[aspectRatio],\r\n    className\r\n  );\r\n\r\n  return (\r\n    <div\r\n      ref={imageRef}\r\n      className={containerClasses}\r\n      {...props}\r\n    >\r\n      {/* 読み込み状態インジケーター */}\r\n      {!isLoaded && isInView && (\r\n        <div className=\"absolute inset-0 flex items-center justify-center bg-gray-100\">\r\n          <div className=\"w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin\" />\r\n        </div>\r\n      )}\r\n\r\n      {/* メイン画像 */}\r\n      {isInView && (\r\n        <Image\r\n          {...imageProps}\r\n          style={{\r\n            objectFit: 'cover',\r\n            objectPosition: 'center'\r\n          }}\r\n          fill={!width || !height}\r\n        />\r\n      )}\r\n\r\n      {/* エラー状態の表示 */}\r\n      {imageError && (\r\n        <div className=\"absolute inset-0 flex flex-col items-center justify-center bg-gray-50 text-gray-500\">\r\n          <svg className=\"w-12 h-12 mb-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path\r\n              strokeLinecap=\"round\"\r\n              strokeLinejoin=\"round\"\r\n              strokeWidth=\"2\"\r\n              d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\"\r\n            />\r\n          </svg>\r\n          <span className=\"text-sm\">画像を読み込めませんでした</span>\r\n        </div>\r\n      )}\r\n\r\n      {/* デバッグ情報（開発環境のみ） */}\r\n      {process.env.NODE_ENV === 'development' && (\r\n        <div className=\"absolute top-2 left-2 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded\">\r\n          {imageWidth}x{imageHeight} | Q{quality}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n/**\r\n * 事前定義された最適化画像バリアント\r\n */\r\n\r\n// ヒーロー画像用（LCP対策）\r\nexport const HeroOptimizedImage: React.FC<Omit<OptimizedImageProps, 'priority' | 'loading'>> = (props) => (\r\n  <OptimizedImage\r\n    priority=\"high\"\r\n    loading=\"eager\"\r\n    quality={90}\r\n    {...props}\r\n  />\r\n);\r\n\r\n// サムネイル画像用\r\nexport const ThumbnailOptimizedImage: React.FC<Omit<OptimizedImageProps, 'priority' | 'sizes'>> = (props) => (\r\n  <OptimizedImage\r\n    priority=\"low\"\r\n    sizes=\"(max-width: 768px) 150px, 200px\"\r\n    quality={75}\r\n    aspectRatio=\"1/1\"\r\n    {...props}\r\n  />\r\n);\r\n\r\n// ギャラリー画像用\r\nexport const GalleryOptimizedImage: React.FC<Omit<OptimizedImageProps, 'sizes'>> = (props) => (\r\n  <OptimizedImage\r\n    sizes=\"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw\"\r\n    quality={80}\r\n    aspectRatio=\"4/3\"\r\n    {...props}\r\n  />\r\n);\r\n\r\n// バナー画像用\r\nexport const BannerOptimizedImage: React.FC<Omit<OptimizedImageProps, 'aspectRatio'>> = (props) => (\r\n  <OptimizedImage\r\n    aspectRatio=\"16/9\"\r\n    priority=\"high\"\r\n    quality={85}\r\n    {...props}\r\n  />\r\n);\r\n\r\nexport default OptimizedImage;","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\optimized\\PerformanceProvider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\providers\\AppBootstrap.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\report\\ReportGenerator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\report\\ReportHistory.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\AIComprehensiveAssistant.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\AIResultPopup.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\AspectContainer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\BackButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\Breadcrumb.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\Button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\Card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\DocumentViewer.tsx","messages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":135,"column":19,"nodeType":"JSXOpeningElement","endLine":139,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\nimport React, { useState, useRef } from 'react'\r\nimport { Button } from '@/components/ui/Button'\r\n\r\ninterface DocumentFile {\r\n  id: string\r\n  name: string\r\n  type: string\r\n  url: string\r\n  size: number\r\n}\r\n\r\ninterface DocumentViewerProps {\r\n  documents?: DocumentFile[]\r\n  onFileUpload?: (files: File[]) => void\r\n  className?: string\r\n}\r\n\r\nexport function DocumentViewer({\r\n  documents = [],\r\n  onFileUpload,\r\n  className = ''\r\n}: DocumentViewerProps): React.JSX.Element {\r\n  const [selectedDocument, setSelectedDocument] = useState<DocumentFile | null>(null)\r\n  const fileInputRef = useRef<HTMLInputElement>(null)\r\n\r\n  const handleFileUpload = (event: React.ChangeEvent<HTMLInputElement>): void => {\r\n    const files = Array.from(event.target.files || [])\r\n    if (files.length > 0 && onFileUpload) {\r\n      onFileUpload(files)\r\n    }\r\n  }\r\n\r\n  const handleUploadClick = () => {\r\n    fileInputRef.current?.click()\r\n  }\r\n\r\n  const formatFileSize = (bytes: number): string => {\r\n    if (bytes === 0) return '0 Bytes'\r\n    const k = 1024\r\n    const sizes = ['Bytes', 'KB', 'MB', 'GB']\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k))\r\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\r\n  }\r\n\r\n  const getFileIcon = (type: string): string => {\r\n    if (type.includes('pdf')) return '📄'\r\n    if (type.includes('image')) return '🖼️'\r\n    if (type.includes('video')) return '🎥'\r\n    if (type.includes('excel') || type.includes('spreadsheet')) return '📊'\r\n    if (type.includes('word') || type.includes('document')) return '📝'\r\n    return '📎'\r\n  }\r\n\r\n  return (\r\n    <div className={`flex flex-col bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 ${className}`}>\r\n      <div className=\"p-3 border-b border-gray-200 dark:border-gray-700\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <h3 className=\"font-semibold text-sm text-gray-900 dark:text-white\">資料閲覧</h3>\r\n          <Button\r\n            size=\"sm\"\r\n            variant=\"outline\"\r\n            onClick={handleUploadClick}\r\n            className=\"text-xs\"\r\n          >\r\n            ファイル追加\r\n          </Button>\r\n        </div>\r\n        <input\r\n          ref={fileInputRef}\r\n          type=\"file\"\r\n          multiple\r\n          accept=\".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.jpg,.jpeg,.png,.gif,.mp4,.mov\"\r\n          onChange={handleFileUpload}\r\n          className=\"hidden\"\r\n        />\r\n      </div>\r\n\r\n      <div className=\"flex-1 flex min-h-0\">\r\n        {/* ファイル一覧 */}\r\n        <div className=\"w-1/3 border-r border-gray-200 dark:border-gray-700 overflow-y-auto\">\r\n          {documents.length === 0 ? (\r\n            <div className=\"p-4 text-center text-gray-500 dark:text-gray-400 text-sm\">\r\n              資料がありません\r\n            </div>\r\n          ) : (\r\n            <div className=\"p-2 space-y-1\">\r\n              {documents.map((doc) => (\r\n                <div\r\n                  key={doc.id}\r\n                  onClick={() => setSelectedDocument(doc)}\r\n                  className={`p-2 rounded cursor-pointer border transition-colors ${\r\n                    selectedDocument?.id === doc.id\r\n                      ? 'bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-700'\r\n                      : 'hover:bg-gray-50 dark:hover:bg-gray-700 border-transparent'\r\n                  }`}\r\n                >\r\n                  <div className=\"flex items-start space-x-2\">\r\n                    <span className=\"text-lg flex-shrink-0\">\r\n                      {getFileIcon(doc.type)}\r\n                    </span>\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <p className=\"text-xs font-medium text-gray-900 dark:text-white truncate\">\r\n                        {doc.name}\r\n                      </p>\r\n                      <p className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                        {formatFileSize(doc.size)}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* プレビューエリア */}\r\n        <div className=\"flex-1 bg-gray-50 dark:bg-gray-900\">\r\n          {selectedDocument ? (\r\n            <div className=\"h-full flex flex-col\">\r\n              <div className=\"p-3 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700\">\r\n                <h4 className=\"text-sm font-medium text-gray-900 dark:text-white truncate\">\r\n                  {selectedDocument.name}\r\n                </h4>\r\n              </div>\r\n              <div className=\"flex-1 p-3\">\r\n                {selectedDocument.type.includes('pdf') ? (\r\n                  <iframe\r\n                    src={selectedDocument.url}\r\n                    className=\"w-full h-full border-0 rounded\"\r\n                    title={selectedDocument.name}\r\n                  />\r\n                ) : selectedDocument.type.includes('image') ? (\r\n                  <img\r\n                    src={selectedDocument.url}\r\n                    alt={selectedDocument.name}\r\n                    className=\"max-w-full max-h-full object-contain mx-auto\"\r\n                  />\r\n                ) : (\r\n                  <div className=\"flex items-center justify-center h-full\">\r\n                    <div className=\"text-center\">\r\n                      <div className=\"text-4xl mb-2\">\r\n                        {getFileIcon(selectedDocument.type)}\r\n                      </div>\r\n                      <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                        プレビューできません\r\n                      </p>\r\n                      <Button\r\n                        size=\"sm\"\r\n                        variant=\"outline\"\r\n                        onClick={() => window.open(selectedDocument.url, '_blank')}\r\n                        className=\"mt-2\"\r\n                      >\r\n                        ファイルを開く\r\n                      </Button>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"h-full flex items-center justify-center\">\r\n              <div className=\"text-center text-gray-500 dark:text-gray-400\">\r\n                <div className=\"text-4xl mb-2\">📄</div>\r\n                <p className=\"text-sm\">\r\n                  左側からファイルを選択してください\r\n                </p>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\FilePreview.tsx","messages":[],"suppressedMessages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":82,"column":13,"nodeType":"JSXOpeningElement","endLine":88,"endColumn":15,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\FileUpload.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\HelpTooltip.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\ImageUpload.tsx","messages":[],"suppressedMessages":[{"ruleId":"@next/next/no-img-element","severity":1,"message":"Using `<img>` could result in slower LCP and higher bandwidth. Consider using `<Image />` from `next/image` or a custom image loader to automatically optimize images. This may incur additional usage or cost from your provider. See: https://nextjs.org/docs/messages/no-img-element","line":150,"column":19,"nodeType":"JSXOpeningElement","endLine":154,"endColumn":21,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\Input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\InteractiveButton.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'useEffect' is defined but never used. Allowed unused vars must match /^_/u.","line":8,"column":35,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":44}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client'\r\n\r\n/**\r\n * インタラクティブボタンコンポーネント\r\n * TDD Green Phase実装 - ボタンフィードバック問題の解決\r\n */\r\n\r\nimport React, { useState, useRef, useEffect } from 'react';\r\nimport { cn } from '@/lib/utils';\r\n\r\ninterface InteractiveButtonProps {\r\n  children: React.ReactNode;\r\n  onClick?: (event: React.MouseEvent<HTMLButtonElement>) => void;\r\n  onKeyDown?: (event: React.KeyboardEvent<HTMLButtonElement>) => void;\r\n  disabled?: boolean;\r\n  className?: string;\r\n  variant?: 'primary' | 'secondary' | 'danger' | 'ghost';\r\n  size?: 'sm' | 'md' | 'lg';\r\n  /**\r\n   * ロード状態\r\n   */\r\n  loading?: boolean;\r\n  /**\r\n   * リップル効果の有効/無効\r\n   */\r\n  enableRipple?: boolean;\r\n  /**\r\n   * タッチフィードバックの強度\r\n   * - 'subtle': 軽微な効果\r\n   * - 'normal': 標準的な効果（デフォルト）\r\n   * - 'strong': 強い効果\r\n   */\r\n  feedbackIntensity?: 'subtle' | 'normal' | 'strong';\r\n  /**\r\n   * アクセシビリティ属性\r\n   */\r\n  'aria-label'?: string;\r\n  'aria-describedby'?: string;\r\n  role?: string;\r\n  type?: 'button' | 'submit' | 'reset';\r\n}\r\n\r\n/**\r\n * インタラクティブボタンコンポーネント\r\n *\r\n * TDD分析結果に基づく改善:\r\n * - ホバー・フォーカス・アクティブ状態の明確な視覚的フィードバック\r\n * - 150ms以内の高速反応性\r\n * - リップル効果による現代的なインタラクション\r\n * - アクセシビリティ完全対応\r\n * - モバイルタッチ操作最適化\r\n */\r\nexport const InteractiveButton: React.FC<InteractiveButtonProps> = ({\r\n  children,\r\n  onClick,\r\n  onKeyDown,\r\n  disabled = false,\r\n  className,\r\n  variant = 'primary',\r\n  size = 'md',\r\n  loading = false,\r\n  enableRipple = true,\r\n  feedbackIntensity = 'normal',\r\n  'aria-label': ariaLabel,\r\n  'aria-describedby': ariaDescribedBy,\r\n  role = 'button',\r\n  type = 'button',\r\n  ...props\r\n}) => {\r\n  const [isPressed, setIsPressed] = useState(false);\r\n  const [ripples, setRipples] = useState<Array<{ id: number; x: number; y: number }>>([]);\r\n  const buttonRef = useRef<HTMLButtonElement>(null);\r\n  const rippleIdCounter = useRef(0);\r\n\r\n  // バリアントスタイル\r\n  const variantStyles = {\r\n    primary: [\r\n      // ベーススタイル\r\n      'bg-blue-600 text-white border-blue-600',\r\n      // ホバー状態 - TDD要件: 明確な視覚変化\r\n      'hover:bg-blue-700 hover:border-blue-700 hover:shadow-lg',\r\n      'hover:shadow-blue-500/25',\r\n      // フォーカス状態 - TDD要件: アクセシビリティ対応\r\n      'focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2',\r\n      'focus:bg-blue-700',\r\n      // アクティブ状態 - TDD要件: クリック反応\r\n      'active:bg-blue-800 active:transform active:scale-[0.98]',\r\n      // 無効状態\r\n      'disabled:bg-gray-300 disabled:border-gray-300 disabled:text-gray-500',\r\n      'disabled:cursor-not-allowed disabled:shadow-none'\r\n    ],\r\n    secondary: [\r\n      'bg-gray-100 text-gray-900 border-gray-300',\r\n      'hover:bg-gray-200 hover:border-gray-400 hover:shadow-md',\r\n      'focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2',\r\n      'focus:bg-gray-200',\r\n      'active:bg-gray-300 active:transform active:scale-[0.98]',\r\n      'disabled:bg-gray-50 disabled:border-gray-200 disabled:text-gray-400'\r\n    ],\r\n    danger: [\r\n      'bg-red-600 text-white border-red-600',\r\n      'hover:bg-red-700 hover:border-red-700 hover:shadow-lg',\r\n      'hover:shadow-red-500/25',\r\n      'focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2',\r\n      'focus:bg-red-700',\r\n      'active:bg-red-800 active:transform active:scale-[0.98]',\r\n      'disabled:bg-gray-300 disabled:border-gray-300 disabled:text-gray-500'\r\n    ],\r\n    ghost: [\r\n      'bg-transparent text-gray-700 border-transparent',\r\n      'hover:bg-gray-100 hover:text-gray-900',\r\n      'focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2',\r\n      'focus:bg-gray-100',\r\n      'active:bg-gray-200 active:transform active:scale-[0.98]',\r\n      'disabled:text-gray-400'\r\n    ]\r\n  };\r\n\r\n  // サイズスタイル\r\n  const sizeStyles = {\r\n    sm: 'px-3 py-1.5 text-sm h-8 min-w-[2rem]',\r\n    md: 'px-4 py-2 text-base h-10 min-w-[2.5rem]',\r\n    lg: 'px-6 py-3 text-lg h-12 min-w-[3rem]'\r\n  };\r\n\r\n  // フィードバック強度スタイル\r\n  const intensityStyles = {\r\n    subtle: 'transition-all duration-100 ease-out',\r\n    normal: 'transition-all duration-150 ease-out',\r\n    strong: 'transition-all duration-200 ease-out'\r\n  };\r\n\r\n  // リップル効果の実装\r\n  const createRipple = (event: React.MouseEvent<HTMLButtonElement>) => {\r\n    if (!enableRipple || disabled) return;\r\n\r\n    const button = buttonRef.current;\r\n    if (!button) return;\r\n\r\n    const rect = button.getBoundingClientRect();\r\n    const x = event.clientX - rect.left;\r\n    const y = event.clientY - rect.top;\r\n\r\n    const rippleId = rippleIdCounter.current++;\r\n    setRipples(prev => [...prev, { id: rippleId, x, y }]);\r\n\r\n    // リップル削除タイマー\r\n    setTimeout(() => {\r\n      setRipples(prev => prev.filter(ripple => ripple.id !== rippleId));\r\n    }, 600);\r\n  };\r\n\r\n  // クリックハンドラー - TDD要件: 150ms以内反応\r\n  const handleClick = (event: React.MouseEvent<HTMLButtonElement>) => {\r\n    if (disabled || loading) return;\r\n\r\n    // 即座に視覚的フィードバック\r\n    setIsPressed(true);\r\n    createRipple(event);\r\n\r\n    // 短時間後にプレス状態解除\r\n    setTimeout(() => setIsPressed(false), 100);\r\n\r\n    // オリジナルのクリックハンドラー実行\r\n    onClick?.(event);\r\n  };\r\n\r\n  // キーボードハンドラー - TDD要件: アクセシビリティ\r\n  const handleKeyDown = (event: React.KeyboardEvent<HTMLButtonElement>) => {\r\n    if (disabled || loading) return;\r\n\r\n    if (event.key === 'Enter' || event.key === ' ') {\r\n      event.preventDefault();\r\n      setIsPressed(true);\r\n\r\n      // 合成マウスイベント作成してリップル効果\r\n      if (enableRipple && buttonRef.current) {\r\n        const rect = buttonRef.current.getBoundingClientRect();\r\n        const syntheticEvent = {\r\n          clientX: rect.left + rect.width / 2,\r\n          clientY: rect.top + rect.height / 2\r\n        } as React.MouseEvent<HTMLButtonElement>;\r\n        createRipple(syntheticEvent);\r\n      }\r\n\r\n      setTimeout(() => setIsPressed(false), 100);\r\n    }\r\n\r\n    onKeyDown?.(event);\r\n  };\r\n\r\n  // マウス/タッチイベント\r\n  const handleMouseDown = () => !disabled && !loading && setIsPressed(true);\r\n  const handleMouseUp = () => setIsPressed(false);\r\n  const handleMouseLeave = () => setIsPressed(false);\r\n\r\n  // 基本スタイル\r\n  const baseStyles = [\r\n    // レイアウト\r\n    'relative overflow-hidden inline-flex items-center justify-center',\r\n    'font-medium rounded-md border',\r\n    // インタラクション基盤 - TDD要件: カーソル、選択無効\r\n    'cursor-pointer select-none touch-manipulation',\r\n    // トランジション - TDD要件: スムーズな反応\r\n    intensityStyles[feedbackIntensity],\r\n    // プレス状態のスケール\r\n    isPressed && !disabled ? 'transform scale-[0.96]' : '',\r\n    // ロード状態\r\n    loading ? 'cursor-wait' : '',\r\n    // 無効状態\r\n    disabled ? 'cursor-not-allowed' : ''\r\n  ];\r\n\r\n  const buttonClasses = cn(\r\n    ...baseStyles,\r\n    ...(variantStyles[variant] || []),\r\n    sizeStyles[size],\r\n    className\r\n  );\r\n\r\n  return (\r\n    <button\r\n      ref={buttonRef}\r\n      type={type}\r\n      role={role}\r\n      disabled={disabled || loading}\r\n      aria-label={ariaLabel}\r\n      aria-describedby={ariaDescribedBy}\r\n      aria-pressed={isPressed}\r\n      aria-busy={loading}\r\n      className={buttonClasses}\r\n      onClick={handleClick}\r\n      onKeyDown={handleKeyDown}\r\n      onMouseDown={handleMouseDown}\r\n      onMouseUp={handleMouseUp}\r\n      onMouseLeave={handleMouseLeave}\r\n      onTouchStart={handleMouseDown}\r\n      onTouchEnd={handleMouseUp}\r\n      {...props}\r\n    >\r\n      {/* ロードスピナー */}\r\n      {loading && (\r\n        <div className=\"absolute inset-0 flex items-center justify-center\">\r\n          <div className=\"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin opacity-60\" />\r\n        </div>\r\n      )}\r\n\r\n      {/* コンテンツ */}\r\n      <div className={cn('flex items-center gap-2', loading && 'opacity-0')}>\r\n        {children}\r\n      </div>\r\n\r\n      {/* リップル効果 */}\r\n      {enableRipple && ripples.map(ripple => (\r\n        <span\r\n          key={ripple.id}\r\n          className=\"absolute pointer-events-none\"\r\n          style={{\r\n            left: ripple.x,\r\n            top: ripple.y,\r\n            transform: 'translate(-50%, -50%)'\r\n          }}\r\n        >\r\n          <span\r\n            className={cn(\r\n              'block w-0 h-0 rounded-full bg-current opacity-25',\r\n              'animate-ping'\r\n            )}\r\n            style={{\r\n              animation: 'ripple 0.6s ease-out forwards'\r\n            }}\r\n          />\r\n        </span>\r\n      ))}\r\n\r\n      {/* リップルアニメーション定義 */}\r\n      <style jsx>{`\r\n        @keyframes ripple {\r\n          0% {\r\n            width: 0;\r\n            height: 0;\r\n            opacity: 0.5;\r\n          }\r\n          50% {\r\n            opacity: 0.3;\r\n          }\r\n          100% {\r\n            width: 200px;\r\n            height: 200px;\r\n            opacity: 0;\r\n          }\r\n        }\r\n      `}</style>\r\n    </button>\r\n  );\r\n};\r\n\r\n/**\r\n * 事前定義されたボタンバリアント\r\n */\r\nexport const PrimaryButton: React.FC<Omit<InteractiveButtonProps, 'variant'>> = (props) => (\r\n  <InteractiveButton variant=\"primary\" {...props} />\r\n);\r\n\r\nexport const SecondaryButton: React.FC<Omit<InteractiveButtonProps, 'variant'>> = (props) => (\r\n  <InteractiveButton variant=\"secondary\" {...props} />\r\n);\r\n\r\nexport const DangerButton: React.FC<Omit<InteractiveButtonProps, 'variant'>> = (props) => (\r\n  <InteractiveButton variant=\"danger\" {...props} />\r\n);\r\n\r\nexport const GhostButton: React.FC<Omit<InteractiveButtonProps, 'variant'>> = (props) => (\r\n  <InteractiveButton variant=\"ghost\" {...props} />\r\n);\r\n\r\nexport default InteractiveButton;","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\LoadingSkeletons.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\NavigationBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\ScreenIdDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\TabInterface.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\ThemeToggle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\UnifiedAIFloatingButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\ValidatedForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\VoiceInput.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\__tests__\\Card.test.tsx","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').","line":7,"column":1,"severity":1,"nodeType":null,"fix":{"range":[99,154],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-unsafe-assignment').","line":8,"column":1,"severity":1,"nodeType":null,"fix":{"range":[156,216],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-unsafe-member-access').","line":9,"column":1,"severity":1,"nodeType":null,"fix":{"range":[218,281],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-unsafe-call').","line":10,"column":1,"severity":1,"nodeType":null,"fix":{"range":[283,337],"text":" "}}],"suppressedMessages":[{"ruleId":"no-undef","severity":2,"message":"'describe' is not defined.","line":16,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":16,"endColumn":9,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'it' is not defined.","line":17,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":17,"endColumn":5,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":29,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":29,"endColumn":11,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":30,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":30,"endColumn":11,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'it' is not defined.","line":33,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":33,"endColumn":5,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":41,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":41,"endColumn":11,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":42,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":42,"endColumn":11,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'it' is not defined.","line":45,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":45,"endColumn":5,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":58,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":58,"endColumn":11,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":59,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":59,"endColumn":11,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":60,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":60,"endColumn":11,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'describe' is not defined.","line":64,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":64,"endColumn":9,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'it' is not defined.","line":65,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":65,"endColumn":5,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":73,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":73,"endColumn":11,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'describe' is not defined.","line":77,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":77,"endColumn":9,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'it' is not defined.","line":78,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":78,"endColumn":5,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":82,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":82,"endColumn":11,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":83,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":83,"endColumn":11,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'describe' is not defined.","line":87,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":87,"endColumn":9,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'it' is not defined.","line":88,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":88,"endColumn":5,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":92,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":92,"endColumn":11,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":93,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":93,"endColumn":11,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":4,"source":"/**\r\n * Card コンポーネントのユニットテスト\r\n * TDD完了フェーズ - 基本的なコンポーネントテスト\r\n */\r\n\r\n/* eslint-disable no-undef */\r\n/* eslint-disable @typescript-eslint/no-explicit-any */\r\n/* eslint-disable @typescript-eslint/no-unsafe-assignment */\r\n/* eslint-disable @typescript-eslint/no-unsafe-member-access */\r\n/* eslint-disable @typescript-eslint/no-unsafe-call */\r\n\r\nimport { render, screen } from '@testing-library/react'\r\nimport '@testing-library/jest-dom'\r\nimport { Card, CardHeader, CardTitle, CardContent } from '../Card'\r\n\r\ndescribe('Card', () => {\r\n  it('基本的なレンダリングができる', () => {\r\n    render(\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>テストタイトル</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          テストコンテンツ\r\n        </CardContent>\r\n      </Card>\r\n    )\r\n\r\n    expect(screen.getByText('テストタイトル')).toBeInTheDocument()\r\n    expect(screen.getByText('テストコンテンツ')).toBeInTheDocument()\r\n  })\r\n\r\n  it('カスタムclassNameが適用される', () => {\r\n    render(\r\n      <Card className=\"test-class\">\r\n        <CardContent>テスト</CardContent>\r\n      </Card>\r\n    )\r\n\r\n    const card = screen.getByText('テスト').closest('div')?.parentElement\r\n    expect(card).toHaveClass('test-class')\r\n    expect(card).toHaveClass('rounded-lg')\r\n  })\r\n\r\n  it('子要素が正しく表示される', () => {\r\n    render(\r\n      <Card>\r\n        <CardHeader>\r\n          <CardTitle>タイトル</CardTitle>\r\n        </CardHeader>\r\n        <CardContent>\r\n          <p>段落1</p>\r\n          <p>段落2</p>\r\n        </CardContent>\r\n      </Card>\r\n    )\r\n\r\n    expect(screen.getByRole('heading', { name: 'タイトル' })).toBeInTheDocument()\r\n    expect(screen.getByText('段落1')).toBeInTheDocument()\r\n    expect(screen.getByText('段落2')).toBeInTheDocument()\r\n  })\r\n})\r\n\r\ndescribe('CardHeader', () => {\r\n  it('ヘッダー要素として正しくレンダリングされる', () => {\r\n    render(\r\n      <CardHeader>\r\n        <CardTitle>ヘッダータイトル</CardTitle>\r\n      </CardHeader>\r\n    )\r\n\r\n    const header = screen.getByText('ヘッダータイトル').closest('div')\r\n    expect(header).toHaveClass('px-6', 'py-4', 'border-b', 'border-gray-200')\r\n  })\r\n})\r\n\r\ndescribe('CardTitle', () => {\r\n  it('h3要素として正しくレンダリングされる', () => {\r\n    render(<CardTitle>タイトルテスト</CardTitle>)\r\n\r\n    const title = screen.getByRole('heading', { level: 3 })\r\n    expect(title).toBeInTheDocument()\r\n    expect(title).toHaveTextContent('タイトルテスト')\r\n  })\r\n})\r\n\r\ndescribe('CardContent', () => {\r\n  it('コンテンツ要素として正しくレンダリングされる', () => {\r\n    render(<CardContent>コンテンツテスト</CardContent>)\r\n\r\n    const content = screen.getByText('コンテンツテスト')\r\n    expect(content).toBeInTheDocument()\r\n    expect(content.closest('div')).toHaveClass('px-6', 'py-4')\r\n  })\r\n})","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\components\\ui\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\contexts\\AppContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\contexts\\AuthContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\contexts\\ThemeContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\data\\defaultEvaluationData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\data\\evaluationMatrices.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\data\\evaluationStandards.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\hooks\\__tests__\\useBackButton.test.ts","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').","line":2,"column":1,"severity":1,"nodeType":null,"fix":{"range":[31,86],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-unsafe-assignment').","line":3,"column":1,"severity":1,"nodeType":null,"fix":{"range":[88,148],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-unsafe-member-access').","line":4,"column":1,"severity":1,"nodeType":null,"fix":{"range":[150,213],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-unsafe-call').","line":5,"column":1,"severity":1,"nodeType":null,"fix":{"range":[215,269],"text":" "}},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-unsafe-return').","line":6,"column":1,"severity":1,"nodeType":null,"fix":{"range":[271,327],"text":" "}}],"suppressedMessages":[{"ruleId":"no-undef","severity":2,"message":"'jest' is not defined.","line":12,"column":18,"nodeType":"Identifier","messageId":"undef","endLine":12,"endColumn":22,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'jest' is not defined.","line":13,"column":18,"nodeType":"Identifier","messageId":"undef","endLine":13,"endColumn":22,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'jest' is not defined.","line":14,"column":21,"nodeType":"Identifier","messageId":"undef","endLine":14,"endColumn":25,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'jest' is not defined.","line":16,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":16,"endColumn":5,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'jest' is not defined.","line":27,"column":21,"nodeType":"Identifier","messageId":"undef","endLine":27,"endColumn":25,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'describe' is not defined.","line":33,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":33,"endColumn":9,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'beforeEach' is not defined.","line":34,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":34,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'jest' is not defined.","line":35,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":35,"endColumn":9,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'describe' is not defined.","line":39,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":39,"endColumn":11,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'it' is not defined.","line":40,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":40,"endColumn":7,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":59,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":59,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":60,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":60,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":61,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":61,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'it' is not defined.","line":64,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":64,"endColumn":7,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":77,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":77,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'it' is not defined.","line":80,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":80,"endColumn":7,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":90,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":90,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'describe' is not defined.","line":95,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":95,"endColumn":9,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'beforeEach' is not defined.","line":96,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":96,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'jest' is not defined.","line":97,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":97,"endColumn":9,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'describe' is not defined.","line":101,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":101,"endColumn":11,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'it' is not defined.","line":102,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":102,"endColumn":7,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":106,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":106,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":107,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":107,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":108,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":108,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'it' is not defined.","line":111,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":111,"endColumn":7,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":119,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":119,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'it' is not defined.","line":122,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":122,"endColumn":7,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":130,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":130,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'it' is not defined.","line":133,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":133,"endColumn":7,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":144,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":144,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-undef","severity":2,"message":"'expect' is not defined.","line":145,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":145,"endColumn":13,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":5,"source":"/* eslint-disable no-undef */\r\n/* eslint-disable @typescript-eslint/no-explicit-any */\r\n/* eslint-disable @typescript-eslint/no-unsafe-assignment */\r\n/* eslint-disable @typescript-eslint/no-unsafe-member-access */\r\n/* eslint-disable @typescript-eslint/no-unsafe-call */\r\n/* eslint-disable @typescript-eslint/no-unsafe-return */\r\n\r\nimport { renderHook, act } from '@testing-library/react'\r\nimport { useBackButton, useEvaluationNavigation } from '../useBackButton'\r\n\r\n// Mock Next.js router\r\nconst mockPush = jest.fn()\r\nconst mockBack = jest.fn()\r\nconst mockReplace = jest.fn()\r\n\r\njest.mock('next/navigation', () => ({\r\n  useRouter: () => ({\r\n    push: mockPush,\r\n    back: mockBack,\r\n    replace: mockReplace,\r\n    pathname: '/evaluation/physical',\r\n  }),\r\n  usePathname: () => '/evaluation/physical',\r\n}))\r\n\r\n// Mock window.confirm\r\nconst mockConfirm = jest.fn()\r\nObject.defineProperty(window, 'confirm', {\r\n  value: mockConfirm,\r\n  writable: true,\r\n})\r\n\r\ndescribe('useBackButton', () => {\r\n  beforeEach(() => {\r\n    jest.clearAllMocks()\r\n    mockConfirm.mockReturnValue(true)\r\n  })\r\n\r\n  describe('🔴 RED: 失敗するテストケース', () => {\r\n    it('should navigate back with fallback when browser history is empty', () => {\r\n      // history.lengthを1に設定してフォールバック動作をテスト\r\n      Object.defineProperty(window, 'history', {\r\n        value: { length: 1 },\r\n        writable: true,\r\n      })\r\n\r\n      const { result } = renderHook(() =>\r\n        useBackButton({\r\n          fallbackPath: '/dashboard',\r\n          confirmMessage: 'データが保存されていません。このページを離れますか？'\r\n        })\r\n      )\r\n\r\n      act(() => {\r\n        result.current.goBack()\r\n      })\r\n\r\n      // 履歴が1の場合はフォールバックパスに遷移する\r\n      expect(mockConfirm).toHaveBeenCalledWith('データが保存されていません。このページを離れますか？')\r\n      expect(mockPush).toHaveBeenCalledWith('/dashboard')\r\n      expect(mockBack).not.toHaveBeenCalled()\r\n    })\r\n\r\n    it('should show confirmation dialog when hasUnsavedChanges is true', () => {\r\n      const { result } = renderHook(() =>\r\n        useBackButton({\r\n          confirmMessage: 'データが保存されていません。このページを離れますか？',\r\n          hasUnsavedChanges: true\r\n        })\r\n      )\r\n\r\n      act(() => {\r\n        result.current.goBack()\r\n      })\r\n\r\n      // この時点では実装されていないため失敗する\r\n      expect(mockConfirm).toHaveBeenCalledWith('データが保存されていません。このページを離れますか？')\r\n    })\r\n\r\n    it('should navigate to specific path when goToPath is called', () => {\r\n      const { result } = renderHook(() =>\r\n        useBackButton({ fallbackPath: '/dashboard' })\r\n      )\r\n\r\n      act(() => {\r\n        result.current.goToPath('/evaluation/mental')\r\n      })\r\n\r\n      // この時点では実装されていないため失敗する\r\n      expect(mockPush).toHaveBeenCalledWith('/evaluation/mental')\r\n    })\r\n  })\r\n})\r\n\r\ndescribe('useEvaluationNavigation', () => {\r\n  beforeEach(() => {\r\n    jest.clearAllMocks()\r\n    mockConfirm.mockReturnValue(true)\r\n  })\r\n\r\n  describe('🔴 RED: 失敗するテストケース', () => {\r\n    it('should provide navigation functions for evaluation pages', () => {\r\n      const { result } = renderHook(() => useEvaluationNavigation())\r\n\r\n      // この時点では実装されていないため失敗する\r\n      expect(result.current.goBack).toBeDefined()\r\n      expect(result.current.goToDashboard).toBeDefined()\r\n      expect(result.current.goToHome).toBeDefined()\r\n    })\r\n\r\n    it('should navigate to dashboard when goToDashboard is called', () => {\r\n      const { result } = renderHook(() => useEvaluationNavigation())\r\n\r\n      act(() => {\r\n        result.current.goToDashboard()\r\n      })\r\n\r\n      // この時点では実装されていないため失敗する\r\n      expect(mockPush).toHaveBeenCalledWith('/dashboard')\r\n    })\r\n\r\n    it('should navigate to home when goToHome is called', () => {\r\n      const { result } = renderHook(() => useEvaluationNavigation())\r\n\r\n      act(() => {\r\n        result.current.goToHome()\r\n      })\r\n\r\n      // この時点では実装されていないため失敗する\r\n      expect(mockPush).toHaveBeenCalledWith('/')\r\n    })\r\n\r\n    it('should handle unsaved changes confirmation for dashboard navigation', () => {\r\n      const { result } = renderHook(() => useEvaluationNavigation(true)) // hasUnsavedChanges = true\r\n\r\n      // 未保存の変更がある状態をシミュレート\r\n      mockConfirm.mockReturnValue(false) // ユーザーがキャンセルした場合\r\n\r\n      act(() => {\r\n        result.current.goToDashboard()\r\n      })\r\n\r\n      // 確認ダイアログが表示され、キャンセルした場合は遷移しない\r\n      expect(mockConfirm).toHaveBeenCalledWith('編集中のデータは保存されていません。ダッシュボードに移動しますか？')\r\n      expect(mockPush).not.toHaveBeenCalled()\r\n    })\r\n  })\r\n})","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\hooks\\useAutoSave.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\hooks\\useBackButton.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\hooks\\useDatabase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\hooks\\useEvaluation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\hooks\\useEvaluationData.ts","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadEvaluations'. Either include it or remove the dependency array.","line":119,"column":6,"nodeType":"ArrayExpression","endLine":119,"endColumn":16,"suggestions":[{"desc":"Update the dependencies array to be: [loadEvaluations, user.id]","fix":{"range":[3260,3270],"text":"[loadEvaluations, user.id]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\hooks\\useEvaluationStore.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\hooks\\useNavigation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\hooks\\useStorage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\aiAssistant.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-empty-function","severity":1,"message":"Unexpected empty constructor.","line":97,"column":25,"nodeType":"FunctionExpression","messageId":"unexpected","endLine":97,"endColumn":27,"suggestions":[{"messageId":"suggestComment","data":{"name":"constructor"},"fix":{"range":[3256,3256],"text":" /* empty */ "},"desc":"Add comment inside empty constructor."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\aiImageAnalysis.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\api.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-empty-function","severity":1,"message":"Unexpected empty constructor.","line":15,"column":25,"nodeType":"FunctionExpression","messageId":"unexpected","endLine":15,"endColumn":27,"suggestions":[{"messageId":"suggestComment","data":{"name":"constructor"},"fix":{"range":[399,399],"text":" /* empty */ "},"desc":"Add comment inside empty constructor."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\calculation.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'_error' is defined but never used.","line":154,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":154,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":251,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":251,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":404,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":404,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'error' is defined but never used.","line":521,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":521,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * スコア計算エンジン\r\n * 3K指数評価アプリの各因子スコア計算と最終3K指数算出を担当\r\n */\r\n\r\nimport type { EvaluationStandardsService } from './standards';\r\nimport { standardsService } from './standards';\r\nimport type { \r\n  MatrixCalculator,\r\n  MentalMatrixInput,\r\n  HazardMatrixInput \r\n} from './matrixCalculator';\r\nimport {\r\n  matrixCalculator\r\n} from './matrixCalculator';\r\nimport type {\r\n  PhysicalDetails, MentalDetails, EnvironmentalDetails, HazardDetails,\r\n  Posture, EnvironmentalSubstance} from '../types/evaluation';\r\n\r\nexport interface ScoreCalculationResult {\r\n  score: number;\r\n  details: Record<string, unknown>;\r\n  factors?: Record<string, number>;\r\n}\r\n\r\nexport interface FinalScoreResult {\r\n  physicalScore: number;\r\n  mentalScore: number;\r\n  environmentalScore: number;\r\n  hazardScore: number;\r\n  workTimeScore: number;\r\n  final3KIndex: string;\r\n  finalKitsusaScore: number;\r\n  calculationDetails: Record<string, unknown>;\r\n}\r\n\r\nexport class ScoreCalculationEngine {\r\n  private static instance: ScoreCalculationEngine;\r\n  private standardsService: EvaluationStandardsService;\r\n  private matrixCalculator: MatrixCalculator;\r\n\r\n  private constructor() {\r\n    this.standardsService = standardsService;\r\n    this.matrixCalculator = matrixCalculator;\r\n  }\r\n\r\n  public static getInstance(): ScoreCalculationEngine {\r\n    if (!ScoreCalculationEngine.instance) {\r\n      ScoreCalculationEngine.instance = new ScoreCalculationEngine();\r\n    }\r\n    return ScoreCalculationEngine.instance;\r\n  }\r\n\r\n  /**\r\n   * 肉体因スコアを計算（マトリックス対応版）\r\n   */\r\n  public calculatePhysicalScore(\r\n    details: PhysicalDetails, \r\n    postures: Posture[] = [],\r\n    workTimeFactor: number = 1.0,\r\n    useMatrixCalculation: boolean = true\r\n  ): ScoreCalculationResult {\r\n    let totalScore = 1;\r\n    const factors: Record<string, number> = {};\r\n    const calculationDetails: Record<string, unknown> = {};\r\n\r\n    // 重量取扱いスコア計算\r\n    if (details.targetWeight) {\r\n      let weightScore = 1;\r\n      \r\n      if (details.targetWeight.bothHands && details.checkboxes?.weightBoth) {\r\n        const bothHandsScore = this.standardsService.calculateWeightScore(\r\n          details.targetWeight.bothHands.kg,\r\n          'both_hands',\r\n          'moderate_work', // デフォルト値\r\n          'occasional',    // デフォルト値\r\n          'good'          // デフォルト値\r\n        );\r\n        weightScore = Math.max(weightScore, bothHandsScore);\r\n      }\r\n\r\n      if (details.targetWeight.singleHand && details.checkboxes?.weightSingle) {\r\n        const singleHandScore = this.standardsService.calculateWeightScore(\r\n          details.targetWeight.singleHand.kg,\r\n          'single_hand',\r\n          'moderate_work',\r\n          'occasional',\r\n          'good'\r\n        );\r\n        weightScore = Math.max(weightScore, singleHandScore);\r\n      }\r\n\r\n      factors.weight = weightScore;\r\n      calculationDetails.weightCalculation = {\r\n        bothHands: details.targetWeight.bothHands,\r\n        singleHand: details.targetWeight.singleHand,\r\n        score: weightScore\r\n      };\r\n    }\r\n\r\n    // 筋力スコア計算\r\n    if (details.muscleForce && details.checkboxes?.muscle) {\r\n      const muscleScore = this.calculateMuscleForceScore(details.muscleForce.kg);\r\n      factors.muscle = muscleScore;\r\n      calculationDetails.muscleCalculation = {\r\n        force: details.muscleForce.kg,\r\n        score: muscleScore\r\n      };\r\n    }\r\n\r\n    // 保護具スコア計算\r\n    if (details.protectiveGear && details.checkboxes?.gear) {\r\n      const gearScore = this.calculateProtectiveGearScore(details.protectiveGear.percentage);\r\n      factors.gear = gearScore;\r\n      calculationDetails.gearCalculation = {\r\n        percentage: details.protectiveGear.percentage,\r\n        score: gearScore\r\n      };\r\n    }\r\n\r\n    // 目の疲労スコア計算\r\n    if (details.eyeStrain && details.checkboxes?.eye) {\r\n      const eyeScore = this.calculateEyeStrainScore(details.eyeStrain.percentage);\r\n      factors.eye = eyeScore;\r\n      calculationDetails.eyeCalculation = {\r\n        percentage: details.eyeStrain.percentage,\r\n        score: eyeScore\r\n      };\r\n    }\r\n\r\n    // 姿勢評価スコア計算（マトリックス対応）\r\n    if (postures.length > 0) {\r\n      const postureScores = postures.map(posture => {\r\n        let postureScore: number;\r\n        let calculationMethod: string;\r\n        \r\n        if (useMatrixCalculation && details.manualInput) {\r\n          // マトリックス計算を使用\r\n          try {\r\n            const strengthLevel = this.parseStrengthLevel(details.manualInput.strength);\r\n            const durationPercentage = this.parseDurationPercentage(details.manualInput.duration);\r\n            \r\n            const matrixInput = this.matrixCalculator.convertPostureToMatrixInput(\r\n              posture.rulaScore,\r\n              posture.owasCategory,\r\n              durationPercentage,\r\n              strengthLevel\r\n            );\r\n            \r\n            const matrixResult = this.matrixCalculator.calculatePhysicalMatrix(matrixInput);\r\n            postureScore = matrixResult.score;\r\n            calculationMethod = 'matrix';\r\n            \r\n          } catch (_error) {\r\n            // マトリックス計算に失敗した場合は従来の方法にフォールバック\r\n            const rulaEval = this.standardsService.getRulaEvaluation(posture.rulaScore);\r\n            const owasEval = this.standardsService.getOwasEvaluation(posture.owasCategory);\r\n            postureScore = Math.max(rulaEval.score, owasEval.score);\r\n            calculationMethod = 'traditional';\r\n          }\r\n        } else {\r\n          // 従来の計算方法\r\n          const rulaEval = this.standardsService.getRulaEvaluation(posture.rulaScore);\r\n          const owasEval = this.standardsService.getOwasEvaluation(posture.owasCategory);\r\n          postureScore = Math.max(rulaEval.score, owasEval.score);\r\n          calculationMethod = 'traditional';\r\n        }\r\n        \r\n        return {\r\n          postureName: posture.postureName,\r\n          rulaScore: posture.rulaScore,\r\n          owasCategory: posture.owasCategory,\r\n          finalScore: postureScore,\r\n          calculationMethod\r\n        };\r\n      });\r\n\r\n      const maxPostureScore = Math.max(...postureScores.map(p => p.finalScore));\r\n      factors.posture = maxPostureScore;\r\n      calculationDetails.postureCalculation = {\r\n        postures: postureScores,\r\n        maxScore: maxPostureScore,\r\n        matrixUsed: useMatrixCalculation\r\n      };\r\n    }\r\n\r\n    // 手動入力による強度・持続時間の考慮\r\n    if (details.manualInput) {\r\n      const manualScore = this.calculateManualInputScore(\r\n        details.manualInput.strength,\r\n        details.manualInput.duration\r\n      );\r\n      factors.manualInput = manualScore;\r\n      calculationDetails.manualInputCalculation = {\r\n        strength: details.manualInput.strength,\r\n        duration: details.manualInput.duration,\r\n        score: manualScore\r\n      };\r\n    }\r\n\r\n    // 最大値を基本スコアとして採用\r\n    const factorScores = Object.values(factors);\r\n    const baseScore = factorScores.length > 0 ? Math.max(...factorScores) : 1;\r\n\r\n    // 作業時間ファクターを適用\r\n    totalScore = Math.ceil(baseScore * workTimeFactor);\r\n    totalScore = Math.min(totalScore, 10); // 最大値は10\r\n\r\n    return {\r\n      score: totalScore,\r\n      details: calculationDetails,\r\n      factors\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 精神因スコアを計算（マトリックス対応版）\r\n   */\r\n  public calculateMentalScore(\r\n    details: MentalDetails, \r\n    workTimeFactor: number = 1.0,\r\n    useMatrixCalculation: boolean = true\r\n  ): ScoreCalculationResult {\r\n    let totalScore = 1;\r\n    const factors: Record<string, number> = {};\r\n    const calculationDetails: Record<string, unknown> = {};\r\n\r\n    if (details.workQuality) {\r\n      const workQuality = details.workQuality;\r\n\r\n      // 失敗リスクスコア（マトリックス対応）\r\n      if (workQuality.failure) {\r\n        let failureScore: number;\r\n        let calculationMethod: string;\r\n        \r\n        if (useMatrixCalculation) {\r\n          try {\r\n            const failureFrequency = this.parseFailureLevel(workQuality.failure.level);\r\n            const durationLevel = this.parseMentalDurationLevel(workQuality.failure.duration);\r\n            const impactLevel = this.parseImpactLevel('中程度'); // デフォルト値、実際は詳細データから取得\r\n            \r\n            const matrixInput: MentalMatrixInput = {\r\n              failureFrequency,\r\n              durationLevel,\r\n              impactLevel\r\n            };\r\n            \r\n            const matrixResult = this.matrixCalculator.calculateMentalMatrix(matrixInput);\r\n            failureScore = matrixResult.score;\r\n            calculationMethod = 'matrix';\r\n          } catch (error) {\r\n            failureScore = this.calculateFailureScore(\r\n              workQuality.failure.level,\r\n              workQuality.failure.duration\r\n            );\r\n            calculationMethod = 'traditional';\r\n          }\r\n        } else {\r\n          failureScore = this.calculateFailureScore(\r\n            workQuality.failure.level,\r\n            workQuality.failure.duration\r\n          );\r\n          calculationMethod = 'traditional';\r\n        }\r\n        \r\n        factors.failure = failureScore;\r\n        calculationDetails.failureCalculation = {\r\n          level: workQuality.failure.level,\r\n          duration: workQuality.failure.duration,\r\n          score: failureScore,\r\n          calculationMethod\r\n        };\r\n      }\r\n\r\n      // 集中力スコア\r\n      if (workQuality.concentration) {\r\n        const concentrationScore = this.calculateConcentrationScore(\r\n          workQuality.concentration.level,\r\n          workQuality.concentration.duration\r\n        );\r\n        factors.concentration = concentrationScore;\r\n        calculationDetails.concentrationCalculation = {\r\n          level: workQuality.concentration.level,\r\n          duration: workQuality.concentration.duration,\r\n          score: concentrationScore\r\n        };\r\n      }\r\n\r\n      // 認知負荷スコア\r\n      if (workQuality.cognitiveLoad) {\r\n        const cognitiveScore = this.calculateCognitiveLoadScore(\r\n          workQuality.cognitiveLoad.level,\r\n          workQuality.cognitiveLoad.duration\r\n        );\r\n        factors.cognitive = cognitiveScore;\r\n        calculationDetails.cognitiveCalculation = {\r\n          level: workQuality.cognitiveLoad.level,\r\n          duration: workQuality.cognitiveLoad.duration,\r\n          score: cognitiveScore\r\n        };\r\n      }\r\n\r\n      // 感情負担スコア\r\n      if (workQuality.emotionalBurden) {\r\n        const emotionalScore = this.calculateEmotionalBurdenScore(\r\n          workQuality.emotionalBurden.level,\r\n          workQuality.emotionalBurden.duration\r\n        );\r\n        factors.emotional = emotionalScore;\r\n        calculationDetails.emotionalCalculation = {\r\n          level: workQuality.emotionalBurden.level,\r\n          duration: workQuality.emotionalBurden.duration,\r\n          score: emotionalScore\r\n        };\r\n      }\r\n\r\n      // 技能活用度スコア\r\n      if (workQuality.skillUtilization) {\r\n        const skillScore = this.calculateSkillUtilizationScore(\r\n          workQuality.skillUtilization.level,\r\n          workQuality.skillUtilization.duration\r\n        );\r\n        factors.skill = skillScore;\r\n        calculationDetails.skillCalculation = {\r\n          level: workQuality.skillUtilization.level,\r\n          duration: workQuality.skillUtilization.duration,\r\n          score: skillScore\r\n        };\r\n      }\r\n\r\n      // 作業統制度スコア\r\n      if (workQuality.workControl) {\r\n        const controlScore = this.calculateWorkControlScore(\r\n          workQuality.workControl.level,\r\n          workQuality.workControl.duration\r\n        );\r\n        factors.control = controlScore;\r\n        calculationDetails.controlCalculation = {\r\n          level: workQuality.workControl.level,\r\n          duration: workQuality.workControl.duration,\r\n          score: controlScore\r\n        };\r\n      }\r\n    }\r\n\r\n    // 手動入力スコア\r\n    if (details.manualInput) {\r\n      const manualScore = this.calculateManualInputScore(\r\n        details.manualInput.strength,\r\n        details.manualInput.duration\r\n      );\r\n      factors.manualInput = manualScore;\r\n      calculationDetails.manualInputCalculation = {\r\n        strength: details.manualInput.strength,\r\n        duration: details.manualInput.duration,\r\n        score: manualScore\r\n      };\r\n    }\r\n\r\n    // 最大値を基本スコアとして採用\r\n    const factorScores = Object.values(factors);\r\n    const baseScore = factorScores.length > 0 ? Math.max(...factorScores) : 1;\r\n\r\n    // 作業時間ファクターを適用\r\n    totalScore = Math.ceil(baseScore * workTimeFactor);\r\n    totalScore = Math.min(totalScore, 10);\r\n\r\n    return {\r\n      score: totalScore,\r\n      details: calculationDetails,\r\n      factors\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 環境因スコアを計算（マトリックス対応版）\r\n   */\r\n  public calculateEnvironmentalScore(\r\n    details: EnvironmentalDetails,\r\n    substances: EnvironmentalSubstance[] = [],\r\n    useMatrixCalculation: boolean = true\r\n  ): ScoreCalculationResult {\r\n    let totalScore = 1;\r\n    const factors: Record<string, number> = {};\r\n    const calculationDetails: Record<string, unknown> = {};\r\n\r\n    // 化学物質スコア計算（マトリックス対応）\r\n    if (substances.length > 0) {\r\n      const substanceScores = substances.map(substance => {\r\n        let score: number;\r\n        let calculationMethod: string;\r\n        \r\n        if (useMatrixCalculation) {\r\n          try {\r\n            const matrixInput = this.matrixCalculator.convertConcentrationToMatrixInput(\r\n              substance.measuredValue,\r\n              substance.permissibleConcentration,\r\n              8 // デフォルト8時間、実際は詳細データから取得\r\n            );\r\n            \r\n            const matrixResult = this.matrixCalculator.calculateEnvironmentalMatrix(matrixInput);\r\n            score = matrixResult.score;\r\n            calculationMethod = 'matrix';\r\n          } catch (error) {\r\n            score = this.standardsService.calculateChemicalScore(\r\n              substance.substanceName,\r\n              substance.measuredValue\r\n            );\r\n            calculationMethod = 'traditional';\r\n          }\r\n        } else {\r\n          score = this.standardsService.calculateChemicalScore(\r\n            substance.substanceName,\r\n            substance.measuredValue\r\n          );\r\n          calculationMethod = 'traditional';\r\n        }\r\n        \r\n        return {\r\n          substanceName: substance.substanceName,\r\n          measuredValue: substance.measuredValue,\r\n          thresholdValue: substance.thresholdValue,\r\n          score: score,\r\n          calculationMethod\r\n        };\r\n      });\r\n\r\n      const maxSubstanceScore = Math.max(...substanceScores.map(s => s.score));\r\n      factors.substances = maxSubstanceScore;\r\n      calculationDetails.substancesCalculation = {\r\n        substances: substanceScores,\r\n        maxScore: maxSubstanceScore,\r\n        matrixUsed: useMatrixCalculation\r\n      };\r\n    }\r\n\r\n    // 温度スコア計算\r\n    if (details.temperature !== undefined) {\r\n      const tempScore = this.calculateTemperatureScore(details.temperature);\r\n      factors.temperature = tempScore;\r\n      calculationDetails.temperatureCalculation = {\r\n        temperature: details.temperature,\r\n        score: tempScore\r\n      };\r\n    }\r\n\r\n    // 騒音スコア計算\r\n    if (details.noise !== undefined) {\r\n      const noiseScore = this.standardsService.calculateNoiseScore(details.noise, 'continuous');\r\n      factors.noise = noiseScore;\r\n      calculationDetails.noiseCalculation = {\r\n        noise: details.noise,\r\n        score: noiseScore\r\n      };\r\n    }\r\n\r\n    // 粉じんスコア計算\r\n    if (details.dust !== undefined) {\r\n      const dustScore = this.standardsService.calculateDustScore(details.dust);\r\n      factors.dust = dustScore;\r\n      calculationDetails.dustCalculation = {\r\n        dust: details.dust,\r\n        score: dustScore\r\n      };\r\n    }\r\n\r\n    // 振動スコア計算\r\n    if (details.vibration !== undefined) {\r\n      const vibrationScore = this.standardsService.calculateVibrationScore(details.vibration, 'whole_body');\r\n      factors.vibration = vibrationScore;\r\n      calculationDetails.vibrationCalculation = {\r\n        vibration: details.vibration,\r\n        score: vibrationScore\r\n      };\r\n    }\r\n\r\n    // 汚染レベルスコア計算\r\n    if (details.contamination !== undefined) {\r\n      const contaminationScore = this.standardsService.getContaminationScore(details.contamination);\r\n      factors.contamination = contaminationScore;\r\n      calculationDetails.contaminationCalculation = {\r\n        level: details.contamination,\r\n        score: contaminationScore\r\n      };\r\n    }\r\n\r\n    // 最大値を採用\r\n    const factorScores = Object.values(factors);\r\n    totalScore = factorScores.length > 0 ? Math.max(...factorScores) : 1;\r\n\r\n    return {\r\n      score: totalScore,\r\n      details: calculationDetails,\r\n      factors\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 危険因スコアを計算（マトリックス対応版）\r\n   */\r\n  public calculateHazardScore(details: HazardDetails, useMatrixCalculation: boolean = true): ScoreCalculationResult {\r\n    let totalScore = 1;\r\n    const factors: Record<string, number> = {};\r\n    const calculationDetails: Record<string, unknown> = {};\r\n\r\n    if (details.hazardEvents && details.hazardEvents.length > 0) {\r\n      const hazardScores = details.hazardEvents.map(event => {\r\n        let riskScore: number;\r\n        let calculationMethod: string;\r\n        \r\n        if (useMatrixCalculation) {\r\n          try {\r\n            const matrixInput: HazardMatrixInput = {\r\n              frequency: event.occurrencePossibility as 1 | 2 | 3 | 4 | 5,\r\n              severity: event.harmSeverity as 1 | 2 | 3 | 4 | 5\r\n            };\r\n            \r\n            const matrixResult = this.matrixCalculator.calculateHazardMatrix(matrixInput);\r\n            riskScore = matrixResult.score;\r\n            calculationMethod = 'matrix';\r\n          } catch (error) {\r\n            riskScore = this.standardsService.calculateRiskScore(\r\n              event.encounterFrequency,\r\n              event.dangerPossibility,\r\n              event.occurrencePossibility,\r\n              event.harmSeverity\r\n            );\r\n            calculationMethod = 'traditional';\r\n          }\r\n        } else {\r\n          riskScore = this.standardsService.calculateRiskScore(\r\n            event.encounterFrequency,\r\n            event.dangerPossibility,\r\n            event.occurrencePossibility,\r\n            event.harmSeverity\r\n          );\r\n          calculationMethod = 'traditional';\r\n        }\r\n\r\n        return {\r\n          hazardEvent: event.hazardEvent,\r\n          encounterFrequency: event.encounterFrequency,\r\n          dangerPossibility: event.dangerPossibility,\r\n          occurrencePossibility: event.occurrencePossibility,\r\n          harmSeverity: event.harmSeverity,\r\n          riskScore: riskScore,\r\n          calculationMethod\r\n        };\r\n      });\r\n\r\n      const maxHazardScore = Math.max(...hazardScores.map(h => h.riskScore));\r\n      factors.hazard = maxHazardScore;\r\n      totalScore = maxHazardScore;\r\n\r\n      calculationDetails.hazardCalculation = {\r\n        events: hazardScores,\r\n        maxScore: maxHazardScore,\r\n        matrixUsed: useMatrixCalculation\r\n      };\r\n    }\r\n\r\n    return {\r\n      score: totalScore,\r\n      details: calculationDetails,\r\n      factors\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 最終3K指数を計算\r\n   */\r\n  public calculateFinal3KIndex(\r\n    physicalScore: number,\r\n    mentalScore: number,\r\n    environmentalScore: number,\r\n    hazardScore: number,\r\n    workTimeFactor: number = 1.0\r\n  ): FinalScoreResult {\r\n    // 各因子スコアに作業時間ファクターを適用\r\n    const adjustedPhysicalScore = Math.min(Math.ceil(physicalScore * workTimeFactor), 10);\r\n    const adjustedMentalScore = Math.min(Math.ceil(mentalScore * workTimeFactor), 10);\r\n    const adjustedEnvironmentalScore = Math.min(Math.ceil(environmentalScore * workTimeFactor), 10);\r\n    const adjustedHazardScore = Math.min(Math.ceil(hazardScore * workTimeFactor), 10);\r\n\r\n    // 最終キツさスコア（最大値を採用）\r\n    const finalKitsusaScore = Math.max(\r\n      adjustedPhysicalScore,\r\n      adjustedMentalScore,\r\n      adjustedEnvironmentalScore,\r\n      adjustedHazardScore\r\n    );\r\n\r\n    // 3K指数の決定\r\n    let final3KIndex: string;\r\n    if (finalKitsusaScore >= 7) {\r\n      final3KIndex = 'A';\r\n    } else if (finalKitsusaScore >= 4) {\r\n      final3KIndex = 'B';\r\n    } else if (finalKitsusaScore >= 2) {\r\n      final3KIndex = 'C';\r\n    } else {\r\n      final3KIndex = 'D';\r\n    }\r\n\r\n    const calculationDetails = {\r\n      originalScores: {\r\n        physical: physicalScore,\r\n        mental: mentalScore,\r\n        environmental: environmentalScore,\r\n        hazard: hazardScore\r\n      },\r\n      workTimeFactor: workTimeFactor,\r\n      adjustedScores: {\r\n        physical: adjustedPhysicalScore,\r\n        mental: adjustedMentalScore,\r\n        environmental: adjustedEnvironmentalScore,\r\n        hazard: adjustedHazardScore\r\n      },\r\n      maxScore: finalKitsusaScore,\r\n      indexMapping: {\r\n        'A': '7-10点: 改善必須',\r\n        'B': '4-6点: 改善推奨',\r\n        'C': '2-3点: 注意必要',\r\n        'D': '1点: 良好'\r\n      }\r\n    };\r\n\r\n    return {\r\n      physicalScore: adjustedPhysicalScore,\r\n      mentalScore: adjustedMentalScore,\r\n      environmentalScore: adjustedEnvironmentalScore,\r\n      hazardScore: adjustedHazardScore,\r\n      workTimeScore: workTimeFactor,\r\n      final3KIndex,\r\n      finalKitsusaScore,\r\n      calculationDetails\r\n    };\r\n  }\r\n\r\n  // プライベートヘルパーメソッド\r\n\r\n  private calculateMuscleForceScore(force: number): number {\r\n    if (force >= 50) return 7;\r\n    if (force >= 30) return 4;\r\n    if (force >= 15) return 2;\r\n    return 1;\r\n  }\r\n\r\n  private calculateProtectiveGearScore(percentage: number): number {\r\n    if (percentage >= 80) return 7;\r\n    if (percentage >= 50) return 4;\r\n    if (percentage >= 20) return 2;\r\n    return 1;\r\n  }\r\n\r\n  private calculateEyeStrainScore(percentage: number): number {\r\n    if (percentage >= 70) return 7;\r\n    if (percentage >= 40) return 4;\r\n    if (percentage >= 15) return 2;\r\n    return 1;\r\n  }\r\n\r\n  private calculateManualInputScore(strength: string, duration: string): number {\r\n    const strengthScores: Record<string, number> = {\r\n      '軽い': 1,\r\n      '少しきつい': 2,\r\n      'きつい': 4,\r\n      'とてもきつい': 7,\r\n      '限界': 10\r\n    };\r\n\r\n    const durationFactors: Record<string, number> = {\r\n      '<10%': 0.7,\r\n      '10-50%': 1.0,\r\n      '>50%': 1.5\r\n    };\r\n\r\n    const baseScore = strengthScores[strength] || 1;\r\n    const factor = durationFactors[duration] || 1.0;\r\n\r\n    return Math.min(Math.ceil(baseScore * factor), 10);\r\n  }\r\n\r\n  private calculateFailureScore(level: string, duration: string): number {\r\n    const levelScores: Record<string, number> = {\r\n      'ほとんどない': 1,\r\n      '稀にある': 2,\r\n      '時々ある': 4,\r\n      '頻繁にある': 7\r\n    };\r\n\r\n    const durationFactors: Record<string, number> = {\r\n      '5%': 0.5,\r\n      '10%': 0.7,\r\n      '15%': 0.8,\r\n      '20%': 0.9,\r\n      '40%': 1.0,\r\n      '60%': 1.2,\r\n      '80%': 1.5\r\n    };\r\n\r\n    const baseScore = levelScores[level] || 1;\r\n    const factor = durationFactors[duration] || 1.0;\r\n\r\n    return Math.min(Math.ceil(baseScore * factor), 10);\r\n  }\r\n\r\n  private calculateConcentrationScore(level: string, duration: string): number {\r\n    return this.calculateMentalFactorScore(level, duration, {\r\n      'ほとんど集中を要しない': 1,\r\n      '軽度の集中を要する': 2,\r\n      '中程度の集中を要する': 4,\r\n      '高度な集中を要する': 7,\r\n      '極めて高度な集中を要する': 10\r\n    });\r\n  }\r\n\r\n  private calculateCognitiveLoadScore(level: string, duration: string): number {\r\n    return this.calculateMentalFactorScore(level, duration, {\r\n      'ない': 1,\r\n      'あまりない': 1,\r\n      'どちらとも言えない': 2,\r\n      '比較的ある': 4,\r\n      'ある': 7\r\n    });\r\n  }\r\n\r\n  private calculateEmotionalBurdenScore(level: string, duration: string): number {\r\n    return this.calculateMentalFactorScore(level, duration, {\r\n      'ない': 1,\r\n      'あまりない': 1,\r\n      'どちらとも言えない': 2,\r\n      '比較的ある': 4,\r\n      'ある': 7\r\n    });\r\n  }\r\n\r\n  private calculateSkillUtilizationScore(level: string, duration: string): number {\r\n    return this.calculateMentalFactorScore(level, duration, {\r\n      '高い': 1,\r\n      'やや高い': 2,\r\n      'どちらとも言えない': 4,\r\n      'やや低い': 7,\r\n      '低い': 10\r\n    });\r\n  }\r\n\r\n  private calculateWorkControlScore(level: string, duration: string): number {\r\n    return this.calculateMentalFactorScore(level, duration, {\r\n      '高い': 1,\r\n      'やや高い': 2,\r\n      'どちらとも言えない': 4,\r\n      'やや低い': 7,\r\n      '低い': 10\r\n    });\r\n  }\r\n\r\n  private calculateMentalFactorScore(level: string, duration: string, scoreMapping: Record<string, number>): number {\r\n    const durationFactors: Record<string, number> = {\r\n      '5%': 0.5,\r\n      '10%': 0.7,\r\n      '15%': 0.8,\r\n      '20%': 0.9,\r\n      '40%': 1.0,\r\n      '60%': 1.2,\r\n      '80%': 1.5\r\n    };\r\n\r\n    const baseScore = scoreMapping[level] || 1;\r\n    const factor = durationFactors[duration] || 1.0;\r\n\r\n    return Math.min(Math.ceil(baseScore * factor), 10);\r\n  }\r\n\r\n  private calculateTemperatureScore(temperature: number): number {\r\n    // 温度の場合は、熱いか寒いかで判定\r\n    if (temperature >= 35) {\r\n      // WBGT計算の簡易版（実際の実装では詳細な計算が必要）\r\n      return this.standardsService.calculateWBGTScore(temperature, 'moderate_work', 'continuous');\r\n    } else if (temperature <= 5) {\r\n      return this.standardsService.calculateColdScore(temperature);\r\n    }\r\n    return 1;\r\n  }\r\n\r\n  // マトリックス計算用のヘルパーメソッド\r\n  private parseStrengthLevel(strength: string): 1 | 2 | 3 | 4 | 5 {\r\n    const strengthMap: Record<string, 1 | 2 | 3 | 4 | 5> = {\r\n      '軽い': 1,\r\n      '少しきつい': 2,\r\n      'きつい': 3,\r\n      'とてもきつい': 4,\r\n      '限界': 5\r\n    };\r\n    return strengthMap[strength] || 3;\r\n  }\r\n\r\n  private parseDurationPercentage(duration: string): number {\r\n    if (duration.includes('<10') || duration.includes('10%未満')) return 5;\r\n    if (duration.includes('10-50') || duration.includes('10～50')) return 30;\r\n    if (duration.includes('>50') || duration.includes('50%超')) return 75;\r\n    return 30; // デフォルト\r\n  }\r\n\r\n  private parseFailureLevel(level: string): 1 | 2 | 3 | 4 {\r\n    const levelMap: Record<string, 1 | 2 | 3 | 4> = {\r\n      'ほとんどない': 1,\r\n      '稀にある': 2,\r\n      '時々ある': 3,\r\n      '頻繁にある': 4\r\n    };\r\n    return levelMap[level] || 2;\r\n  }\r\n\r\n  private parseMentalDurationLevel(duration: string): 1 | 2 {\r\n    // 精神因の持続時間は短時間/長時間の2段階\r\n    if (duration.includes('20') || duration.includes('40') || duration.includes('60') || duration.includes('80')) {\r\n      return 2; // 長時間\r\n    }\r\n    return 1; // 短時間\r\n  }\r\n\r\n  private parseImpactLevel(impact: string): 1 | 2 | 3 | 4 {\r\n    const impactMap: Record<string, 1 | 2 | 3 | 4> = {\r\n      '軽微': 1,\r\n      '中程度': 2,\r\n      '重大': 3,\r\n      '致命的': 4\r\n    };\r\n    return impactMap[impact] || 2;\r\n  }\r\n}\r\n\r\n// シングルトンインスタンスをエクスポート\r\nexport const calculationEngine = ScoreCalculationEngine.getInstance();","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\database\\evaluationService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\electron\\electronAPI.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\errorHandling.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-empty-function","severity":1,"message":"Unexpected empty constructor.","line":437,"column":25,"nodeType":"FunctionExpression","messageId":"unexpected","endLine":437,"endColumn":27,"suggestions":[{"messageId":"suggestComment","data":{"name":"constructor"},"fix":{"range":[12713,12713],"text":" /* empty */ "},"desc":"Add comment inside empty constructor."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\evaluationEngine.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\hazardPsychologicalMapping.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\history.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-empty-function","severity":1,"message":"Unexpected empty constructor.","line":71,"column":25,"nodeType":"FunctionExpression","messageId":"unexpected","endLine":71,"endColumn":27,"suggestions":[{"messageId":"suggestComment","data":{"name":"constructor"},"fix":{"range":[1940,1940],"text":" /* empty */ "},"desc":"Add comment inside empty constructor."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\matrixCalculator.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'evaluationMatrices' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":21},{"ruleId":"@typescript-eslint/no-empty-function","severity":1,"message":"Unexpected empty constructor.","line":64,"column":25,"nodeType":"FunctionExpression","messageId":"unexpected","endLine":64,"endColumn":27,"suggestions":[{"messageId":"suggestComment","data":{"name":"constructor"},"fix":{"range":[1778,1778],"text":" /* empty */ "},"desc":"Add comment inside empty constructor."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'input' is defined but never used. Allowed unused args must match /^_/u.","line":354,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":354,"endColumn":10}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * マトリックス計算エンジン\r\n * JSON定義されたマトリックスを使用してスコア計算を実行\r\n */\r\n\r\nimport type { \r\n  EvaluationMatrix, \r\n  MatrixCell} from '../data/evaluationMatrices';\nimport { \r\n  getMatrix, \r\n  findMatrixById,\r\n  evaluationMatrices \r\n} from '../data/evaluationMatrices';\r\n\r\nexport interface MatrixCalculationInput {\r\n  matrixId?: string;\r\n  category?: 'physical' | 'mental' | 'environmental' | 'hazard';\r\n  xValue: string;\r\n  yValue: string;\r\n  additionalParams?: Record<string, unknown>;\r\n}\r\n\r\nexport interface MatrixCalculationResult {\r\n  score: number;\r\n  cell: MatrixCell;\r\n  matrix: EvaluationMatrix;\r\n  coordinates: {\r\n    x: string;\r\n    y: string;\r\n  };\r\n  metadata: {\r\n    level: 'low' | 'medium' | 'high' | 'critical';\r\n    color: string;\r\n    description?: string;\r\n    recommendations?: string[];\r\n  };\r\n}\r\n\r\nexport interface PhysicalMatrixInput {\r\n  postureLevel: 1 | 2 | 3; // 1: 良い, 2: 悪い, 3: とても悪い\r\n  durationLevel: 1 | 2 | 3; // 1: <10%, 2: 10-50%, 3: >50%\r\n  strengthLevel: 1 | 2 | 3 | 4 | 5; // 1: 軽い, 2: 少しきつい, 3: きつい, 4: とてもきつい, 5: 限界\r\n}\r\n\r\nexport interface MentalMatrixInput {\r\n  failureFrequency: 1 | 2 | 3 | 4; // 1: ほとんどない, 2: 稀にある, 3: 時々ある, 4: 頻繁にある\r\n  durationLevel: 1 | 2; // 1: 短時間, 2: 長時間\r\n  impactLevel: 1 | 2 | 3 | 4; // 1: 軽微, 2: 中程度, 3: 重大, 4: 致命的\r\n}\r\n\r\nexport interface EnvironmentalMatrixInput {\r\n  concentrationLevel: 1 | 2 | 3 | 4 | 5; // 1: 25%未満, 2: 25-50%, 3: 50-75%, 4: 75-100%, 5: 100%超過\r\n  exposureTime: 1 | 2 | 3 | 4; // 1: 短時間, 2: 中時間, 3: 長時間, 4: 超長時間\r\n}\r\n\r\nexport interface HazardMatrixInput {\r\n  frequency: 1 | 2 | 3 | 4 | 5; // 1: ほぼない, 2: 稀, 3: 時々, 4: 頻繁, 5: 常時\r\n  severity: 1 | 2 | 3 | 4 | 5; // 1: 軽微, 2: 軽度, 3: 中程度, 4: 重度, 5: 致命的\r\n}\r\n\r\nexport class MatrixCalculator {\r\n  private static instance: MatrixCalculator;\r\n\r\n  private constructor() {}\r\n\r\n  public static getInstance(): MatrixCalculator {\r\n    if (!MatrixCalculator.instance) {\r\n      MatrixCalculator.instance = new MatrixCalculator();\r\n    }\r\n    return MatrixCalculator.instance;\r\n  }\r\n\r\n  /**\r\n   * 汎用マトリックス計算\r\n   */\r\n  public calculateFromMatrix(input: MatrixCalculationInput): MatrixCalculationResult {\r\n    let matrix: EvaluationMatrix | null = null;\r\n\r\n    // マトリックスを取得\r\n    if (input.matrixId) {\r\n      matrix = findMatrixById(input.matrixId);\r\n    } else if (input.category) {\r\n      matrix = getMatrix(input.category);\r\n    }\r\n\r\n    if (!matrix) {\r\n      throw new Error('Matrix not found');\r\n    }\r\n\r\n    // 座標の検証\r\n    const cell = matrix.matrix[input.yValue]?.[input.xValue];\r\n    if (!cell) {\r\n      throw new Error(`Invalid coordinates: y=${input.yValue}, x=${input.xValue}`);\r\n    }\r\n\r\n    // カラースキームから詳細情報を取得\r\n    const colorInfo = matrix.colorScheme[cell.value];\r\n    \r\n    const recommendations = this.generateRecommendations(matrix.category, cell.value, input);\r\n\r\n    return {\r\n      score: cell.value,\r\n      cell,\r\n      matrix,\r\n      coordinates: {\r\n        x: input.xValue,\r\n        y: input.yValue\r\n      },\r\n      metadata: {\r\n        level: colorInfo?.level || 'low',\r\n        color: cell.color,\r\n        description: cell.description,\r\n        recommendations\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 肉体因マトリックス計算\r\n   */\r\n  public calculatePhysicalMatrix(input: PhysicalMatrixInput): MatrixCalculationResult {\r\n    const yValue = `${input.postureLevel}-${input.durationLevel}`;\r\n    const xValue = input.strengthLevel.toString();\r\n\r\n    return this.calculateFromMatrix({\r\n      category: 'physical',\r\n      xValue,\r\n      yValue,\r\n      additionalParams: { ...input }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 精神因マトリックス計算\r\n   */\r\n  public calculateMentalMatrix(input: MentalMatrixInput): MatrixCalculationResult {\r\n    const yValue = `${input.failureFrequency}-${input.durationLevel}`;\r\n    const xValue = input.impactLevel.toString();\r\n\r\n    return this.calculateFromMatrix({\r\n      category: 'mental',\r\n      xValue,\r\n      yValue,\r\n      additionalParams: { ...input }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 環境因マトリックス計算\r\n   */\r\n  public calculateEnvironmentalMatrix(input: EnvironmentalMatrixInput): MatrixCalculationResult {\r\n    const yValue = input.concentrationLevel.toString();\r\n    const xValue = input.exposureTime.toString();\r\n\r\n    return this.calculateFromMatrix({\r\n      category: 'environmental',\r\n      xValue,\r\n      yValue,\r\n      additionalParams: { ...input }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 危険因マトリックス計算\r\n   */\r\n  public calculateHazardMatrix(input: HazardMatrixInput): MatrixCalculationResult {\r\n    const yValue = input.frequency.toString();\r\n    const xValue = input.severity.toString();\r\n\r\n    return this.calculateFromMatrix({\r\n      category: 'hazard',\r\n      xValue,\r\n      yValue,\r\n      additionalParams: { ...input }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 複数マトリックス一括計算\r\n   */\r\n  public calculateMultipleMatrices(inputs: {\r\n    physical?: PhysicalMatrixInput;\r\n    mental?: MentalMatrixInput;\r\n    environmental?: EnvironmentalMatrixInput;\r\n    hazard?: HazardMatrixInput;\r\n  }): Record<string, MatrixCalculationResult> {\r\n    const results: Record<string, MatrixCalculationResult> = {};\r\n\r\n    if (inputs.physical) {\r\n      results.physical = this.calculatePhysicalMatrix(inputs.physical);\r\n    }\r\n    if (inputs.mental) {\r\n      results.mental = this.calculateMentalMatrix(inputs.mental);\r\n    }\r\n    if (inputs.environmental) {\r\n      results.environmental = this.calculateEnvironmentalMatrix(inputs.environmental);\r\n    }\r\n    if (inputs.hazard) {\r\n      results.hazard = this.calculateHazardMatrix(inputs.hazard);\r\n    }\r\n\r\n    return results;\r\n  }\r\n\r\n  /**\r\n   * 姿勢評価からマトリックス入力への変換\r\n   */\r\n  public convertPostureToMatrixInput(\r\n    rulaScore: number, \r\n    owasCategory: number, \r\n    durationPercentage: number, \r\n    strengthLevel: 1 | 2 | 3 | 4 | 5\r\n  ): PhysicalMatrixInput {\r\n    // RULA/OWASスコアから姿勢レベルを決定\r\n    let postureLevel: 1 | 2 | 3;\r\n    \r\n    if (rulaScore <= 2 && owasCategory <= 1) {\r\n      postureLevel = 1; // 良い\r\n    } else if (rulaScore <= 4 && owasCategory <= 2) {\r\n      postureLevel = 2; // 悪い\r\n    } else {\r\n      postureLevel = 3; // とても悪い\r\n    }\r\n\r\n    // 持続時間レベルを決定\r\n    let durationLevel: 1 | 2 | 3;\r\n    if (durationPercentage < 10) {\r\n      durationLevel = 1; // <10%\r\n    } else if (durationPercentage <= 50) {\r\n      durationLevel = 2; // 10-50%\r\n    } else {\r\n      durationLevel = 3; // >50%\r\n    }\r\n\r\n    return {\r\n      postureLevel,\r\n      durationLevel,\r\n      strengthLevel\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 化学物質濃度からマトリックス入力への変換\r\n   */\r\n  public convertConcentrationToMatrixInput(\r\n    measuredValue: number,\r\n    permissibleValue: number,\r\n    exposureHours: number\r\n  ): EnvironmentalMatrixInput {\r\n    // 濃度レベルを計算\r\n    const ratio = (measuredValue / permissibleValue) * 100;\r\n    let concentrationLevel: 1 | 2 | 3 | 4 | 5;\r\n    \r\n    if (ratio < 25) concentrationLevel = 1;\r\n    else if (ratio < 50) concentrationLevel = 2;\r\n    else if (ratio < 75) concentrationLevel = 3;\r\n    else if (ratio <= 100) concentrationLevel = 4;\r\n    else concentrationLevel = 5;\r\n\r\n    // 曝露時間レベルを決定\r\n    let exposureTime: 1 | 2 | 3 | 4;\r\n    if (exposureHours < 1) exposureTime = 1;\r\n    else if (exposureHours <= 4) exposureTime = 2;\r\n    else if (exposureHours <= 8) exposureTime = 3;\r\n    else exposureTime = 4;\r\n\r\n    return {\r\n      concentrationLevel,\r\n      exposureTime\r\n    };\r\n  }\r\n\r\n  /**\r\n   * マトリックス妥当性検証\r\n   */\r\n  public validateMatrixInput(\r\n    category: 'physical' | 'mental' | 'environmental' | 'hazard',\r\n    xValue: string,\r\n    yValue: string\r\n  ): { isValid: boolean; errors: string[] } {\r\n    const matrix = getMatrix(category);\r\n    const errors: string[] = [];\r\n\r\n    if (!matrix) {\r\n      errors.push(`Matrix for category ${category} not found`);\r\n      return { isValid: false, errors };\r\n    }\r\n\r\n    // Y軸の検証\r\n    if (!matrix.matrix[yValue]) {\r\n      const validYValues = Object.keys(matrix.matrix);\r\n      errors.push(`Invalid Y value: ${yValue}. Valid values: ${validYValues.join(', ')}`);\r\n    }\r\n\r\n    // X軸の検証\r\n    if (matrix.matrix[yValue] && !matrix.matrix[yValue][xValue]) {\r\n      const validXValues = Object.keys(matrix.matrix[yValue] || {});\r\n      errors.push(`Invalid X value: ${xValue}. Valid values: ${validXValues.join(', ')}`);\r\n    }\r\n\r\n    return { isValid: errors.length === 0, errors };\r\n  }\r\n\r\n  /**\r\n   * マトリックス統計情報取得\r\n   */\r\n  public getMatrixStatistics(category: 'physical' | 'mental' | 'environmental' | 'hazard'): {\r\n    totalCells: number;\r\n    scoreDistribution: Record<number, number>;\r\n    averageScore: number;\r\n    maxScore: number;\r\n    minScore: number;\r\n    riskLevelDistribution: Record<string, number>;\r\n  } {\r\n    const matrix = getMatrix(category);\r\n    if (!matrix) {\r\n      throw new Error(`Matrix for category ${category} not found`);\r\n    }\r\n\r\n    const scores: number[] = [];\r\n    const scoreDistribution: Record<number, number> = {};\r\n    const riskLevelDistribution: Record<string, number> = {};\r\n\r\n    // 全セルを走査\r\n    for (const row of Object.values(matrix.matrix)) {\r\n      for (const cell of Object.values(row)) {\r\n        scores.push(cell.value);\r\n        scoreDistribution[cell.value] = (scoreDistribution[cell.value] || 0) + 1;\r\n        \r\n        const colorInfo = matrix.colorScheme[cell.value];\r\n        if (colorInfo) {\r\n          const level = colorInfo.level;\r\n          riskLevelDistribution[level] = (riskLevelDistribution[level] || 0) + 1;\r\n        }\r\n      }\r\n    }\r\n\r\n    return {\r\n      totalCells: scores.length,\r\n      scoreDistribution,\r\n      averageScore: scores.reduce((sum, score) => sum + score, 0) / scores.length,\r\n      maxScore: Math.max(...scores),\r\n      minScore: Math.min(...scores),\r\n      riskLevelDistribution\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 推奨事項生成\r\n   */\r\n  private generateRecommendations(\r\n    category: 'physical' | 'mental' | 'environmental' | 'hazard',\r\n    score: number,\r\n    input: MatrixCalculationInput\r\n  ): string[] {\r\n    const recommendations: string[] = [];\r\n\r\n    switch (category) {\r\n      case 'physical':\r\n        if (score >= 7) {\r\n          recommendations.push('作業姿勢の即時改善が必要');\r\n          recommendations.push('作業補助具の導入を検討');\r\n          recommendations.push('定期的な休憩の実施');\r\n        } else if (score >= 4) {\r\n          recommendations.push('作業姿勢の改善を検討');\r\n          recommendations.push('作業者へのトレーニング実施');\r\n        }\r\n        break;\r\n\r\n      case 'mental':\r\n        if (score >= 7) {\r\n          recommendations.push('作業手順の簡素化');\r\n          recommendations.push('チェック体制の強化');\r\n          recommendations.push('作業者の負荷軽減策を検討');\r\n        } else if (score >= 4) {\r\n          recommendations.push('作業手順書の見直し');\r\n          recommendations.push('定期的な習熟度確認');\r\n        }\r\n        break;\r\n\r\n      case 'environmental':\r\n        if (score >= 7) {\r\n          recommendations.push('局所排気装置の設置・強化');\r\n          recommendations.push('個人保護具の着用徹底');\r\n          recommendations.push('作業時間の短縮');\r\n        } else if (score >= 4) {\r\n          recommendations.push('環境測定の頻度増加');\r\n          recommendations.push('換気設備の点検');\r\n        }\r\n        break;\r\n\r\n      case 'hazard':\r\n        if (score >= 7) {\r\n          recommendations.push('安全設備の追加設置');\r\n          recommendations.push('作業手順の根本的見直し');\r\n          recommendations.push('緊急対応手順の策定');\r\n        } else if (score >= 4) {\r\n          recommendations.push('リスク管理体制の強化');\r\n          recommendations.push('定期的な安全教育');\r\n        }\r\n        break;\r\n    }\r\n\r\n    return recommendations;\r\n  }\r\n\r\n  /**\r\n   * マトリックス情報のエクスポート\r\n   */\r\n  public exportMatrixData(category: 'physical' | 'mental' | 'environmental' | 'hazard'): string {\r\n    const matrix = getMatrix(category);\r\n    if (!matrix) {\r\n      throw new Error(`Matrix for category ${category} not found`);\r\n    }\r\n\r\n    const csvHeader = ['Y軸', 'X軸', 'スコア', 'レベル', '色'].join(',');\r\n    const rows: string[] = [csvHeader];\r\n\r\n    for (const [yKey, row] of Object.entries(matrix.matrix)) {\r\n      for (const [xKey, cell] of Object.entries(row)) {\r\n        const yLabel = matrix.yAxis.values.find(v => v.id === yKey)?.label || yKey;\r\n        const xLabel = matrix.xAxis.values.find(v => v.id === xKey)?.label || xKey;\r\n        const colorInfo = matrix.colorScheme[cell.value];\r\n        \r\n        rows.push([\r\n          `\"${yLabel}\"`,\r\n          `\"${xLabel}\"`,\r\n          cell.value,\r\n          colorInfo?.level || 'unknown',\r\n          `\"${cell.color}\"`\r\n        ].join(','));\r\n      }\r\n    }\r\n\r\n    return rows.join('\\n');\r\n  }\r\n}\r\n\r\n// シングルトンインスタンスをエクスポート\r\nexport const matrixCalculator = MatrixCalculator.getInstance();","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\performance.ts","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'react-hooks/exhaustive-deps').","line":214,"column":3,"severity":1,"nodeType":null,"fix":{"range":[5769,5824],"text":" "}},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has missing dependencies: 'deps' and 'factory'. Either include them or remove the dependency array. If 'factory' changes too often, find the parent component that defines it and wrap that definition in useCallback.","line":228,"column":6,"nodeType":"ArrayExpression","endLine":228,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [deps, factory]","fix":{"range":[6296,6298],"text":"[deps, factory]"}}]},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'react-hooks/exhaustive-deps').","line":240,"column":3,"severity":1,"nodeType":null,"fix":{"range":[6532,6587],"text":" "}},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect was passed a dependency list that is not an array literal. This means we can't statically verify whether you've passed the correct dependencies.","line":244,"column":6,"nodeType":"Identifier","endLine":244,"endColumn":10},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'callback'. Either include it or remove the dependency array.","line":244,"column":6,"nodeType":"Identifier","endLine":244,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [callback]","fix":{"range":[6710,6714],"text":"[callback]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":2,"source":"/**\r\n * パフォーマンス測定・最適化ユーティリティ\r\n * TDD Green Phase実装 - レンダリング最適化とパフォーマンス監視\r\n */\r\n\r\nimport React, { useEffect, useRef, useCallback, useMemo, useState } from 'react';\r\n\r\n/**\r\n * パフォーマンス測定結果の型定義\r\n */\r\nexport interface PerformanceMetrics {\r\n  renderTime: number;\r\n  componentName: string;\r\n  timestamp: number;\r\n  memoryUsage?: number;\r\n  props?: Record<string, unknown>;\r\n}\r\n\r\n/**\r\n * Web Vitals測定結果の型定義\r\n */\r\nexport interface WebVitalsMetrics {\r\n  fcp?: number; // First Contentful Paint\r\n  lcp?: number; // Largest Contentful Paint\r\n  fid?: number; // First Input Delay\r\n  cls?: number; // Cumulative Layout Shift\r\n  ttfb?: number; // Time to First Byte\r\n}\r\n\r\n/**\r\n * パフォーマンス測定クラス\r\n */\r\nexport class PerformanceMonitor {\r\n  private static instance: PerformanceMonitor;\r\n  private metrics: PerformanceMetrics[] = [];\r\n  private webVitals: WebVitalsMetrics = {};\r\n\r\n  static getInstance(): PerformanceMonitor {\r\n    if (!PerformanceMonitor.instance) {\r\n      PerformanceMonitor.instance = new PerformanceMonitor();\r\n    }\r\n    return PerformanceMonitor.instance;\r\n  }\r\n\r\n  /**\r\n   * コンポーネントのレンダリング時間を測定\r\n   */\r\n  measureRenderTime(componentName: string, startTime: number, props?: Record<string, unknown>): PerformanceMetrics {\r\n    const endTime = performance.now();\r\n    const renderTime = endTime - startTime;\r\n\r\n    const metric: PerformanceMetrics = {\r\n      renderTime,\r\n      componentName,\r\n      timestamp: Date.now(),\r\n      props: props ? this.serializeProps(props) : undefined,\r\n      memoryUsage: this.getMemoryUsage()\r\n    };\r\n\r\n    this.metrics.push(metric);\r\n\r\n    // 開発環境でのログ出力\r\n    if (process.env.NODE_ENV === 'development' && renderTime > 16) {\r\n      console.warn(`⚠️ Slow render detected: ${componentName} (${renderTime.toFixed(2)}ms)`);\r\n    }\r\n\r\n    return metric;\r\n  }\r\n\r\n  /**\r\n   * Web Vitalsの測定\r\n   */\r\n  measureWebVitals(): Promise<WebVitalsMetrics> {\r\n    return new Promise((resolve) => {\r\n      if (typeof window === 'undefined') {\r\n        resolve({});\r\n        return;\r\n      }\r\n\r\n      const metrics: WebVitalsMetrics = {};\r\n\r\n      // Performance Observer for paint metrics\r\n      if ('PerformanceObserver' in window) {\r\n        const observer = new PerformanceObserver((list) => {\r\n          const entries = list.getEntries();\r\n          entries.forEach((entry) => {\r\n            switch (entry.name) {\r\n              case 'first-contentful-paint':\r\n                metrics.fcp = entry.startTime;\r\n                break;\r\n              case 'largest-contentful-paint':\r\n                metrics.lcp = entry.startTime;\r\n                break;\r\n            }\r\n          });\r\n        });\r\n\r\n        observer.observe({ entryTypes: ['paint', 'largest-contentful-paint'] });\r\n\r\n        // TTFB測定\r\n        const navigationEntry = performance.getEntriesByType('navigation')[0] as PerformanceNavigationTiming;\r\n        if (navigationEntry) {\r\n          metrics.ttfb = navigationEntry.responseStart - navigationEntry.requestStart;\r\n        }\r\n\r\n        // タイムアウト後に結果を返す\r\n        setTimeout(() => {\r\n          observer.disconnect();\r\n          this.webVitals = { ...this.webVitals, ...metrics };\r\n          resolve(metrics);\r\n        }, 3000);\r\n      } else {\r\n        resolve(metrics);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * メモリ使用量の取得\r\n   */\r\n  private getMemoryUsage(): number | undefined {\r\n    if (typeof window !== 'undefined' && 'memory' in performance) {\r\n      const perfWithMemory = performance as { memory?: { usedJSHeapSize: number } }\r\n      return perfWithMemory.memory ? perfWithMemory.memory.usedJSHeapSize / (1024 * 1024) : undefined; // MB\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  /**\r\n   * プロパティのシリアライズ（循環参照対策）\r\n   */\r\n  private serializeProps(props: Record<string, unknown>): Record<string, unknown> {\r\n    const seen = new WeakSet();\r\n    return JSON.parse(JSON.stringify(props, (_key, value: unknown) => {\r\n      if (typeof value === 'object' && value !== null) {\r\n        if (seen.has(value)) {\r\n          return '[Circular]';\r\n        }\r\n        seen.add(value);\r\n      }\r\n      return value;\r\n    })) as Record<string, unknown>;\r\n  }\r\n\r\n  /**\r\n   * 測定結果の取得\r\n   */\r\n  getMetrics(): PerformanceMetrics[] {\r\n    return this.metrics;\r\n  }\r\n\r\n  /**\r\n   * Web Vitals結果の取得\r\n   */\r\n  getWebVitals(): WebVitalsMetrics {\r\n    return this.webVitals;\r\n  }\r\n\r\n  /**\r\n   * 統計情報の取得\r\n   */\r\n  getStats(): {\r\n    totalMeasurements: number;\r\n    averageRenderTime: number;\r\n    maxRenderTime: number;\r\n    slowComponents: PerformanceMetrics[];\r\n  } {\r\n    const renderTimes = this.metrics.map(m => m.renderTime);\r\n    return {\r\n      totalMeasurements: this.metrics.length,\r\n      averageRenderTime: renderTimes.reduce((a, b) => a + b, 0) / renderTimes.length || 0,\r\n      maxRenderTime: Math.max(...renderTimes) || 0,\r\n      slowComponents: this.metrics\r\n        .filter(m => m.renderTime > 16)\r\n        .sort((a, b) => b.renderTime - a.renderTime)\r\n        .slice(0, 10)\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 測定データのクリア\r\n   */\r\n  clear(): void {\r\n    this.metrics = [];\r\n    this.webVitals = {};\r\n  }\r\n}\r\n\r\n/**\r\n * コンポーネントのレンダリング時間を測定するフック\r\n */\r\nexport const useRenderTime = (componentName: string, props?: Record<string, unknown>): void => {\r\n  const startTimeRef = useRef<number | undefined>(undefined);\r\n  const monitor = PerformanceMonitor.getInstance();\r\n\r\n  useEffect(() => {\r\n    startTimeRef.current = performance.now();\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (startTimeRef.current) {\r\n      monitor.measureRenderTime(componentName, startTimeRef.current, props);\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * 不要な再レンダリングを防ぐためのメモ化フック\r\n */\r\nexport const useStableMemo = <T>(factory: () => T, deps: React.DependencyList): T => {\r\n  const lastDepsRef = useRef<React.DependencyList | undefined>(undefined);\r\n  const lastResultRef = useRef<T | undefined>(undefined);\r\n\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  return useMemo(() => {\r\n    const depsChanged = !lastDepsRef.current ||\r\n      deps.length !== lastDepsRef.current.length ||\r\n      deps.some((dep, index) => dep !== lastDepsRef.current![index]);\r\n\r\n    if (depsChanged) {\r\n      lastDepsRef.current = deps;\r\n      lastResultRef.current = factory();\r\n    }\r\n\r\n    return lastResultRef.current!;\r\n    // deps is intentionally used here but not in the dependency array\r\n    // because we manually check for changes\r\n  }, []);\r\n};\r\n\r\n/**\r\n * 不要な再レンダリングを防ぐためのコールバックフック\r\n */\r\nexport const useStableCallback = <T extends (...args: unknown[]) => unknown>(\r\n  callback: T,\r\n  deps: React.DependencyList\r\n): T => {\r\n  const callbackRef = useRef<T>(callback);\r\n\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  useEffect(() => {\r\n    callbackRef.current = callback;\r\n    // deps is used to track when callback should update\r\n  }, deps);\r\n\r\n  return useCallback((...args: Parameters<T>) => {\r\n    return callbackRef.current(...args);\r\n  }, []) as T;\r\n};\r\n\r\n/**\r\n * デバウンス処理付きの値管理フック\r\n */\r\nexport const useDebouncedValue = <T>(value: T, delay: number): T => {\r\n  const [debouncedValue, setDebouncedValue] = useState(value);\r\n\r\n  useEffect(() => {\r\n    const handler = setTimeout(() => {\r\n      setDebouncedValue(value);\r\n    }, delay);\r\n\r\n    return () => {\r\n      clearTimeout(handler);\r\n    };\r\n  }, [value, delay]);\r\n\r\n  return debouncedValue;\r\n};\r\n\r\n/**\r\n * Web Vitals測定フック\r\n */\r\nexport const useWebVitals = (): WebVitalsMetrics => {\r\n  const [metrics, setMetrics] = useState<WebVitalsMetrics>({});\r\n  const monitor = PerformanceMonitor.getInstance();\r\n\r\n  useEffect(() => {\r\n    void monitor.measureWebVitals().then(setMetrics);\r\n  }, [monitor]);\r\n\r\n  return metrics;\r\n};\r\n\r\n/**\r\n * パフォーマンス統計フック\r\n */\r\nexport const usePerformanceStats = (): ReturnType<PerformanceMonitor['getStats']> => {\r\n  const [stats, setStats] = useState(PerformanceMonitor.getInstance().getStats());\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      setStats(PerformanceMonitor.getInstance().getStats());\r\n    }, 5000); // 5秒ごとに更新\r\n\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  return stats;\r\n};\r\n\r\n/**\r\n * 高階コンポーネント: パフォーマンス測定付きコンポーネント\r\n */\r\nexport function withPerformanceMonitoring<P extends Record<string, unknown>>(\r\n  Component: React.ComponentType<P>,\r\n  componentName?: string\r\n): React.ComponentType<P> {\r\n  const WrappedComponent = React.memo((props: P) => {\r\n    const name = componentName || Component.displayName || Component.name || 'Unknown';\r\n    useRenderTime(name, props);\r\n\r\n    return React.createElement(Component, props);\r\n  });\r\n\r\n  WrappedComponent.displayName = `withPerformanceMonitoring(${componentName || Component.displayName || Component.name})`;\r\n\r\n  return WrappedComponent;\r\n}\r\n\r\n/**\r\n * パフォーマンスレポート生成\r\n */\r\nexport const generatePerformanceReport = (): string => {\r\n  const monitor = PerformanceMonitor.getInstance();\r\n  const stats = monitor.getStats();\r\n  const webVitals = monitor.getWebVitals();\r\n\r\n  return `\r\nパフォーマンスレポート\r\n========================\r\n\r\nWeb Vitals:\r\n- FCP: ${webVitals.fcp?.toFixed(2) || 'N/A'}ms\r\n- LCP: ${webVitals.lcp?.toFixed(2) || 'N/A'}ms\r\n- TTFB: ${webVitals.ttfb?.toFixed(2) || 'N/A'}ms\r\n\r\nレンダリング統計:\r\n- 総測定回数: ${stats.totalMeasurements}\r\n- 平均レンダリング時間: ${stats.averageRenderTime.toFixed(2)}ms\r\n- 最大レンダリング時間: ${stats.maxRenderTime.toFixed(2)}ms\r\n\r\n遅いコンポーネント (>16ms):\r\n${stats.slowComponents.map(c =>\r\n  `- ${c.componentName}: ${c.renderTime.toFixed(2)}ms`\r\n).join('\\n')}\r\n`;\r\n};\r\n\r\nexport default PerformanceMonitor;","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\prisma.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":8,"column":14,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":8,"endColumn":81,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe construction of a(n) `any` typed value.","line":8,"column":63,"nodeType":"NewExpression","messageId":"unsafeNew","endLine":8,"endColumn":81,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":11,"column":44,"nodeType":"AssignmentExpression","messageId":"anyAssignment","endLine":11,"endColumn":75,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\psychologicalStressMapping.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\reportGenerator.ts","messages":[{"ruleId":"@typescript-eslint/no-empty-function","severity":1,"message":"Unexpected empty constructor.","line":92,"column":25,"nodeType":"FunctionExpression","messageId":"unexpected","endLine":92,"endColumn":27,"suggestions":[{"messageId":"suggestComment","data":{"name":"constructor"},"fix":{"range":[2374,2374],"text":" /* empty */ "},"desc":"Add comment inside empty constructor."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'config' is defined but never used. Allowed unused args must match /^_/u.","line":200,"column":65,"nodeType":null,"messageId":"unusedVar","endLine":200,"endColumn":71},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'config' is defined but never used. Allowed unused args must match /^_/u.","line":236,"column":72,"nodeType":null,"messageId":"unusedVar","endLine":236,"endColumn":78},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'config' is defined but never used. Allowed unused args must match /^_/u.","line":350,"column":61,"nodeType":null,"messageId":"unusedVar","endLine":350,"endColumn":67},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'config' is defined but never used. Allowed unused args must match /^_/u.","line":420,"column":55,"nodeType":null,"messageId":"unusedVar","endLine":420,"endColumn":61},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'historicalData' is defined but never used. Allowed unused args must match /^_/u.","line":663,"column":30,"nodeType":null,"messageId":"unusedVar","endLine":663,"endColumn":44},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'reportData' is defined but never used. Allowed unused args must match /^_/u.","line":691,"column":42,"nodeType":null,"messageId":"unusedVar","endLine":691,"endColumn":52}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * 3K評価レポート生成システム\r\n * 包括的なレポート作成、PDF出力、データ分析機能を提供\r\n */\r\n\r\nimport type { EvaluationResult } from './evaluationEngine';\r\nimport type { \r\n  PhysicalDetails, MentalDetails, EnvironmentalDetails, HazardDetails,\r\n  Posture, EnvironmentalSubstance, WorkTimeFactor\r\n} from '../types/evaluation';\r\n\r\nexport interface ReportConfig {\r\n  includeCharts: boolean;\r\n  includeRecommendations: boolean;\r\n  includeHistoricalData: boolean;\r\n  includeMatrixDetails: boolean;\r\n  language: 'ja' | 'en';\r\n  format: 'pdf' | 'html' | 'docx';\r\n  template: 'standard' | 'detailed' | 'summary';\r\n}\r\n\r\nexport interface ReportData {\r\n  evaluationResult: EvaluationResult;\r\n  workInfo: {\r\n    workName: string;\r\n    factoryName: string;\r\n    processName: string;\r\n    evaluatedBy: string;\r\n    evaluatedDate: Date;\r\n    department?: string;\r\n    shift?: string;\r\n  };\r\n  detailsData?: {\r\n    physical?: PhysicalDetails;\r\n    mental?: MentalDetails;\r\n    environmental?: EnvironmentalDetails;\r\n    hazard?: HazardDetails;\r\n    postures?: Posture[];\r\n    substances?: EnvironmentalSubstance[];\r\n    workTime?: WorkTimeFactor;\r\n  };\r\n  historicalData?: {\r\n    previousEvaluations: EvaluationResult[];\r\n    trendAnalysis: TrendAnalysis;\r\n  };\r\n}\r\n\r\nexport interface TrendAnalysis {\r\n  physicalTrend: 'improving' | 'stable' | 'declining';\r\n  mentalTrend: 'improving' | 'stable' | 'declining';\r\n  environmentalTrend: 'improving' | 'stable' | 'declining';\r\n  hazardTrend: 'improving' | 'stable' | 'declining';\r\n  overallTrend: 'improving' | 'stable' | 'declining';\r\n  improvementRate: number;\r\n  riskReductionRate: number;\r\n}\r\n\r\nexport interface GeneratedReport {\r\n  reportId: string;\r\n  title: string;\r\n  content: string;\r\n  metadata: {\r\n    generatedAt: Date;\r\n    generatedBy: string;\r\n    format: string;\r\n    pageCount: number;\r\n    fileSize?: number;\r\n  };\r\n  sections: ReportSection[];\r\n  attachments?: ReportAttachment[];\r\n}\r\n\r\nexport interface ReportSection {\r\n  id: string;\r\n  title: string;\r\n  content: string;\r\n  type: 'summary' | 'analysis' | 'recommendations' | 'charts' | 'data' | 'appendix';\r\n  order: number;\r\n}\r\n\r\nexport interface ReportAttachment {\r\n  id: string;\r\n  name: string;\r\n  type: 'chart' | 'table' | 'image' | 'data';\r\n  content: string | Buffer;\r\n  mimeType: string;\r\n}\r\n\r\nexport class ReportGenerator {\r\n  private static instance: ReportGenerator;\r\n\r\n  private constructor() {}\r\n\r\n  public static getInstance(): ReportGenerator {\r\n    if (!ReportGenerator.instance) {\r\n      ReportGenerator.instance = new ReportGenerator();\r\n    }\r\n    return ReportGenerator.instance;\r\n  }\r\n\r\n  /**\r\n   * メインレポート生成メソッド\r\n   */\r\n  public async generateReport(\r\n    reportData: ReportData,\r\n    config: ReportConfig\r\n  ): Promise<GeneratedReport> {\r\n    const reportId = this.generateReportId();\r\n    const sections: ReportSection[] = [];\r\n\r\n    // レポートタイトル生成\r\n    const title = this.generateReportTitle(reportData, config);\r\n\r\n    // セクション順序定義\r\n    const sectionOrder = [\r\n      'summary',\r\n      'analysis', \r\n      'recommendations',\r\n      'charts',\r\n      'data',\r\n      'appendix'\r\n    ];\r\n\r\n    // 各セクション生成\r\n    for (const sectionType of sectionOrder) {\r\n      const section = await this.generateSection(sectionType as ReportSection['type'], reportData, config);\r\n      if (section) {\r\n        sections.push(section);\r\n      }\r\n    }\r\n\r\n    // 最終レポート組み立て\r\n    const content = this.assembleReport(sections, config);\r\n    \r\n    return {\r\n      reportId,\r\n      title,\r\n      content,\r\n      metadata: {\r\n        generatedAt: new Date(),\r\n        generatedBy: 'ReportGenerator',\r\n        format: config.format,\r\n        pageCount: this.estimatePageCount(content),\r\n        fileSize: Buffer.byteLength(content, 'utf8')\r\n      },\r\n      sections,\r\n      attachments: config.includeCharts ? await this.generateChartAttachments(reportData) : undefined\r\n    };\r\n  }\r\n\r\n  /**\r\n   * サマリーセクション生成\r\n   */\r\n  private async generateSummarySection(reportData: ReportData, config: ReportConfig): Promise<ReportSection> {\r\n    const { evaluationResult, workInfo } = reportData;\r\n    const { finalResult, scores } = evaluationResult;\r\n\r\n    const riskLevelText = this.getRiskLevelText(finalResult.final3KIndex, config.language);\r\n    \r\n    const content = `\r\n## 評価サマリー\r\n\r\n**作業名**: ${workInfo.workName}  \r\n**工場**: ${workInfo.factoryName}  \r\n**工程**: ${workInfo.processName}  \r\n**評価日**: ${workInfo.evaluatedDate.toLocaleDateString('ja-JP')}  \r\n**評価者**: ${workInfo.evaluatedBy}\r\n\r\n### 総合評価結果\r\n\r\n**3K指数**: ${finalResult.final3KIndex} (${finalResult.finalKitsusaScore}点)  \r\n**リスクレベル**: ${riskLevelText}\r\n\r\n### 各因子スコア\r\n\r\n| 因子 | スコア | レベル |\r\n|------|--------|--------|\r\n| 肉体因子 | ${scores.physical} | ${this.getScoreLevel(scores.physical)} |\r\n| 精神因子 | ${scores.mental} | ${this.getScoreLevel(scores.mental)} |\r\n| 環境因子 | ${scores.environmental} | ${this.getScoreLevel(scores.environmental)} |\r\n| 危険因子 | ${scores.hazard} | ${this.getScoreLevel(scores.hazard)} |\r\n\r\n### 主要な推奨事項\r\n\r\n${this.generateQuickRecommendations(evaluationResult).map(rec => `- ${rec}`).join('\\n')}\r\n    `;\r\n\r\n    return {\r\n      id: 'summary',\r\n      title: '評価サマリー',\r\n      content: content.trim(),\r\n      type: 'summary',\r\n      order: 1\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 詳細分析セクション生成\r\n   */\r\n  private async generateAnalysisSection(reportData: ReportData, config: ReportConfig): Promise<ReportSection> {\r\n    const { evaluationResult, detailsData } = reportData;\r\n    \r\n    const content = `\r\n## 詳細分析\r\n\r\n### 肉体因子分析\r\n${detailsData?.physical ? this.analyzePhysicalFactor(detailsData.physical, reportData.detailsData?.postures) : '評価データなし'}\r\n\r\n### 精神因子分析  \r\n${detailsData?.mental ? this.analyzeMentalFactor(detailsData.mental) : '評価データなし'}\r\n\r\n### 環境因子分析\r\n${detailsData?.environmental ? this.analyzeEnvironmentalFactor(detailsData.environmental, reportData.detailsData?.substances) : '評価データなし'}\r\n\r\n### 危険因子分析\r\n${detailsData?.hazard ? this.analyzeHazardFactor(detailsData.hazard) : '評価データなし'}\r\n\r\n### 計算詳細\r\n- **計算方法**: マトリクス計算\r\n- **作業時間補正**: ${evaluationResult.scores.workTime}倍\r\n- **計算実行日時**: ${evaluationResult.timestamp.toLocaleString('ja-JP')}\r\n    `;\r\n\r\n    return {\r\n      id: 'analysis',\r\n      title: '詳細分析',\r\n      content: content.trim(),\r\n      type: 'analysis',\r\n      order: 2\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 推奨事項セクション生成\r\n   */\r\n  private async generateRecommendationsSection(reportData: ReportData, config: ReportConfig): Promise<ReportSection> {\r\n    const { evaluationResult } = reportData;\r\n    const report = this.generateEvaluationReport(evaluationResult);\r\n\r\n    const content = `\r\n## 改善推奨事項\r\n\r\n### リスクレベル評価\r\n${report.summary}\r\n\r\n### 優先改善アクション\r\n${report.priorityActions.map((action, index) => `${index + 1}. ${action}`).join('\\n')}\r\n\r\n### 因子別推奨事項\r\n${report.recommendations.map(rec => `- ${rec}`).join('\\n')}\r\n\r\n### 実施スケジュール案\r\n\r\n#### 短期対策（1ヶ月以内）\r\n- 即座に実施可能な安全対策の導入\r\n- 作業手順の見直しと作業者への周知\r\n- 緊急時対応手順の確認\r\n\r\n#### 中期対策（3ヶ月以内） \r\n- 設備・環境の改善\r\n- 追加的な保護具の導入\r\n- 定期的な健康チェック体制の構築\r\n\r\n#### 長期対策（6ヶ月以内）\r\n- 根本的な作業プロセスの見直し\r\n- 自動化・機械化の検討\r\n- 継続的改善システムの構築\r\n\r\n### 効果測定計画\r\n- **再評価実施時期**: ${this.calculateNextEvaluationDate(evaluationResult)}\r\n- **測定指標**: 3K指数、各因子スコア、事故発生率\r\n- **改善目標**: 3K指数1段階向上、高リスク因子の軽減\r\n    `;\r\n\r\n    return {\r\n      id: 'recommendations',\r\n      title: '改善推奨事項',\r\n      content: content.trim(),\r\n      type: 'recommendations',\r\n      order: 3\r\n    };\r\n  }\r\n\r\n  /**\r\n   * チャート・グラフセクション生成\r\n   */\r\n  private async generateChartsSection(reportData: ReportData, config: ReportConfig): Promise<ReportSection | null> {\r\n    if (!config.includeCharts) return null;\r\n\r\n    const { evaluationResult, historicalData } = reportData;\r\n\r\n    const content = `\r\n## グラフ・チャート分析\r\n\r\n### スコア分布チャート\r\n\\`\\`\\`chart\r\n{\r\n  \"type\": \"radar\",\r\n  \"data\": {\r\n    \"labels\": [\"肉体因子\", \"精神因子\", \"環境因子\", \"危険因子\"],\r\n    \"datasets\": [{\r\n      \"label\": \"現在のスコア\",\r\n      \"data\": [${evaluationResult.scores.physical}, ${evaluationResult.scores.mental}, ${evaluationResult.scores.environmental}, ${evaluationResult.scores.hazard}],\r\n      \"backgroundColor\": \"rgba(54, 162, 235, 0.2)\",\r\n      \"borderColor\": \"rgb(54, 162, 235)\",\r\n      \"pointBackgroundColor\": \"rgb(54, 162, 235)\"\r\n    }]\r\n  },\r\n  \"options\": {\r\n    \"scale\": {\r\n      \"ticks\": {\r\n        \"beginAtZero\": true,\r\n        \"max\": 10\r\n      }\r\n    }\r\n  }\r\n}\r\n\\`\\`\\`\r\n\r\n### 3K指数推移チャート\r\n${historicalData ? this.generateTrendChart(historicalData) : '履歴データなし'}\r\n\r\n### リスク分布\r\n\\`\\`\\`chart\r\n{\r\n  \"type\": \"pie\",\r\n  \"data\": {\r\n    \"labels\": [\"低リスク\", \"中リスク\", \"高リスク\", \"最高リスク\"],\r\n    \"datasets\": [{\r\n      \"data\": [${this.calculateRiskDistribution(evaluationResult)}],\r\n      \"backgroundColor\": [\"#28a745\", \"#ffc107\", \"#fd7e14\", \"#dc3545\"]\r\n    }]\r\n  }\r\n}\r\n\\`\\`\\`\r\n    `;\r\n\r\n    return {\r\n      id: 'charts',\r\n      title: 'グラフ・チャート分析',\r\n      content: content.trim(),\r\n      type: 'charts',\r\n      order: 4\r\n    };\r\n  }\r\n\r\n  /**\r\n   * データ詳細セクション生成\r\n   */\r\n  private async generateDataSection(reportData: ReportData, config: ReportConfig): Promise<ReportSection> {\r\n    const { evaluationResult, detailsData } = reportData;\r\n\r\n    const content = `\r\n## データ詳細\r\n\r\n### 計算パラメータ\r\n\\`\\`\\`json\r\n{\r\n  \"physicalScore\": ${evaluationResult.scores.physical},\r\n  \"mentalScore\": ${evaluationResult.scores.mental},\r\n  \"environmentalScore\": ${evaluationResult.scores.environmental},\r\n  \"hazardScore\": ${evaluationResult.scores.hazard},\r\n  \"workTimeFactor\": ${evaluationResult.scores.workTime},\r\n  \"final3KIndex\": \"${evaluationResult.finalResult.final3KIndex}\",\r\n  \"finalKitsusaScore\": ${evaluationResult.finalResult.finalKitsusaScore}\r\n}\r\n\\`\\`\\`\r\n\r\n### 入力データ\r\n${detailsData ? this.formatInputData(detailsData) : 'データなし'}\r\n\r\n### 計算詳細\r\n${JSON.stringify(evaluationResult.calculationDetails, null, 2)}\r\n    `;\r\n\r\n    return {\r\n      id: 'data', \r\n      title: 'データ詳細',\r\n      content: content.trim(),\r\n      type: 'data',\r\n      order: 5\r\n    };\r\n  }\r\n\r\n  /**\r\n   * セクション生成の統一メソッド\r\n   */\r\n  private async generateSection(\r\n    type: 'summary' | 'analysis' | 'recommendations' | 'charts' | 'data' | 'appendix',\r\n    reportData: ReportData,\r\n    config: ReportConfig\r\n  ): Promise<ReportSection | null> {\r\n    switch (type) {\r\n      case 'summary':\r\n        return await this.generateSummarySection(reportData, config);\r\n      case 'analysis':\r\n        return await this.generateAnalysisSection(reportData, config);\r\n      case 'recommendations':\r\n        if (config.includeRecommendations) {\r\n          return await this.generateRecommendationsSection(reportData, config);\r\n        }\r\n        return null;\r\n      case 'charts':\r\n        return await this.generateChartsSection(reportData, config);\r\n      case 'data':\r\n        return await this.generateDataSection(reportData, config);\r\n      case 'appendix':\r\n        return null; // 必要に応じて実装\r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n\r\n  // ヘルパーメソッド群\r\n\r\n  private generateReportId(): string {\r\n    return `report_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n  }\r\n\r\n  private generateReportTitle(reportData: ReportData, config: ReportConfig): string {\r\n    const { workInfo } = reportData;\r\n    return `3K評価レポート - ${workInfo.workName} (${workInfo.factoryName})`;\r\n  }\r\n\r\n  private assembleReport(sections: ReportSection[], config: ReportConfig): string {\r\n    const header = this.generateReportHeader(config);\r\n    const body = sections.sort((a, b) => a.order - b.order).map(s => s.content).join('\\n\\n---\\n\\n');\r\n    const footer = this.generateReportFooter();\r\n\r\n    return `${header}\\n\\n${body}\\n\\n${footer}`;\r\n  }\r\n\r\n  private generateReportHeader(config: ReportConfig): string {\r\n    return `# 3K評価システム 評価レポート\r\n\r\n生成日時: ${new Date().toLocaleString('ja-JP')}  \r\n形式: ${config.format.toUpperCase()}  \r\nテンプレート: ${config.template}`;\r\n  }\r\n\r\n  private generateReportFooter(): string {\r\n    return `---\r\n\r\nこのレポートは3K評価システムにより自動生成されました。  \r\n© 2025 3K Evaluation System`;\r\n  }\r\n\r\n  private estimatePageCount(content: string): number {\r\n    // 1ページあたり約3000文字と仮定\r\n    return Math.ceil(content.length / 3000);\r\n  }\r\n\r\n  private getRiskLevelText(index: string, language: 'ja' | 'en'): string {\r\n    const riskLevels = {\r\n      'A': { ja: '最高リスク（即座の改善必要）', en: 'Critical Risk (Immediate Action Required)' },\r\n      'B': { ja: '高リスク（早急な改善推奨）', en: 'High Risk (Urgent Improvement Recommended)' },\r\n      'C': { ja: '中リスク（継続監視必要）', en: 'Medium Risk (Continuous Monitoring Required)' },\r\n      'D': { ja: '低リスク（現状維持可能）', en: 'Low Risk (Current State Acceptable)' }\r\n    };\r\n    \r\n    return riskLevels[index as keyof typeof riskLevels]?.[language] || '不明';\r\n  }\r\n\r\n  private getScoreLevel(score: number): string {\r\n    if (score >= 7) return '最高リスク';\r\n    if (score >= 5) return '高リスク';\r\n    if (score >= 3) return '中リスク';\r\n    return '低リスク';\r\n  }\r\n\r\n  private generateQuickRecommendations(result: EvaluationResult): string[] {\r\n    const recommendations: string[] = [];\r\n    const { scores } = result;\r\n\r\n    if (scores.physical >= 4) {\r\n      recommendations.push('作業姿勢と重量物取扱いの改善が必要');\r\n    }\r\n    if (scores.mental >= 4) {\r\n      recommendations.push('作業の複雑度軽減とストレス要因の除去が必要');\r\n    }\r\n    if (scores.environmental >= 4) {\r\n      recommendations.push('作業環境の改善と防護設備の充実が必要');\r\n    }\r\n    if (scores.hazard >= 4) {\r\n      recommendations.push('安全管理体制の強化と緊急対応手順の見直しが必要');\r\n    }\r\n\r\n    if (recommendations.length === 0) {\r\n      recommendations.push('現在の作業状況は良好です。継続的な監視を推奨します。');\r\n    }\r\n\r\n    return recommendations;\r\n  }\r\n\r\n  private generateEvaluationReport(result: EvaluationResult) {\r\n    // evaluationEngine.ts の generateEvaluationReport メソッドと同様の処理\r\n    const { finalResult } = result;\r\n    const { final3KIndex, finalKitsusaScore } = finalResult;\r\n\r\n    let riskLevel: 'low' | 'medium' | 'high' | 'critical';\r\n    let summary: string;\r\n    const recommendations: string[] = [];\r\n    let priorityActions: string[] = [];\r\n\r\n    switch (final3KIndex) {\r\n      case 'A':\r\n        riskLevel = 'critical';\r\n        summary = `この作業は最高リスクレベル（3K指数A：${finalKitsusaScore}点）に分類されます。即座の改善が必要です。`;\r\n        priorityActions = [\r\n          '作業の即時停止または制限を検討',\r\n          '代替作業方法の実装',\r\n          '追加の安全対策の導入'\r\n        ];\r\n        break;\r\n      case 'B':\r\n        riskLevel = 'high';\r\n        summary = `この作業は高リスクレベル（3K指数B：${finalKitsusaScore}点）に分類されます。早急な改善が推奨されます。`;\r\n        priorityActions = [\r\n          '作業プロセスの見直し',\r\n          '作業者への追加トレーニング',\r\n          '定期的なリスク評価の実施'\r\n        ];\r\n        break;\r\n      case 'C':\r\n        riskLevel = 'medium';\r\n        summary = `この作業は中程度のリスクレベル（3K指数C：${finalKitsusaScore}点）に分類されます。継続的な監視が必要です。`;\r\n        break;\r\n      default:\r\n        riskLevel = 'low';\r\n        summary = `この作業は低リスクレベル（3K指数D：${finalKitsusaScore}点）に分類されます。現状維持で問題ありません。`;\r\n    }\r\n\r\n    // 因子別推奨事項\r\n    if (result.scores.physical >= 4) {\r\n      recommendations.push('肉体因子: 作業姿勢の改善、重量物取扱いの見直し、休憩時間の増加を検討');\r\n    }\r\n    if (result.scores.mental >= 4) {\r\n      recommendations.push('精神因子: 作業の複雑度軽減、チェック体制の強化、ストレス要因の除去を検討');\r\n    }\r\n    if (result.scores.environmental >= 4) {\r\n      recommendations.push('環境因子: 作業環境の改善、防護設備の充実、環境測定の強化を検討');\r\n    }\r\n    if (result.scores.hazard >= 4) {\r\n      recommendations.push('危険因子: リスク管理体制の強化、安全設備の追加、緊急対応手順の見直しを検討');\r\n    }\r\n\r\n    return {\r\n      summary,\r\n      recommendations,\r\n      riskLevel,\r\n      priorityActions\r\n    };\r\n  }\r\n\r\n  private analyzePhysicalFactor(details: PhysicalDetails, postures?: Posture[]): string {\r\n    let analysis = '**肉体的負担の分析結果:**\\n\\n';\r\n\r\n    if (details.checkboxes?.weightBoth && details.targetWeight?.bothHands) {\r\n      analysis += `- 両手重量物取扱い: ${details.targetWeight.bothHands}kg\\n`;\r\n    }\r\n    \r\n    if (details.checkboxes?.weightSingle && details.targetWeight?.singleHand) {\r\n      analysis += `- 片手重量物取扱い: ${details.targetWeight.singleHand}kg\\n`;\r\n    }\r\n\r\n    if (postures && postures.length > 0) {\r\n      analysis += '\\n**作業姿勢評価:**\\n';\r\n      for (const posture of postures) {\r\n        analysis += `- ${posture.postureName}: RULA=${posture.rulaScore}, OWAS=${posture.owasCategory}\\n`;\r\n      }\r\n    }\r\n\r\n    return analysis;\r\n  }\r\n\r\n  private analyzeMentalFactor(details: MentalDetails): string {\r\n    let analysis = '**精神的負担の分析結果:**\\n\\n';\r\n\r\n    if (details.workQuality?.cognitiveLoad) {\r\n      analysis += `- 作業複雑性: レベル${details.workQuality.cognitiveLoad.level}\\n`;\r\n    }\r\n\r\n    if (details.workQuality?.concentration) {\r\n      analysis += `- 集中力要求度: レベル${details.workQuality.concentration.level}\\n`;\r\n    }\r\n\r\n    if (details.workQuality?.emotionalBurden) {\r\n      analysis += `- 責任の重さ: レベル${details.workQuality.emotionalBurden.level}\\n`;\r\n    }\r\n\r\n    return analysis;\r\n  }\r\n\r\n  private analyzeEnvironmentalFactor(details: EnvironmentalDetails, substances?: EnvironmentalSubstance[]): string {\r\n    let analysis = '**環境要因の分析結果:**\\n\\n';\r\n\r\n    if (substances && substances.length > 0) {\r\n      analysis += '**化学物質暴露:**\\n';\r\n      for (const substance of substances) {\r\n        const standardValue = substance.permissibleConcentration ?? substance.thresholdValue ?? 0;\r\n        analysis += `- ${substance.substanceName}: ${substance.measuredValue} (基準値: ${standardValue})\\n`;\r\n      }\r\n    }\r\n\r\n    if (details.noise) {\r\n      analysis += `- 騒音レベル: ${details.noise}dB\\n`;\r\n    }\r\n\r\n    if (details.temperature) {\r\n      analysis += `- 温度: ${details.temperature}℃\\n`;\r\n    }\r\n\r\n    if (details.dust) {\r\n      analysis += `- 粉じん濃度: ${details.dust}mg/m³\\n`;\r\n    }\r\n\r\n    if (details.vibration) {\r\n      analysis += `- 振動レベル: ${details.vibration}m/s²\\n`;\r\n    }\r\n\r\n    return analysis;\r\n  }\r\n\r\n  private analyzeHazardFactor(details: HazardDetails): string {\r\n    let analysis = '**危険要因の分析結果:**\\n\\n';\r\n\r\n    if (details.hazardEvents) {\r\n      analysis += '**リスク評価:**\\n';\r\n      for (const event of details.hazardEvents) {\r\n        const riskLevel = event.encounterFrequency * event.dangerPossibility;\r\n        analysis += `- ${event.hazardEvent}: リスク値=${riskLevel} (頻度:${event.encounterFrequency}, 危険度:${event.dangerPossibility})\\n`;\r\n      }\r\n    }\r\n\r\n    return analysis;\r\n  }\r\n\r\n  private formatInputData(detailsData: Record<string, unknown>): string {\r\n    return `\\`\\`\\`json\\n${JSON.stringify(detailsData, null, 2)}\\n\\`\\`\\``;\r\n  }\r\n\r\n  private calculateNextEvaluationDate(result: EvaluationResult): string {\r\n    const nextDate = new Date(result.timestamp);\r\n    \r\n    // リスクレベルに応じた再評価間隔\r\n    switch (result.finalResult.final3KIndex) {\r\n      case 'A':\r\n        nextDate.setMonth(nextDate.getMonth() + 1); // 1ヶ月後\r\n        break;\r\n      case 'B':\r\n        nextDate.setMonth(nextDate.getMonth() + 3); // 3ヶ月後\r\n        break;\r\n      case 'C':\r\n        nextDate.setMonth(nextDate.getMonth() + 6); // 6ヶ月後\r\n        break;\r\n      default:\r\n        nextDate.setFullYear(nextDate.getFullYear() + 1); // 1年後\r\n    }\r\n    \r\n    return nextDate.toLocaleDateString('ja-JP');\r\n  }\r\n\r\n  private generateTrendChart(historicalData: Record<string, unknown>): string {\r\n    return `\r\n\\`\\`\\`chart\r\n{\r\n  \"type\": \"line\",\r\n  \"data\": {\r\n    \"labels\": [\"過去6回\", \"過去5回\", \"過去4回\", \"過去3回\", \"過去2回\", \"前回\", \"今回\"],\r\n    \"datasets\": [{\r\n      \"label\": \"3K指数推移\",\r\n      \"data\": [8, 7, 6, 5, 4, 3, 2],\r\n      \"borderColor\": \"rgb(75, 192, 192)\",\r\n      \"tension\": 0.1\r\n    }]\r\n  }\r\n}\r\n\\`\\`\\``;\r\n  }\r\n\r\n  private calculateRiskDistribution(result: EvaluationResult): number[] {\r\n    const scores = [result.scores.physical, result.scores.mental, result.scores.environmental, result.scores.hazard];\r\n    const low = scores.filter(s => s < 3).length;\r\n    const medium = scores.filter(s => s >= 3 && s < 5).length;  \r\n    const high = scores.filter(s => s >= 5 && s < 7).length;\r\n    const critical = scores.filter(s => s >= 7).length;\r\n    \r\n    return [low, medium, high, critical];\r\n  }\r\n\r\n  private async generateChartAttachments(reportData: ReportData): Promise<ReportAttachment[]> {\r\n    // チャート画像生成（実際の実装では Chart.js などを使用）\r\n    const attachments: ReportAttachment[] = [];\r\n    \r\n    // レーダーチャートの生成\r\n    attachments.push({\r\n      id: 'radar_chart',\r\n      name: 'スコア分布チャート',\r\n      type: 'chart',\r\n      content: 'placeholder_chart_data',\r\n      mimeType: 'image/png'\r\n    });\r\n\r\n    return attachments;\r\n  }\r\n}\r\n\r\n// シングルトンインスタンスをエクスポート\r\nexport const reportGenerator = ReportGenerator.getInstance();\r\n\r\n// 便利な関数をエクスポート  \r\nexport const generateEvaluationReport = async (\r\n  reportData: ReportData,\r\n  config?: Partial<ReportConfig>\r\n): Promise<GeneratedReport> => {\r\n  const defaultConfig: ReportConfig = {\r\n    includeCharts: true,\r\n    includeRecommendations: true,\r\n    includeHistoricalData: false,\r\n    includeMatrixDetails: true,\r\n    language: 'ja',\r\n    format: 'pdf',\r\n    template: 'standard'\r\n  };\r\n\r\n  return await reportGenerator.generateReport(reportData, { ...defaultConfig, ...config });\r\n};","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\screenMapping.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\standards.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'coldStandards' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":144,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":144,"endColumn":24,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'noiseStandards' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":158,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":158,"endColumn":25,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'vibrationStandards' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":181,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":181,"endColumn":29,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\storage\\adapter.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\storage\\electron.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\storage\\local.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\supabase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\testData\\aiTestData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\stores\\evaluationDataStore.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\types\\electron.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\types\\evaluation-matrix.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\types\\evaluation-standards.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\types\\evaluation.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":276,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":276,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8272,8275],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8272,8275],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\types\\permissions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\types\\storage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\src\\types\\web-speech-api.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\tests\\basic.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\tests\\cross-platform.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\tests\\data-persistence.spec.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'emptyMessage' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":53,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":53,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'context' is defined but never used. Allowed unused args must match /^_/u.","line":58,"column":56,"nodeType":null,"messageId":"unusedVar","endLine":58,"endColumn":63}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { test, expect } from '@playwright/test'\n\ntest.describe('3K評価アプリケーション - データ永続化', () => {\n  test.beforeEach(async ({ page }) => {\n    await page.goto('/')\n    await page.waitForLoadState('networkidle')\n  })\n\n  test('評価データを作成して保存できる', async ({ page }) => {\n    // ダッシュボードに移動\n    await page.goto('/dashboard')\n    await page.waitForLoadState('networkidle')\n\n    // 新規評価作成ボタンを探す（存在する場合）\n    const newEvalButton = page.locator('button:has-text(\"新規評価\")')\n    if (await newEvalButton.isVisible()) {\n      await newEvalButton.click()\n    } else {\n      // ボタンがない場合は直接評価ページへ\n      await page.goto('/evaluation/physical')\n    }\n\n    await page.waitForLoadState('networkidle')\n\n    // ページが表示されることを確認\n    const main = page.locator('main')\n    await expect(main).toBeVisible()\n\n    // フォームが存在することを確認（実装されている場合）\n    const hasForm = await page.locator('form').count() > 0\n    if (hasForm) {\n      // フォームが存在する場合、入力フィールドが表示されることを確認\n      expect(await page.locator('input, textarea, select').count()).toBeGreaterThan(0)\n    }\n  })\n\n  test('評価リストページでデータを表示できる', async ({ page }) => {\n    await page.goto('/evaluation/list')\n    await page.waitForLoadState('networkidle')\n\n    // ページが正常に表示される\n    const main = page.locator('main')\n    await expect(main).toBeVisible()\n\n    // リスト要素が存在するか確認（データがある場合）\n    const hasListItems = await page.locator('[data-testid*=\"evaluation\"], .evaluation-item, li').count() > 0\n\n    if (hasListItems) {\n      // データが存在する場合、少なくとも1つ表示されている\n      expect(await page.locator('[data-testid*=\"evaluation\"], .evaluation-item, li').count()).toBeGreaterThan(0)\n    } else {\n      // データがない場合、空状態のメッセージが表示される\n      const emptyMessage = page.locator('text=/評価データがありません|データなし|No data/')\n      // 空メッセージはあってもなくても良い（実装状態による）\n    }\n  })\n\n  test('ローカルストレージ/IndexedDBにデータが保存される', async ({ page, context }) => {\n    // テスト用のIDを生成\n    const testId = `test-eval-${Date.now()}`\n\n    // ローカルストレージに直接テストデータを保存\n    await page.evaluate((id) => {\n      const testData = {\n        id: id,\n        createdAt: new Date().toISOString(),\n        workDescription: 'E2Eテスト評価',\n        physicalScore: 5,\n        mentalScore: 6,\n        environmentalScore: 4,\n        hazardScore: 3,\n        final3KIndex: 'B' as const,\n        finalKitsusaScore: 6\n      }\n\n      // LocalStorageに保存\n      localStorage.setItem(`eval:${id}`, JSON.stringify(testData))\n    }, testId)\n\n    // ページをリロードしてデータが永続化されているか確認\n    await page.reload()\n    await page.waitForLoadState('networkidle')\n\n    // LocalStorageからデータを取得\n    const savedData = await page.evaluate((id) => {\n      const data = localStorage.getItem(`eval:${id}`)\n      return data ? JSON.parse(data) as unknown : null\n    }, testId)\n\n    // データが永続化されていることを確認\n    expect(savedData).not.toBeNull()\n    expect(savedData.id).toBe(testId)\n    expect(savedData.workDescription).toBe('E2Eテスト評価')\n    expect(savedData.physicalScore).toBe(5)\n    expect(savedData.final3KIndex).toBe('B')\n\n    // クリーンアップ\n    await page.evaluate((id) => {\n      localStorage.removeItem(`eval:${id}`)\n    }, testId)\n  })\n\n  test('複数の評価データを保存・取得できる', async ({ page }) => {\n    // 複数のテストデータを作成\n    const testIds = [\n      `test-eval-1-${Date.now()}`,\n      `test-eval-2-${Date.now()}`,\n      `test-eval-3-${Date.now()}`\n    ]\n\n    // データを保存\n    await page.evaluate((ids) => {\n      ids.forEach((id, index) => {\n        const testData = {\n          id: id,\n          createdAt: new Date(Date.now() + index * 1000).toISOString(),\n          workDescription: `テスト評価 ${index + 1}`,\n          physicalScore: 3 + index,\n          final3KIndex: 'C'\n        }\n        localStorage.setItem(`eval:${id}`, JSON.stringify(testData))\n      })\n    }, testIds)\n\n    // データが全て保存されているか確認\n    const savedCount = await page.evaluate((ids) => {\n      let count = 0\n      ids.forEach(id => {\n        if (localStorage.getItem(`eval:${id}`)) {\n          count++\n        }\n      })\n      return count\n    }, testIds)\n\n    expect(savedCount).toBe(3)\n\n    // クリーンアップ\n    await page.evaluate((ids) => {\n      ids.forEach(id => localStorage.removeItem(`eval:${id}`))\n    }, testIds)\n  })\n\n  test('評価データを削除できる', async ({ page }) => {\n    const testId = `test-eval-delete-${Date.now()}`\n\n    // データを保存\n    await page.evaluate((id) => {\n      const testData = {\n        id: id,\n        createdAt: new Date().toISOString(),\n        workDescription: '削除テスト',\n        physicalScore: 5\n      }\n      localStorage.setItem(`eval:${id}`, JSON.stringify(testData))\n    }, testId)\n\n    // データが存在することを確認\n    let exists = await page.evaluate((id) => {\n      return localStorage.getItem(`eval:${id}`) !== null\n    }, testId)\n    expect(exists).toBe(true)\n\n    // データを削除\n    await page.evaluate((id) => {\n      localStorage.removeItem(`eval:${id}`)\n    }, testId)\n\n    // データが削除されたことを確認\n    exists = await page.evaluate((id) => {\n      return localStorage.getItem(`eval:${id}`) !== null\n    }, testId)\n    expect(exists).toBe(false)\n  })\n\n  test('IndexedDBが利用可能であることを確認', async ({ page }) => {\n    const isIndexedDBAvailable = await page.evaluate(() => {\n      return typeof indexedDB !== 'undefined'\n    })\n\n    expect(isIndexedDBAvailable).toBe(true)\n  })\n\n  test('セッションストレージとローカルストレージが区別される', async ({ page }) => {\n    const testKey = `test-key-${Date.now()}`\n\n    await page.evaluate((key) => {\n      localStorage.setItem(key, 'local')\n      sessionStorage.setItem(key, 'session')\n    }, testKey)\n\n    const values = await page.evaluate((key) => {\n      return {\n        local: localStorage.getItem(key),\n        session: sessionStorage.getItem(key)\n      }\n    }, testKey)\n\n    expect(values.local).toBe('local')\n    expect(values.session).toBe('session')\n\n    // クリーンアップ\n    await page.evaluate((key) => {\n      localStorage.removeItem(key)\n      sessionStorage.removeItem(key)\n    }, testKey)\n  })\n})\n","usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\tests\\electron-compatibility.spec.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"c:\\Users\\tgch1\\Desktop\\ZBC-migration-kit\\3K-app\\tests\\vercel-production.spec.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":1,"message":"'page' is defined but never used. Allowed unused args must match /^_/u.","line":198,"column":41,"nodeType":null,"messageId":"unusedVar","endLine":198,"endColumn":45}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { test, expect } from '@playwright/test'\n\n/**\n * Vercel本番環境専用テスト\n *\n * TEST_PRODUCTION=true 環境変数が設定されている場合のみ実行\n * デプロイされたアプリケーションの動作を検証\n */\n\ntest.describe('Vercel本番環境テスト', () => {\n  test.skip(() => {\n    // 本番環境テストは明示的に有効化された場合のみ\n    return process.env.TEST_PRODUCTION !== 'true'\n  }, 'Production tests require TEST_PRODUCTION=true')\n\n  const productionURL = process.env.VERCEL_URL || 'https://your-app.vercel.app'\n\n  test.beforeEach(async ({ page }) => {\n    // 本番環境のURLに接続\n    await page.goto(productionURL)\n  })\n\n  test('本番環境のホームページが正常に表示される', async ({ page }) => {\n    await page.waitForLoadState('networkidle')\n\n    const title = await page.title()\n    expect(title).toContain('3K')\n\n    // メインコンテンツが表示される\n    const body = page.locator('body')\n    await expect(body).toBeVisible()\n  })\n\n  test('本番環境でHTTPSが有効', async ({ page }) => {\n    const url = page.url()\n    expect(url).toMatch(/^https:\\/\\//)\n  })\n\n  test('本番環境でセキュリティヘッダーが設定されている', async ({ page }) => {\n    const response = await page.goto(productionURL)\n\n    expect(response).not.toBeNull()\n\n    const headers = response?.headers() || {}\n\n    // セキュリティヘッダーの確認\n    console.log('Security headers:', {\n      'x-frame-options': headers['x-frame-options'],\n      'x-content-type-options': headers['x-content-type-options'],\n      'strict-transport-security': headers['strict-transport-security']\n    })\n\n    // 少なくとも1つのセキュリティヘッダーが設定されている\n    const hasSecurityHeader =\n      headers['x-frame-options'] ||\n      headers['x-content-type-options'] ||\n      headers['strict-transport-security']\n\n    expect(hasSecurityHeader).toBeTruthy()\n  })\n\n  test('本番環境でSupabase統合が動作する', async ({ page }) => {\n    await page.waitForLoadState('networkidle')\n\n    // Supabaseクライアントの初期化を確認\n    const supabaseStatus = await page.evaluate(() => {\n      // Supabaseクライアントがグローバルに存在するか\n      return {\n        hasSupabase: typeof window !== 'undefined',\n        hasLocalStorage: typeof localStorage !== 'undefined',\n        hasIndexedDB: typeof indexedDB !== 'undefined'\n      }\n    })\n\n    expect(supabaseStatus.hasLocalStorage).toBe(true)\n    expect(supabaseStatus.hasIndexedDB).toBe(true)\n  })\n\n  test('本番環境で評価ページが正常に動作する', async ({ page }) => {\n    const evaluationPages = [\n      `${productionURL}/dashboard`,\n      `${productionURL}/evaluation/physical`,\n      `${productionURL}/evaluation/mental`,\n      `${productionURL}/evaluation/environmental`,\n      `${productionURL}/evaluation/hazard`,\n      `${productionURL}/evaluation/worktime`\n    ]\n\n    for (const url of evaluationPages) {\n      const response = await page.goto(url)\n\n      expect(response?.status()).toBe(200)\n\n      await page.waitForLoadState('networkidle')\n\n      const main = page.locator('main')\n      await expect(main).toBeVisible()\n\n      console.log(`✓ ${url} - Status 200`)\n    }\n  })\n\n  test('本番環境でエラーページが適切に表示される', async ({ page }) => {\n    // 存在しないページへアクセス\n    const response = await page.goto(`${productionURL}/non-existent-page-12345`)\n\n    // 404エラーが返される\n    expect(response?.status()).toBe(404)\n  })\n\n  test('本番環境でパフォーマンスが基準を満たす', async ({ page }) => {\n    const startTime = Date.now()\n\n    await page.goto(productionURL)\n    await page.waitForLoadState('networkidle')\n\n    const loadTime = Date.now() - startTime\n\n    console.log(`Production load time: ${loadTime}ms`)\n\n    // 本番環境は3秒以内に読み込み完了\n    expect(loadTime).toBeLessThan(3000)\n  })\n\n  test('本番環境でCore Web Vitalsが良好', async ({ page }) => {\n    await page.goto(productionURL)\n    await page.waitForLoadState('networkidle')\n\n    const webVitals = await page.evaluate(() => {\n      return new Promise((resolve) => {\n        const metrics: Record<string, number> = {}\n\n        // LCP (Largest Contentful Paint)\n        new PerformanceObserver((list) => {\n          const entries = list.getEntries()\n          const lastEntry = entries[entries.length - 1] as PerformanceEntry & { renderTime?: number; loadTime?: number }\n          metrics.lcp = lastEntry.renderTime || lastEntry.loadTime || 0\n        }).observe({ entryTypes: ['largest-contentful-paint'] })\n\n        // FID (First Input Delay) - 実際のユーザー操作が必要なため省略\n\n        // CLS (Cumulative Layout Shift)\n        let clsValue = 0\n        new PerformanceObserver((list) => {\n          for (const entry of list.getEntries()) {\n            const layoutShiftEntry = entry as PerformanceEntry & { value?: number; hadRecentInput?: boolean }\n            if (!layoutShiftEntry.hadRecentInput) {\n              clsValue += layoutShiftEntry.value || 0\n            }\n          }\n          metrics.cls = clsValue\n        }).observe({ entryTypes: ['layout-shift'] })\n\n        setTimeout(() => {\n          resolve(metrics)\n        }, 2000)\n      })\n    })\n\n    console.log('Web Vitals:', webVitals)\n\n    // Web Vitals の基準値チェック（緩め）\n    // LCP: 2500ms以下が良好\n    // CLS: 0.1以下が良好\n    if (webVitals && typeof webVitals === 'object') {\n      const metrics = webVitals as Record<string, number>\n      if (metrics.lcp) {\n        expect(metrics.lcp).toBeLessThan(4000) // 緩めの基準\n      }\n      if (metrics.cls !== undefined) {\n        expect(metrics.cls).toBeLessThan(0.25) // 緩めの基準\n      }\n    }\n  })\n\n  test('本番環境でレスポンシブデザインが動作する', async ({ page }) => {\n    // モバイル\n    await page.setViewportSize({ width: 375, height: 667 })\n    await page.goto(productionURL)\n    await page.waitForLoadState('networkidle')\n\n    let main = page.locator('main')\n    await expect(main).toBeVisible()\n\n    // タブレット\n    await page.setViewportSize({ width: 768, height: 1024 })\n    await page.reload()\n    main = page.locator('main')\n    await expect(main).toBeVisible()\n\n    // デスクトップ\n    await page.setViewportSize({ width: 1920, height: 1080 })\n    await page.reload()\n    main = page.locator('main')\n    await expect(main).toBeVisible()\n  })\n\n  test('本番環境でAPIエンドポイントが動作する', async ({ page, request }) => {\n    // APIエンドポイントが存在する場合のテスト\n    const apiEndpoints = [\n      `${productionURL}/api/health`,\n      // 他のAPIエンドポイントを追加\n    ]\n\n    for (const endpoint of apiEndpoints) {\n      const response = await request.get(endpoint).catch(() => null)\n\n      if (response) {\n        console.log(`API ${endpoint}: ${response.status()}`)\n        // APIが存在する場合は200を期待\n        expect([200, 404]).toContain(response.status())\n      }\n    }\n  })\n\n  test('本番環境でデータ永続化が動作する', async ({ page }) => {\n    const testKey = `prod-test-${Date.now()}`\n    const testValue = { environment: 'production', timestamp: Date.now() }\n\n    // データを保存\n    await page.evaluate(({ key, value }) => {\n      localStorage.setItem(key, JSON.stringify(value))\n    }, { key: testKey, value: testValue })\n\n    // ページをリロード\n    await page.reload()\n    await page.waitForLoadState('networkidle')\n\n    // データが永続化されているか確認\n    const retrieved = await page.evaluate((key) => {\n      const data = localStorage.getItem(key)\n      return data ? JSON.parse(data) as unknown : null\n    }, testKey)\n\n    expect(retrieved).toEqual(testValue)\n\n    // クリーンアップ\n    await page.evaluate((key) => {\n      localStorage.removeItem(key)\n    }, testKey)\n  })\n})\n\ntest.describe('Vercel環境変数テスト', () => {\n  test.skip(() => {\n    return process.env.TEST_PRODUCTION !== 'true'\n  }, 'Production env tests require TEST_PRODUCTION=true')\n\n  test('Vercel環境変数が正しく設定されている', async ({ page }) => {\n    const productionURL = process.env.VERCEL_URL || 'https://your-app.vercel.app'\n    await page.goto(productionURL)\n\n    const envCheck = await page.evaluate(() => {\n      return {\n        // 環境変数がクライアントに公開されているか確認\n        hasPublicEnv: typeof process !== 'undefined' || typeof window !== 'undefined'\n      }\n    })\n\n    expect(envCheck.hasPublicEnv).toBe(true)\n  })\n})\n","usedDeprecatedRules":[]}]
